<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Reproducible data treatment with R - 2&nbsp; A little reminder on Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-getting_ready.html" rel="next">
<link href="./01-about.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-152051691-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A little reminder on Statistics</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Reproducible data treatment with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/colinbousige/rclass" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-about.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About the class</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-stats.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A little reminder on Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-getting_ready.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting ready</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variables, booleans and strings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-dataframes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data frames</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-reading_files.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reading/writing all kinds of files</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-lists.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lists</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-conditions_loops.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Conditional actions and loops</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Plotting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-3d_plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">3D color plots</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-fitting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fitting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-rmarkdown.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing documents with Rmarkdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-shiny.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Graphical interfaces with Shiny</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-units.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Working with units and experimental errors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">List of exercises</span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code_bits.html" class="sidebar-item-text sidebar-link">Code bits</a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#why-are-statistical-tools-necessary-in-physical-science" id="toc-why-are-statistical-tools-necessary-in-physical-science" class="nav-link active" data-scroll-target="#why-are-statistical-tools-necessary-in-physical-science"><span class="toc-section-number">2.1</span>  Why are statistical tools necessary in physical science?</a>
  <ul class="collapse">
<li><a href="#a-practical-example" id="toc-a-practical-example" class="nav-link" data-scroll-target="#a-practical-example"><span class="toc-section-number">2.1.1</span>  A practical example</a></li>
  <li><a href="#probabilistic-description-of-physical-systems" id="toc-probabilistic-description-of-physical-systems" class="nav-link" data-scroll-target="#probabilistic-description-of-physical-systems"><span class="toc-section-number">2.1.2</span>  Probabilistic description of physical systems</a></li>
  </ul>
</li>
  <li>
<a href="#quantifying-the-properties-of-data" id="toc-quantifying-the-properties-of-data" class="nav-link" data-scroll-target="#quantifying-the-properties-of-data"><span class="toc-section-number">2.2</span>  Quantifying the properties of data</a>
  <ul class="collapse">
<li><a href="#data-representation-presenting-a-measurement" id="toc-data-representation-presenting-a-measurement" class="nav-link" data-scroll-target="#data-representation-presenting-a-measurement"><span class="toc-section-number">2.2.1</span>  Data representation – presenting a measurement</a></li>
  <li><a href="#characterizing-an-ensemble-of-measurements" id="toc-characterizing-an-ensemble-of-measurements" class="nav-link" data-scroll-target="#characterizing-an-ensemble-of-measurements"><span class="toc-section-number">2.2.2</span>  Characterizing an ensemble of measurements</a></li>
  </ul>
</li>
  <li>
<a href="#useful-distributions" id="toc-useful-distributions" class="nav-link" data-scroll-target="#useful-distributions"><span class="toc-section-number">2.3</span>  Useful distributions</a>
  <ul class="collapse">
<li><a href="#probability-density-functions" id="toc-probability-density-functions" class="nav-link" data-scroll-target="#probability-density-functions"><span class="toc-section-number">2.3.1</span>  Probability Density Functions</a></li>
  <li><a href="#pdfs-mean-and-variance" id="toc-pdfs-mean-and-variance" class="nav-link" data-scroll-target="#pdfs-mean-and-variance"><span class="toc-section-number">2.3.2</span>  PDFs, mean and variance</a></li>
  <li><a href="#the-poisson-distribution" id="toc-the-poisson-distribution" class="nav-link" data-scroll-target="#the-poisson-distribution"><span class="toc-section-number">2.3.3</span>  The Poisson distribution</a></li>
  <li><a href="#the-gaussian-distribution" id="toc-the-gaussian-distribution" class="nav-link" data-scroll-target="#the-gaussian-distribution"><span class="toc-section-number">2.3.4</span>  The Gaussian distribution</a></li>
  </ul>
</li>
  <li>
<a href="#usual-statistical-tests-on-distributions" id="toc-usual-statistical-tests-on-distributions" class="nav-link" data-scroll-target="#usual-statistical-tests-on-distributions"><span class="toc-section-number">2.4</span>  Usual statistical tests on distributions</a>
  <ul class="collapse">
<li><a href="#hypothesis-testing-and-p-values" id="toc-hypothesis-testing-and-p-values" class="nav-link" data-scroll-target="#hypothesis-testing-and-p-values"><span class="toc-section-number">2.4.1</span>  Hypothesis testing and p-values</a></li>
  <li><a href="#asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test" id="toc-asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test" class="nav-link" data-scroll-target="#asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test"><span class="toc-section-number">2.4.2</span>  Asserting the Gaussian nature of a distribution: the Shapiro–Wilk test</a></li>
  <li><a href="#students-t-test" id="toc-students-t-test" class="nav-link" data-scroll-target="#students-t-test"><span class="toc-section-number">2.4.3</span>  Student’s t-test</a></li>
  </ul>
</li>
  <li>
<a href="#uncertainty-and-errors" id="toc-uncertainty-and-errors" class="nav-link" data-scroll-target="#uncertainty-and-errors"><span class="toc-section-number">2.5</span>  Uncertainty and errors</a>
  <ul class="collapse">
<li><a href="#central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty" id="toc-central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty" class="nav-link" data-scroll-target="#central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty"><span class="toc-section-number">2.5.1</span>  Central limit theorem: on the Gaussian nature of statistical uncertainty</a></li>
  <li><a href="#combination-of-errors" id="toc-combination-of-errors" class="nav-link" data-scroll-target="#combination-of-errors"><span class="toc-section-number">2.5.2</span>  Combination of errors</a></li>
  </ul>
</li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="toc-section-number">2.6</span>  Further reading</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/colinbousige/rclass/blob/main/02-stats.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/colinbousige/rclass/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A little reminder on Statistics</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="why-are-statistical-tools-necessary-in-physical-science" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="why-are-statistical-tools-necessary-in-physical-science">
<span class="header-section-number">2.1</span> Why are statistical tools necessary in physical science?</h2>
<p>When doing Science, one has to fully grasp the concept of <em>physical measurement</em>. Let’s take an example to visualize the importance of this concept.</p>
<section id="a-practical-example" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="a-practical-example">
<span class="header-section-number">2.1.1</span> A practical example</h3>
<p>Let’s say you want to communicate to someone a temperature, and tell this person that the temperature is “38”. If this is a random person in the street, they might think: “nice, let’s go to the beach today!”. If this random person is from the USA, they’re gonna think: “damn, where did I put my coat?”. If that person happens to be a physician, they might think: “that kid’s got a slight fever”. If they are a physicist doing a cryostat experiment, they might think “let’s check the He tank level”… you see that one of the most important part of the measurement is missing: its unit. Units are there so that people understand each other when exchanging data, and you see here that 38 Celsius, 38 Fahrenheit or 38 Kelvin are quite different, and this quantity will mean different things in different contexts. A physical quantity given without its unit would be absolutely meaningless (unless, of course, you are looking at a unit-less quantity, like a count).</p>
<p>Now let’s consider the body temperature of 38 °C given to a physician. How did you measure this temperature? With a mercury graduated thermometer or with a thermocouple? In the first case, you can probably assume that this value is given with a measurement error of at least 1 °C, meaning that the temperature you give to the physician is (38±1) °C, <em>i.e.</em> the physician won’t be able to decide whether they should be concerned or not. In the second case, the temperature is often given with a 0.1 °C precision, so the physician, seeing that the body temperature is (38±0.1) °C, will probably tell you to take an aspirin and rest instead of giving you something stronger to treat a possible infection. Given that the uncertainty on the given value is of 0.1 °C, one should in fact give the temperature with matching decimal precision, <em>i.e.</em> (38.0±0.1) °C. Writing (38±0.1) °C, (38.00001±0.1) °C or (38.00±0.10000) °C would be meaningless too.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>With this, we see that a physical measurement should be given with four parts: its actual <strong>value</strong>, its <strong>decimal precision</strong>, its <strong>uncertainty</strong>, and its <strong>unit</strong>. Should any of these four parts be missing in a physical quantity that you wanted to share, it would at best be imprecise, and at worst be utterly meaningless.</p>
</div>
</div>
</section><section id="probabilistic-description-of-physical-systems" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="probabilistic-description-of-physical-systems">
<span class="header-section-number">2.1.2</span> Probabilistic description of physical systems</h3>
<p>Let’s continue with our example of the body temperature measured with a thermocouple or a laser thermometer with a 0.1 °C precision. Our first measurement of the body temperature yielded (38.0±0.1) °C. Now let’s repeat this measurement a number of times in various area of the body (which are left to your imagination). Let’s say it then shows (38.1±0.1) °C, (38.0±0.1) °C, (38.3±0.1) °C, (37.9±0.1) °C, (38.2±0.1) °C, (38.1±0.1) °C, (38.1±0.1) °C, (39.8±0.1) °C. What is the actual body temperature then? Should we stick to a single measurement? Of course not. We have to make an histogram of the measured values, and study the distribution of the measurements (<a href="#fig-histogramT">Figure&nbsp;<span>2.1</span></a>). We can then see that one of the values is clearly an outlier – something might have gone wrong there. What if we had done the measurement only once and only measured that value? We might have jumped to a very wrong conclusion, with possibly a very serious consequence like giving the wrong medicine.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-histogramT" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-histogramT-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.1: Histogram of the body temperature measurements. The red line is the mean value, the orange one is the mode and the blue one is the median.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>With this example, we see that <strong>a physical measurement is not absolute</strong>. In fact, a physical measurement is an assessment of the <strong>probability</strong> that the physical value is within a certain range. In the case of our example, after removing the outlier for which we are certain that the measurement is wrong, it means that the measured body temperature has a high probability to be somewhere between 38.0 °C and 38.2 °C. In other (more general) terms, one could consider a measurement of a quantity <span class="math inline">\(X\)</span> as a probability <span class="math inline">\(P(x - \sigma &lt; X &lt; x + \sigma )\)</span> that the quantity <span class="math inline">\(X\)</span> has a value between <span class="math inline">\(x-\sigma\)</span> and <span class="math inline">\(x+\sigma\)</span>. The <strong>uncertainty</strong> <span class="math inline">\(\sigma\)</span> around the <strong>mean value</strong> <span class="math inline">\(x\)</span> is usually given as the <strong>standard deviation</strong> of the distribution of measurements around the mean.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since physical measurements are in fact <strong>probabilities</strong>, we <strong>can</strong> – and <strong>must</strong> – use <strong>statistical tools</strong> to characterize them.</p>
</div>
</div>
</section></section><section id="quantifying-the-properties-of-data" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="quantifying-the-properties-of-data">
<span class="header-section-number">2.2</span> Quantifying the properties of data</h2>
<section id="data-representation-presenting-a-measurement" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="data-representation-presenting-a-measurement">
<span class="header-section-number">2.2.1</span> Data representation – presenting a measurement</h3>
<p>Depending on the data you are looking at, various ways of representing them are possible. I can’t stress enough the importance of picking the right representation for your data, it is the expression of your physical sense. A good representation will help you make sense of your data and communicate your results. A bad representation, well…</p>
<section id="histograms" class="level4" data-number="2.2.1.1"><h4 data-number="2.2.1.1" class="anchored" data-anchor-id="histograms">
<span class="header-section-number">2.2.1.1</span> Histograms</h4>
<p>When looking at discrete values or when you want to characterize the distribution of a measurement, it is often a good idea to use the histogram representation, which represents the frequency at which a measurement is made within a certain range, called bin. Let’s take <a href="#fig-histogramT">Figure&nbsp;<span>2.1</span></a> and plot it with various bin sizes. One can see that the choice of bin size is important, as it determines whether your data are noisy or lack fine information.</p>
<div id="fig-histograms" class="cell quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-histograms-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-histograms-1.png" class="img-fluid figure-img" data-ref-parent="fig-histograms" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Bin width = 0.1 °C</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-histograms-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-histograms-2.png" class="img-fluid figure-img" data-ref-parent="fig-histograms" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Bin width = 0.2 °C</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-histograms-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-histograms-3.png" class="img-fluid figure-img" data-ref-parent="fig-histograms" width="672"></p>
<p></p><figcaption class="figure-caption">(c) Bin width = 1 °C</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.2: Histogram of the body temperature measurements with different bin widths.</figcaption><p></p>
</figure>
</div>
</section><section id="graphs" class="level4" data-number="2.2.1.2"><h4 data-number="2.2.1.2" class="anchored" data-anchor-id="graphs">
<span class="header-section-number">2.2.1.2</span> Graphs</h4>
<p>In case you want to represent continuous data, say the evolution of a quantity <span class="math inline">\(y\)</span> with respect to a quantity <span class="math inline">\(x\)</span>, you should then use the graph representation. As we saw before, any physical quantity should be given with its uncertainty and unit. <strong>The same applies to a graph</strong>: it <strong>must</strong> clearly display the <strong>units</strong> of the quantities <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and <strong>error bars</strong> that are usually taken as the standard deviation of each individual measurement (that should thus be performed a number of times, depending on what you are looking at).</p>
<div id="fig-graphs" class="cell quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-graphs-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-graphs-1.png" class="img-fluid figure-img" data-ref-parent="fig-graphs" width="672"></p>
<p></p><figcaption class="figure-caption">(a) Meaningless graph</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-graphs-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-graphs-2.png" class="img-fluid figure-img" data-ref-parent="fig-graphs" width="672"></p>
<p></p><figcaption class="figure-caption">(b) Noise</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-graphs-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-graphs-3.png" class="img-fluid figure-img" data-ref-parent="fig-graphs" width="672"></p>
<p></p><figcaption class="figure-caption">(c) Meaningful graph</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.3: Representing the same datapoints without error bars, with large error bars with respect to the data, and with small error bars with respect to the data: the difference between meaningless data, noise, and meaningful data.</figcaption><p></p>
</figure>
</div>
<p>You can think of each set of {datapoint + error bar} as an histogram: the displayed point is the mean value of the histogram, and the error bar is its standard deviation. <strong>Therefore, plotting a straight line between points is usually pointless</strong>. Plotting a line going through the data points only has meaning if this line results from a physical model explaining the variation of the quantity <span class="math inline">\(y\)</span> with the evolution of the quantity <span class="math inline">\(x\)</span> – this is called a <strong>fit</strong>, and we will see more about it in the <a href="#fitting">R class later</a>.</p>
</section></section><section id="characterizing-an-ensemble-of-measurements" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="characterizing-an-ensemble-of-measurements">
<span class="header-section-number">2.2.2</span> Characterizing an ensemble of measurements</h3>
<p>If we take <span class="math inline">\(N\)</span> repeated measurements of an observable <span class="math inline">\(x\)</span>, it is then natural to try to assess our knowledge of the ensemble of measures through (1) a single number representing the measured quantity, and (2) a second number representing the spread of measurements. As we saw before, the observable <span class="math inline">\(x\)</span> is thus generally defined by its central (mean) value <span class="math inline">\(\left&lt; x \right&gt;\)</span>, its spread <span class="math inline">\(\sigma_x\)</span> (standard deviation or uncertainty), and its unit.</p>
<section id="central-value-mode-median-and-mean" class="level4" data-number="2.2.2.1"><h4 data-number="2.2.2.1" class="anchored" data-anchor-id="central-value-mode-median-and-mean">
<span class="header-section-number">2.2.2.1</span> Central value: mode, median and mean</h4>
<p>The <strong>mode</strong> of an ensemble of measurements is its <em>most frequent value</em>. If the measurement in question is of a continuous variable, one has to bin the data in terms of a histogram in order to quantify the modal value of that distribution: the mode will be the position of the maximum of the histogram.</p>
<p>The <strong>median</strong> value of the ensemble is the value of <span class="math inline">\(x\)</span> for which there are an equal number of measurements above and below that point. If there is an even number of measurements, then the median value is taken as the midpoint between the two most central values.</p>
<p>The <strong>mean</strong> (or arithmetic average) is more often used than the two previous quantities, as it usually provides a better way to quantify the “typical” value measured. The mean value is denoted either by <span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\left&lt; x \right&gt;\)</span>, and is given by:</p>
<p><span class="math display">\[
\overline{x}=\left&lt; x \right&gt;=\frac{1}{N}\sum_{i=1}^Nx_i,
\]</span> where <span class="math inline">\(x_i\)</span> is the <span class="math inline">\(i\)</span>-th measurement of <span class="math inline">\(x\)</span>.</p>
<p><a href="#fig-histogramT">Figure&nbsp;<span>2.1</span></a> shows the representation of a sample of data plotted in a histogram. This figure shows the mode, mean and median. For this particular sample of data, the mean is 38.3 °C, the median is 38.1 °C, and the mode is 38.0 °C. The fact that the mode is smaller than the mean is an indication that the data are asymmetric about the mean. We usually refer to such a distribution as being skewed, and in this case the data are skewed to the right.</p>
</section><section id="quantifying-the-spread-of-data-variance-and-standard-deviation" class="level4" data-number="2.2.2.2"><h4 data-number="2.2.2.2" class="anchored" data-anchor-id="quantifying-the-spread-of-data-variance-and-standard-deviation">
<span class="header-section-number">2.2.2.2</span> Quantifying the spread of data: variance and standard deviation</h4>
<p>The mean of an ensemble of data doesn’t provide any information as to how the data are distributed. So any description of a set of data just quoting a mean value is incomplete. We need a second number in order to quantify the dispersion of data around the mean value. The average deviations from the mean, <span class="math inline">\(\left&lt; x-\overline{x} \right&gt;\)</span>, is not a useful quantity as, by definition, this will be zero for a symmetrically distributed sample of data (which is always the case for randomly distributed data – a consequence of the central limit theorem, as we will see later). We should rather consider the average value of the squared deviations from the mean as a measure of the spread of our ensemble of measurements. This is called the <strong>variance</strong> <span class="math inline">\(V(x)\)</span>, which is given by:</p>
<p><span id="eq-variance"><span class="math display">\[
\begin{aligned}
V(x)&amp;=\left&lt; (x-\overline{x})^2 \right&gt;\\
    &amp;=\frac{1}{N}\sum_{i=1}^N(x_i-\overline{x})^2\\
    &amp;=\overline{x^2}-\overline{x}^2
\end{aligned}
\tag{2.1}\]</span></span></p>
<p>The square root of the mean-squared (root-mean-squared or RMS) deviation is called the <strong>standard deviation</strong>, and this is given by:</p>
<p><span id="eq-sd"><span class="math display">\[
\begin{aligned}
\sigma(x)&amp;=\sqrt{V(x)}\\
         &amp;=\sqrt{\overline{x^2}-\overline{x}^2}
\end{aligned}
\tag{2.2}\]</span></span></p>
<p>The standard deviation quantifies the amount by which it is reasonable for a measurement of <span class="math inline">\(x\)</span> to differ from the mean value <span class="math inline">\(\overline{x}\)</span>. Considering a Gaussian distribution, we would expect to have 31.7% of measurements deviating from the mean value by more than 1<span class="math inline">\(\sigma\)</span>, and this goes down to 4.5% of measurements to deviate by more than 2<span class="math inline">\(\sigma\)</span>, and 0.3% of measurements to deviate by more than 3<span class="math inline">\(\sigma\)</span>. Thus, if we perform a measurement that deviates by a significant margin from the expected value of <span class="math inline">\(\left&lt; x \right&gt;\pm\sigma\)</span>, we need to ask ourselves about the significance of our measurement.</p>
<p>In general, scientists often prefer using the standard deviation rather than the variance when describing data, since as the former has the same units as the observable being measured.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>A measurement of a quantity <span class="math inline">\(x\)</span> is therefore usually presented under the form <span class="math inline">\(\left&lt; x \right&gt;\pm\sigma_x\)</span>, where <span class="math inline">\(\left&lt; x \right&gt;\)</span> is the arithmetic average and <span class="math inline">\(\sigma_x\)</span> is the standard deviation of the data.</p>
</div>
</div>
</section><section id="caveats" class="level4" data-number="2.2.2.3"><h4 data-number="2.2.2.3" class="anchored" data-anchor-id="caveats">
<span class="header-section-number">2.2.2.3</span> Caveats</h4>
<p>The above considerations all assume that the distribution of measured values is mono-modal, <em>i.e.</em> the histogram of the measured values is centered around a single value. In the case of a multimodal distribution such as shown in <a href="#fig-multimodal">Figure&nbsp;<span>2.4</span></a>, it would be meaningless to use such tools as the fine information on the distribution would be lost.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-multimodal" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-multimodal-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.4: A trimodal distribution of measurements. The red line shows the mean value of the distribution: it fails to grasp the reality of the distribution.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In this case, one should try to deconvolute the distribution in terms of individual peaks, and gather their positions, widths and intensities.</p>
</section></section></section><section id="useful-distributions" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="useful-distributions">
<span class="header-section-number">2.3</span> Useful distributions</h2>
<section id="probability-density-functions" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="probability-density-functions">
<span class="header-section-number">2.3.1</span> Probability Density Functions</h3>
<p>We should now introduce the notion of <strong>Probability Density Function</strong> (PDF). <em>By definition</em>, a PDF is a distribution where the <strong>total area is unity</strong>. The variation of the PDF is represents the probability of something occurring at that point in the parameter space. In general, a PDF will be described by some function <span class="math inline">\(P(x)\)</span>, where</p>
<p><span id="eq-PDFnorm"><span class="math display">\[
\int_a^b P(x)dx=1,
\tag{2.3}\]</span></span> where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the limits of the valid domain for the <span class="math inline">\(P(x)\)</span> function. The probability of obtaining a result between <span class="math inline">\(x\)</span> and <span class="math inline">\(x + dx\)</span> is thus <span class="math inline">\(P(x)dx\)</span>. Usual PDFs encountered in physics are the Poisson distribution as well as the Gaussian distribution, that we will describe in a bit.</p>
</section><section id="pdfs-mean-and-variance" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="pdfs-mean-and-variance">
<span class="header-section-number">2.3.2</span> PDFs, mean and variance</h3>
<p>Let us define a PDF <span class="math inline">\(P(x)\)</span> describing a continuous distribution. We can compute the average value of some quantity by computing the integral over this quantity multiplied by the PDF.</p>
<p>For example, the <strong>average value</strong> of the variable <span class="math inline">\(x\)</span>, distributed according to the PDF <span class="math inline">\(P(x)\)</span> in the domain <span class="math inline">\(-\infty &lt; x &lt;\infty\)</span>, is given by:</p>
<p><span id="eq-firstmoment"><span class="math display">\[
\begin{aligned}
\left&lt; x \right&gt;&amp;=\int_{-\infty}^{\infty}xP(x)dx\\
\text{or } \left&lt; x \right&gt;&amp;=\sum_{i}x_iP(x_i) \text{ in the case of a discrete distribution}
\end{aligned}
\tag{2.4}\]</span></span></p>
<p>This is called the <em>first moment</em> of the PDF.</p>
<p>This method can be used to compute average values of more complicated expressions. The mean value of <span class="math inline">\((x - \overline{x})^2\)</span>, <em>i.e.</em> the variance <span class="math inline">\(V\)</span>, is thus given by the <span class="math inline">\(\overline{x}\)</span>-centered second moment of the PDF, such as:</p>
<p><span id="eq-secondmoment"><span class="math display">\[
\begin{aligned}
V&amp;=\int_{-\infty}^{\infty}(x - \overline{x})^2P(x)dx\\
\text{or } V&amp;=\sum_{i}(x_i - \overline{x})^2P(x_i) \text{ in the case of a discrete distribution}
\end{aligned}
\tag{2.5}\]</span></span></p>
</section><section id="the-poisson-distribution" class="level3" data-number="2.3.3"><h3 data-number="2.3.3" class="anchored" data-anchor-id="the-poisson-distribution">
<span class="header-section-number">2.3.3</span> The Poisson distribution</h3>
<section id="definition" class="level4" data-number="2.3.3.1"><h4 data-number="2.3.3.1" class="anchored" data-anchor-id="definition">
<span class="header-section-number">2.3.3.1</span> Definition</h4>
<p>When a certain reaction happens randomly in time with an average frequency <span class="math inline">\(\lambda\)</span> in a given time interval, then the number <span class="math inline">\(k\)</span> of reactions in that time interval will follow a Poisson distribution:</p>
<p><span id="eq-poisson"><span class="math display">\[
P_\lambda(k) = \frac{\lambda^ke^{-\lambda}}{k!}
\tag{2.6}\]</span></span></p>
<p>Examples of encounters of Poisson distributions could be as various as the number of calls received per hours in a call center, the yearly number of Prussian soldiers killed by horse kicks… or the number of particles (photons, neutrons, neutrinos…) hitting a detector every second.</p>
<div id="fig-poissondistrib" class="cell quarto-layout-panel">
<figure class="figure"><div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-poissondistrib-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-poissondistrib-1.png" class="img-fluid figure-img" data-ref-parent="fig-poissondistrib" width="672"></p>
<p></p><figcaption class="figure-caption">(a)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-poissondistrib-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-poissondistrib-2.png" class="img-fluid figure-img" data-ref-parent="fig-poissondistrib" width="672"></p>
<p></p><figcaption class="figure-caption">(b)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-poissondistrib-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-poissondistrib-3.png" class="img-fluid figure-img" data-ref-parent="fig-poissondistrib" width="672"></p>
<p></p><figcaption class="figure-caption">(c)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.5: Poisson distribution for various parameters. While asymmetric for small values of <span class="math inline">\(k\)</span> and <span class="math inline">\(\lambda\)</span>, it tends towards a Gaussian lineshape at larger values.</figcaption><p></p>
</figure>
</div>
</section><section id="characteristics" class="level4" data-number="2.3.3.2"><h4 data-number="2.3.3.2" class="anchored" data-anchor-id="characteristics">
<span class="header-section-number">2.3.3.2</span> Characteristics</h4>
<p>As shown on <a href="#fig-poissondistrib">Figure&nbsp;<span>2.5</span></a>, for small <span class="math inline">\(\lambda\)</span> the distribution is asymmetric and skewed to the right. As <span class="math inline">\(\lambda\)</span> increases the Poisson distribution becomes more symmetric.</p>
<p>Following <a href="#eq-firstmoment">Equation&nbsp;<span>2.4</span></a>, the average number of observed events, <span class="math inline">\(\left&lt; k \right&gt;\)</span>, is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\left&lt; k \right&gt; &amp;= \sum_{k=0}^\infty kP_\lambda(k) = \sum_{k=1}^\infty k\frac{\lambda^ke^{-\lambda}}{k!}\\
        &amp;= \lambda e^{-\lambda} \sum_{k=1}^\infty \frac{\lambda^{k-1}}{(k-1)!}= \lambda e^{-\lambda} \sum_{k=0}^\infty \frac{\lambda^{k}}{k!}\\
        &amp;= \lambda
\end{aligned}
\]</span></p>
<p>In the same manner and by using the “trick” <span class="math inline">\(x^2=x(x-1)+x\)</span>, the variance <span class="math inline">\(\sigma^2(k)\)</span> of the distribution is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma^2(k) &amp;= \sum_{k=1}^\infty (k-\lambda)^2\frac{\lambda^k e^{-\lambda}}{k!}\\
        &amp;= \lambda e^{-\lambda} \left[\sum_{k=1}^\infty k^2\frac{\lambda^{k-1}}{k!} \underbrace{-2\lambda\sum_{k=1}^\infty \frac{\lambda^{k-1}}{(k-1)!}}_{-2\lambda e^\lambda}+\underbrace{\sum_{k=1}^\infty \lambda^2\frac{\lambda^{k-1}}{k!}}_{\lambda e^\lambda}\right]\\
        &amp;= \lambda e^{-\lambda} \left[ \underbrace{\sum_{k=2}^\infty k(k-1)\frac{\lambda^{k-1}}{k!}}_{\lambda e^\lambda} + \underbrace{\sum_{k=1}^\infty k\frac{\lambda^{k-1}}{k!}}_{e^\lambda} - \lambda e^\lambda\right]\\
        &amp;=\lambda = \left&lt; k \right&gt;
\end{aligned}
\]</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The important result here is that, <strong>when counting random events with an average of</strong> <span class="math inline">\(\left&lt; N \right&gt;\)</span>, <strong>the standard deviation is</strong> <span class="math inline">\(\sigma=\sqrt{\left&lt; N \right&gt;}\)</span>. This is typically what happens when performing a diffraction or spectroscopic measurement, such as X-ray diffraction, Raman, IR or neutron spectroscopy, etc.: the longer we acquire data, the higher the number of detected “events” <span class="math inline">\(N\)</span> (particle hits detector), and the “better is the statistics”. Indeed, the relative error is thus <span class="math inline">\(\sqrt{N}/N=1/\sqrt{N}\)</span>.</p>
<p>The consequence of this is that to make a factor 10 improvement on the relative error, one has to increase by 100 the number of events. This is usually done by increasing the acquisition time, which is fine as long as it is short enough. If irrealistic acquisition times start to become necessary, one should maybe try to find another way to increase <span class="math inline">\(N\)</span>: this can be done by improving the detector efficiency, increasing the probe (laser, neutron/x-ray) brightness, changing the experimental geometry, etc.</p>
<p>Finally, for “large” numbers (<span class="math inline">\(\lambda\gtrsim 100\)</span>) the Poisson distribution tends towards a symmetric Gaussian distribution that we will describe just after.</p>
</div>
</div>
</section></section><section id="the-gaussian-distribution" class="level3" data-number="2.3.4"><h3 data-number="2.3.4" class="anchored" data-anchor-id="the-gaussian-distribution">
<span class="header-section-number">2.3.4</span> The Gaussian distribution</h3>
<section id="definition-1" class="level4" data-number="2.3.4.1"><h4 data-number="2.3.4.1" class="anchored" data-anchor-id="definition-1">
<span class="header-section-number">2.3.4.1</span> Definition</h4>
<p>The Gaussian distribution, also known as the <em>normal distribution</em>, with a mean value <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> as a function of some variable <span class="math inline">\(x\)</span> is given by:</p>
<p><span class="math display">\[
P(x, \mu, \sigma)=\frac{1}{\sigma\sqrt{2\pi}}e^{-(x-\mu)^2/2\sigma^2}
\]</span></p>
<p>It is useful to transform data from the <span class="math inline">\(x\)</span> space to a corresponding <span class="math inline">\(z\)</span> space which has a mean value of zero, and a standard deviation of one. This transformation is given by the mapping <span class="math inline">\(z=\frac{x-\mu}{\sigma}\)</span>, and the Gaussian distribution in terms of <span class="math inline">\(z\)</span> is thus:</p>
<p><span class="math display">\[
P(z)=\frac{1}{\sqrt{2\pi}}e^{-z^2/2}
\]</span></p>
</section><section id="characteristics-1" class="level4" data-number="2.3.4.2"><h4 data-number="2.3.4.2" class="anchored" data-anchor-id="characteristics-1">
<span class="header-section-number">2.3.4.2</span> Characteristics</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gaussian" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="02-stats_files/figure-html/fig-gaussian-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;2.6: A zero-centered Gaussian distribution with standard deviation of 1, <span class="math inline">\(P(z)\)</span>. The red line marks the half maximum, <span class="math inline">\(P(z_{HM})=1/2\sqrt{2\pi}\)</span>, and the blue lines the values of <span class="math inline">\(z\)</span> for which the half maximum is obtained, <span class="math inline">\(z_{HM}=\pm\sqrt{2\ln{2}}\)</span>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Sometimes instead of quantifying a Gaussian distribution (or any monomodal distribution, for that matter) using the variance or standard deviation, scientists will speak about the full width at half maximum (<strong>FWHM</strong>). This has the advantage that any extreme outliers of the distribution do not contribute to the quantification of the spread of data. As the name suggests, the FWHM is the width of the distribution (the spread above and below the mean) at the points where the distribution reaches half of its maximum.</p>
<p>For a Gaussian distribution <span class="math inline">\(P(z)\)</span>, the half maximum is attained when <span class="math inline">\(z_{HM}\)</span> is so that:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{1}{\sqrt{2\pi}}e^{-z_{HM}^2/2}&amp;= \frac{1}{2}\frac{1}{\sqrt{2\pi}}\\
\Rightarrow z_{HM}&amp;=\pm\sqrt{2\ln{2}}
\end{aligned}
\]</span></p>
<p>The FWHM of <span class="math inline">\(P(z)\)</span> is therefore <span class="math inline">\(FWHM=2\sqrt{2\ln{2}}\simeq2.355\)</span>. Using the relation between <span class="math inline">\(z\)</span> and <span class="math inline">\(\sigma\)</span>, we get the relation between the FWHM and the standard deviation:</p>
<p><span class="math display">\[
FWHM=2\sqrt{2\ln{2}}\times\sigma
\]</span></p>
<p>As can be seen on <a href="#tbl-tablevalues">Table&nbsp;<span>2.1</span></a>, using the FWHM ensures that roughly 76% of the data are comprised between <span class="math inline">\(\mu-\sigma\)</span> and <span class="math inline">\(\mu+\sigma\)</span>, and this goes up to <span class="math inline">\(\sim95\)</span>% for <span class="math inline">\(\mu-2\sigma\)</span> and <span class="math inline">\(\mu+2\sigma\)</span>.</p>
<div id="tbl-tablevalues" class="anchored">
<table class="table">
<caption>Table&nbsp;2.1: Integral values for various values of <span class="math inline">\(a\)</span> in <span class="math inline">\(\int_{-a}^aP(z)dz\)</span>.</caption>
<thead><tr class="header">
<th style="text-align: left;">Integration range <span class="math inline">\(a\)</span>
</th>
<th style="text-align: left;"><span class="math inline">\(\int_{-a}^aP(z)dz\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\sigma\)</span></td>
<td style="text-align: left;">0.68293</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\sqrt{2\ln{2}}\sigma\)</span></td>
<td style="text-align: left;">0.76100</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(2\sigma\)</span></td>
<td style="text-align: left;">0.95455</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(3\sigma\)</span></td>
<td style="text-align: left;">0.99730</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(4\sigma\)</span></td>
<td style="text-align: left;">0.99994</td>
</tr>
</tbody>
</table>
</div>

<!-- 
#| label: tbl-tablevalues
#| tbl-cap: "Integral values for various values of $a$ in $\\int_{-a}^aP(z)dz$."
#| warning: false
#| message: false
#| echo: false
x <- seq(-10,10,.001)
y <- dnorm(x,0,1)
integral <- function(x,a=1) {
    sprintf("%.5f", sum(y[abs(x) <= a] * (x[2] - x[1])))
}
dat <- tibble(`Integration range $a$` = c("$\\sigma$", "$\\sqrt{2\\ln{2}}\\sigma$", "$2\\sigma$", "$3\\sigma$", "$4\\sigma$"),
       `$\\int_{-a}^aP(z)dz$` = c(integral(x, a = 1), integral(x, a = sqrt(2 * log(2))), integral(x, a = 2), integral(x, a = 3), integral(x, a = 4))
      )
knitr::kable(dat)
-->
</section></section></section><section id="usual-statistical-tests-on-distributions" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="usual-statistical-tests-on-distributions">
<span class="header-section-number">2.4</span> Usual statistical tests on distributions</h2>
<section id="hypothesis-testing-and-p-values" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="hypothesis-testing-and-p-values">
<span class="header-section-number">2.4.1</span> Hypothesis testing and p-values</h3>
<p>A <strong>hypothesis test</strong> is a statistical test that is used to determine whether a given hypothesis is true or not. It is based on the comparison of the observed data with the expected data, given the hypothesis.</p>
<p>The <strong>null hypothesis</strong> (usually noted <span class="math inline">\(H_0\)</span>) is the hypothesis that is tested, and the <strong>alternative hypothesis</strong> (usually noted <span class="math inline">\(H_1\)</span>) is the hypothesis that is assumed to be true if the null hypothesis is rejected.</p>
<p>The <strong>p-value</strong> is the probability of obtaining a fluctuation in data under the null hypothesis that is as, or more, extreme than that observed by a given experiment. If the p-value is smaller than a predifined tolerance (usually set to 0.05), then one might consider rejecting the null hypothesis as the probability of observing such a fluctuation under the null hypothesis is extremely small.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>If the <strong>p-value</strong> <span class="math inline">\(\ge\alpha\)</span> (typically 0.05), the null hypothesis is accepted.</li>
<li>If the <strong>p-value</strong> is below a certain threshold <span class="math inline">\(\alpha\)</span>, the null hypothesis is rejected.</li>
</ul>
</div>
</div>
<p>In R, most tests will automatically return a p-value, which will help you decide whether the test is conclusive or not – we will not delve into the details of computing these p-values.</p>
</section><section id="asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test">
<span class="header-section-number">2.4.2</span> Asserting the Gaussian nature of a distribution: the Shapiro–Wilk test</h3>
<p>The Shapiro-Wilk test is a statistical test that can be used to determine whether a distribution of data is Gaussian or not. It is based on the comparison of the observed distribution with the expected distribution of a Gaussian distribution with the same mean and standard deviation. Its <strong>null hypothesis</strong> is that the data are normally distributed, thus:</p>
<ul>
<li>If the <strong>p-value</strong> <span class="math inline">\(\lt\alpha\)</span>, the null hypothesis is rejected and the data are not normally distributed.</li>
<li>If the <strong>p-value</strong> <span class="math inline">\(\ge\alpha\)</span>, the null hypothesis is not rejected and the data are normally distributed.</li>
</ul>
<p>Let’s perform a Shapiro-Wilk test on the distribution of the data in <a href="#fig-histogramT">Figure&nbsp;<span>2.1</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">38</span>, <span class="fl">38.1</span>, <span class="fl">38.0</span>, <span class="fl">38.0</span>, <span class="fl">38.3</span>, <span class="fl">37.9</span>, <span class="fl">38.1</span>, <span class="fl">38.2</span>, <span class="fl">39.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  temp
#&gt; W = 0.57969, p-value = 5.526e-05</code></pre>
</div>
</div>
<p>We see here that the p-value is 5.53e-05, which is below the threshold <span class="math inline">\(\alpha\)</span> = 0.05. This means that <strong>it is extremely unlikely that you’d observe such measurements if their distribution were normal</strong>. The null hypothesis that the data are normally distributed is thus rejected, and we can conclude that the data are not normally distributed – as expected from their representation in <a href="#fig-histogramT">Figure&nbsp;<span>2.1</span></a>.</p>
<p>If we were to remove the outlier (39.8) and perform the test again, we would get a p-value of 0.592, which means that there is a 59.2% chance to observe such measurements if their distribution were normal. As p-value &gt; 0.05, the null hypothesis that the data are normally distributed is not rejected, and we can conclude that the data are normally distributed.</p>
</section><section id="students-t-test" class="level3" data-number="2.4.3"><h3 data-number="2.4.3" class="anchored" data-anchor-id="students-t-test">
<span class="header-section-number">2.4.3</span> Student’s t-test</h3>
<p>The Student’s t-test is a statistical test that can be used to determine whether two sets of data are significantly different from each other. Its <strong>null hypothesis</strong> is that <strong>the two sets of data are drawn from the same distribution</strong>, thus:</p>
<ul>
<li>If the <strong>p-value</strong> <span class="math inline">\(\lt\alpha\)</span>, the null hypothesis is rejected and the data are not drawn from the same distribution.</li>
<li>If the <strong>p-value</strong> <span class="math inline">\(\ge\alpha\)</span>, the null hypothesis is not rejected and the data are drawn from the same distribution.</li>
</ul>
<p>Let’s work on two sets of temperature measurements performed on two different days on two different person. We want to assert whether the temperature evolution between the two days is significant or not for each patient. For the sake of example, let’s say that in both cases, they present the same average temperature on day 1 and on day 2 but with a different spread in data.</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">temps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Day1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">38.5</span>, <span class="fl">.2</span><span class="op">)</span>,</span>
<span>                 Day2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">37.7</span>, <span class="fl">.3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                         names_to <span class="op">=</span> <span class="st">"Day"</span>, </span>
<span>                         values_to <span class="op">=</span>  <span class="st">"Temperature"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Patient<span class="op">=</span><span class="st">"A"</span><span class="op">)</span></span>
<span><span class="va">temps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Day1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">38.5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                 Day2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">37.7</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                         names_to <span class="op">=</span> <span class="st">"Day"</span>, </span>
<span>                         values_to <span class="op">=</span> <span class="st">"Temperature"</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>            <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Patient<span class="op">=</span><span class="st">"B"</span><span class="op">)</span></span>
<span><span class="va">temperatures</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">temps1</span>, <span class="va">temps2</span><span class="op">)</span></span>
<span><span class="va">temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Day</span>, y <span class="op">=</span> <span class="va">Temperature</span>, color <span class="op">=</span> <span class="va">Patient</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.04</span>, size <span class="op">=</span> <span class="fl">2</span>, alpha <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>notch<span class="op">=</span><span class="cn">TRUE</span>, position <span class="op">=</span> <span class="st">"identity"</span>, </span>
<span>                     fill<span class="op">=</span><span class="cn">NA</span>, width<span class="op">=</span><span class="fl">.2</span>, </span>
<span>                     show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, </span>
<span>                     fill<span class="op">=</span><span class="cn">NA</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"royalblue"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"orange"</span>, <span class="st">"royalblue"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="st">"mean"</span>, size <span class="op">=</span> <span class="fl">4</span>, geom <span class="op">=</span> <span class="st">"point"</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x     <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>             y     <span class="op">=</span> <span class="st">"Temperature [˚C]"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-stats_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">

</div>
<p>Data means and 95% confidence intervals:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">Temperature</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>CI <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu">Rmisc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rmisc/man/CI.html">CI</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">Temperature</span>,ci<span class="op">=</span><span class="fl">.95</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">CI</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 6
#&gt;   Day   Patient data               upper  mean lower
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;list&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 Day1  A       &lt;tibble [100 × 1]&gt;  38.6  38.5  38.5
#&gt; 2 Day2  A       &lt;tibble [100 × 1]&gt;  37.8  37.7  37.7
#&gt; 3 Day1  B       &lt;tibble [100 × 1]&gt;  39.0  38.4  37.9
#&gt; 4 Day2  B       &lt;tibble [100 × 1]&gt;  38.5  38.0  37.4</code></pre>
</div>
</div>
<p>We want to determine whether the temperature evolution between the two days is significant or not for each patient. We can perform a Student’s t-test to assert whether the two sets of data are significantly different from each other.</p>
<p>First, <strong>to apply a t-test, we need to make sure that the data are normally distributed</strong>, which we can do by performing a Shapiro-Wilk test on each set of data:</p>
<div class="cell" data-layout-align="center">
<details><summary>Show the code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Temperature</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>shapiro <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">Temperature</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'statistic'</span>,<span class="st">'p.value'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">shapiro</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 5
#&gt;   Day   Patient data               statistic p.value
#&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;list&gt;                 &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 Day1  A       &lt;tibble [100 × 1]&gt;     0.996   0.992
#&gt; 2 Day2  A       &lt;tibble [100 × 1]&gt;     0.982   0.188
#&gt; 3 Day1  B       &lt;tibble [100 × 1]&gt;     0.990   0.649
#&gt; 4 Day2  B       &lt;tibble [100 × 1]&gt;     0.991   0.754</code></pre>
</div>
</div>
<p>In all cases the p-value is above 0.05, which means that the null hypothesis that the data are normally distributed is not rejected, and <strong>we can conclude that the data are normally distributed</strong>. The application of the t-test is thus valid.</p>
<p>Let’s start now with patient A:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Patient</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="va">Day</span><span class="op">==</span><span class="st">"Day1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Temperature</span><span class="op">)</span>, </span>
<span>       <span class="va">temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Patient</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="va">Day</span><span class="op">==</span><span class="st">"Day2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Temperature</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  temperatures %&gt;% filter(Patient == "A", Day == "Day1") %&gt;% pull(Temperature) and temperatures %&gt;% filter(Patient == "A", Day == "Day2") %&gt;% pull(Temperature)
#&gt; t = 22.562, df = 165.57, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: true difference in means is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  0.7265649 0.8659216
#&gt; sample estimates:
#&gt; mean of x mean of y 
#&gt;  38.51502  37.71878</code></pre>
</div>
</div>
<p>As could be intuited by the graphical representation, the t-test on patient A shows that their temperature decreased significantly between day 1 and day 2, with a p-value of 2.22e-52, which is largely below the threshold <span class="math inline">\(\alpha\)</span> = 0.05. To report it properly, we can say that “the temperature of patient A on day 1 (38.52˚C, 95% CI = [38.48, 38.55]˚C), was statistically significantly higher than on day 2 (37.72˚C, 95% CI = [37.66, 37.78]˚C), t(165.57) = 22.56, p = 2.22e-52.” Here , 165.57 is the degrees of freedom associated with the t test-statistic. The 95% confidence interval for the difference between the means is 0.73˚C to 0.87˚C.</p>
<p>For patient B however, even though the average temperature decreased between the two days, the spread in data is so large that the t-test does not allow concluding concerning any significant temperature difference between the two days:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Patient</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="va">Day</span><span class="op">==</span><span class="st">"Day1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Temperature</span><span class="op">)</span>, </span>
<span>       <span class="va">temperatures</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Patient</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="va">Day</span><span class="op">==</span><span class="st">"Day2"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">Temperature</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  temperatures %&gt;% filter(Patient == "B", Day == "Day1") %&gt;% pull(Temperature) and temperatures %&gt;% filter(Patient == "B", Day == "Day2") %&gt;% pull(Temperature)
#&gt; t = 1.1748, df = 197.68, p-value = 0.2415
#&gt; alternative hypothesis: true difference in means is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -0.3102556  1.2246921
#&gt; sample estimates:
#&gt; mean of x mean of y 
#&gt;  38.43423  37.97701</code></pre>
</div>
</div>
</section></section><section id="uncertainty-and-errors" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="uncertainty-and-errors">
<span class="header-section-number">2.5</span> Uncertainty and errors</h2>
<section id="central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty" class="level3" data-number="2.5.1"><h3 data-number="2.5.1" class="anchored" data-anchor-id="central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty">
<span class="header-section-number">2.5.1</span> Central limit theorem: on the Gaussian nature of statistical uncertainty</h3>
<p>The <strong>central limit theorem</strong> states that if one takes <span class="math inline">\(N\)</span> random independent samples of a distribution of data that describes some variable <span class="math inline">\(x\)</span>, then as <span class="math inline">\(N\)</span> tends to infinity, the distribution of the sum of the samples tends to a Gaussian distribution.</p>
<p>In other terms: the mean value of a large number <span class="math inline">\(N\)</span> of independent random variables (that can be distributed following any distribution with finite variance), obeying the same distribution with variance <span class="math inline">\(\sigma_0^2\)</span>, approaches a normal distribution with variance <span class="math inline">\(\sigma^2 = \sigma _0^2/N\)</span>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>This result is fundamental</strong> as it implies that <strong>independent measurements of any observable will show values that will be spread following a Gaussian distribution</strong>, and thus statistical uncertainties that are Gaussian in nature.</p>
<p>Moreover, we see here the typical property of statistical errors, which is that <strong>the relative error is proportional to</strong> <span class="math inline">\(1/\sqrt{N}\)</span>. Increasing the number of observations thus decreases the error, <em>i.e.</em> increases the precision.</p>
</div>
</div>
</section><section id="combination-of-errors" class="level3" data-number="2.5.2"><h3 data-number="2.5.2" class="anchored" data-anchor-id="combination-of-errors">
<span class="header-section-number">2.5.2</span> Combination of errors</h3>
<p>Let us consider a function of <span class="math inline">\(n\)</span> variables, <span class="math inline">\(f(u_1, u_2, ..., u_n)\)</span>. We can Taylor expand this function about the various mean values <span class="math inline">\(u_i=\overline{u_i}\)</span>, so that, at the first order:</p>
<p><span class="math display">\[
f(u_1, ..., u_n) = f(\overline{u_1}, ..., \overline{u_n}) + \sum_{i=1}^n (u_i-\overline{u_i})\frac{\partial f}{\partial u_i}
\]</span></p>
<p>Considering that the variance of a quantity <span class="math inline">\(f\)</span> is given by <span class="math inline">\(\sigma^2(f) = (f - \overline{f} )^2\)</span>, it follows that the variance of our multivariable function is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma^2(f) &amp;= \left(\sum_{i=1}^n (u_i-\overline{u_i})\frac{\partial f}{\partial u_i}\right)^2\\
         &amp;= \sum_{i=1}^n \left(\frac{\partial f}{\partial u_i}\right)^2\sigma_{u_i}^2 + 2\sum_{i\ne j}\frac{\partial f}{\partial u_i}\frac{\partial f}{\partial u_j}\sigma_{u_iu_j}\\
\end{aligned}
\]</span> where we have replaced <span class="math inline">\((u_i-\overline{u_i})^2\)</span> by the variance <span class="math inline">\(\sigma_{u_i}^2\)</span> and <span class="math inline">\((u_i-\overline{u_i})(u_j-\overline{u_j})\)</span> by the covariance <span class="math inline">\(\sigma_{u_iu_j}\)</span>.<br></p>
<p>If the variables <span class="math inline">\(u_i\)</span> are independent then the covariance <span class="math inline">\(\sigma_{u_iu_j}\)</span> is null, and it follows the general expression of the standard error that can be applied to <strong>any function of independent variables</strong>:</p>
<div class="callout-note callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><span id="eq-uncertainty"><span class="math display">\[
\sigma(f) = \sqrt{\sum_{i=1}^n \left(\frac{\partial f}{\partial u_i}\right)^2\sigma_{u_i}^2}
\tag{2.7}\]</span></span></p>
</div>
</div>
</div>
<section id="functions-of-one-variable" class="level4" data-number="2.5.2.1"><h4 data-number="2.5.2.1" class="anchored" data-anchor-id="functions-of-one-variable">
<span class="header-section-number">2.5.2.1</span> Functions of one variable</h4>
<p>Let us consider a function <span class="math inline">\(f\)</span> having a form that depends only on one observable <span class="math inline">\(x\)</span>, for example:</p>
<p><span class="math display">\[
f = Ax + B
\]</span></p>
<p>Then, following <a href="#eq-uncertainty">Equation&nbsp;<span>2.7</span></a>, the standard error on that function is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma_f &amp;= \sqrt{\left(\frac{\partial f}{\partial x}\right)^2\sigma_x^2}\\
         &amp;= A\sigma_x
\end{aligned}
\]</span></p>
<p>So, <strong>independently of any offset of the measured observable</strong>, the resulting error must be corrected by the same factor as the intensity.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>In practice</strong>, let’s say we measure a Raman spectrum. As we saw above, the error on each intensity count is given by the square root of this intensity count.</p>
<ul>
<li>It is possible to shift vertically this spectrum without having to recompute the error bars.</li>
<li>But if you want to normalize (say, to 1) this spectrum, you have to multiply all the errors by the renormalization constant.</li>
</ul>
</div>
</div>
</section><section id="functions-of-two-variables" class="level4" data-number="2.5.2.2"><h4 data-number="2.5.2.2" class="anchored" data-anchor-id="functions-of-two-variables">
<span class="header-section-number">2.5.2.2</span> Functions of two variables</h4>
<p>Now consider the function <span class="math inline">\(f = Ax + By\)</span>, where we have measured the mean and standard deviation of both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and want to compute the standard deviation on their sum/subtraction. We can use the general formula of <a href="#eq-uncertainty">Equation&nbsp;<span>2.7</span></a> to determine how to do this, hence:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma_f &amp;= \sqrt{\left(\frac{\partial f}{\partial x}\right)^2\sigma_x^2 + \left(\frac{\partial f}{\partial y}\right)^2\sigma_y^2}\\
         &amp;= \sqrt{A^2\sigma_x^2 + B^2\sigma_y^2}
\end{aligned}
\]</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>In practice</strong>, let’s say we measure an UV spectrum of a solution (a molecule in a solvent), and a reference spectrum of this solvent. As we saw above, the error on each intensity count is given by the square root of this intensity count. We want to subtract the signal of the solvent to get only the signal of the molecule.</p>
<p>We thus have to perform the above operation on the errors, <span class="math inline">\(\sigma_{result}=\sqrt{\sigma^2_{solution}+\sigma^2_{reference}}\)</span>. It means that in order to have a statistically sound resulting spectrum, the reference needs to be measured with a very good statistics in order to not dominate the resulting error.</p>
</div>
</div>
<p>It is a good thing to think about error propagation and where it comes from… but you don’t have to bother computing it by hand, as <a href="17-units.html#working-with-experimental-errors">packages are here to do it for you</a>, as we will see later in the class.</p>
</section></section></section><section id="further-reading" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="further-reading">
<span class="header-section-number">2.6</span> Further reading</h2>
<ul>
<li>A. Bevan, <em><a href="https://www.cambridge.org/core/books/statistical-data-analysis-for-the-physical-sciences/2E3D132870E72277EE5FB96FE616B9F1">Statistical Data Analysis for the Physical Sciences</a></em>, Cambridge University Press (2013)</li>
<li>G. Bohm, <em><a href="http://www-library.desy.de/preparch/books/vstatmp_engl.pdf">Introduction to Statistics and Data Analysis for Physicists</a></em>, Hamburg: Verl. Dt. Elektronen-Synchrotron (2010).</li>
<li>J. Watkins, <em><a href="https://www.math.arizona.edu/~jwatkins/statbook.pdf">An Introduction to the Science of Statistics</a></em>
</li>
</ul>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./01-about.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About the class</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-getting_ready.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting ready</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb12" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># A little reminder on Statistics</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE, warning = FALSE, cache=FALSE}</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantities)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">fig.align =</span> <span class="st">"center"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">size=</span><span class="dv">1</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"royalblue"</span>,<span class="st">"seagreen"</span>,<span class="st">"orange"</span>,<span class="st">"red"</span>))</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why are statistical tools necessary in physical science?</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>When doing Science, one has to fully grasp the concept of *physical measurement*. Let's take an example to visualize the importance of this concept.</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a><span class="fu">### A practical example</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>Let's say you want to communicate to someone a temperature, and tell this person that the temperature is "38". If this is a random person in the street, they might think: "nice, let's go to the beach today!". If this random person is from the USA, they're gonna think: "damn, where did I put my coat?". If that person happens to be a physician, they might think: "that kid's got a slight fever". If they are a physicist doing a cryostat experiment, they might think "let's check the He tank level"... you see that one of the most important part of the measurement is missing: its unit. Units are there so that people understand each other when exchanging data, and you see here that 38 Celsius, 38 Fahrenheit or 38 Kelvin are quite different, and this quantity will mean different things in different contexts. A physical quantity given without its unit would be absolutely meaningless (unless, of course, you are looking at a unit-less quantity, like a count).</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>Now let's consider the body temperature of 38 °C given to a physician. How did you measure this temperature? With a mercury graduated thermometer or with a thermocouple? In the first case, you can probably assume that this value is given with a measurement error of at least 1 °C, meaning that the temperature you give to the physician is (38±1) °C, *i.e.* the physician won't be able to decide whether they should be concerned or not. In the second case, the temperature is often given with a 0.1 °C precision, so the physician, seeing that the body temperature is (38±0.1) °C, will probably tell you to take an aspirin and rest instead of giving you something stronger to treat a possible infection. Given that the uncertainty on the given value is of 0.1 °C, one should in fact give the temperature with matching decimal precision, *i.e.* (38.0±0.1) °C. Writing (38±0.1) °C, (38.00001±0.1) °C or (38.00±0.10000) °C would be meaningless too.</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>With this, we see that a physical measurement should be given with four parts: its actual **value**, its **decimal precision**, its **uncertainty**, and its **unit**. Should any of these four parts be missing in a physical quantity that you wanted to share, it would at best be imprecise, and at worst be utterly meaningless.</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilistic description of physical systems</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>Let's continue with our example of the body temperature measured with a thermocouple or a laser thermometer with a 0.1 °C precision.</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>Our first measurement of the body temperature yielded (38.0±0.1) °C. Now let's repeat this measurement a number of times in various area of the body (which are left to your imagination). Let's say it then shows (38.1±0.1) °C, (38.0±0.1) °C, (38.3±0.1) °C, (37.9±0.1) °C, (38.2±0.1) °C, (38.1±0.1) °C, (38.1±0.1) °C, (39.8±0.1) °C. What is the actual body temperature then? Should we stick to a single measurement? Of course not. We have to make an histogram of the measured values, and study the distribution of the measurements (@fig-histogramT). We can then see that one of the values is clearly an outlier -- something might have gone wrong there. What if we had done the measurement only once and only measured that value? We might have jumped to a very wrong conclusion, with possibly a very serious consequence like giving the wrong medicine.</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-histogramT</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Histogram of the body temperature measurements. The red line is the mean value, the orange one is the mode and the blue one is the median.</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">T=</span><span class="fu">c</span>(<span class="dv">38</span>, <span class="fl">38.1</span>, <span class="fl">38.0</span>, <span class="fl">38.0</span>, <span class="fl">38.3</span>, <span class="fl">37.9</span>, <span class="fl">38.1</span>, <span class="fl">38.2</span>, <span class="fl">39.8</span>))</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T)) <span class="sc">+</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_histogram</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">38</span>, <span class="at">color=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"T [°C]"</span>)</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>With this example, we see that **a physical measurement is not absolute**. In fact, a physical measurement is an assessment of the **probability** that the physical value is within a certain range. In the case of our example, after removing the outlier for which we are certain that the measurement is wrong, it means that the measured body temperature has a high probability to be somewhere between 38.0 °C and 38.2 °C.</span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>In other (more general) terms, one could consider a measurement of a quantity $X$ as a probability $P(x - \sigma &lt; X &lt; x + \sigma )$ that the quantity $X$ has a value between $x-\sigma$ and $x+\sigma$. The **uncertainty** $\sigma$ around the **mean value** $x$ is usually given as the **standard deviation** of the distribution of measurements around the mean.</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>Since physical measurements are in fact **probabilities**, we **can** -- and **must** -- use **statistical tools** to characterize them.</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantifying the properties of data</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data representation -- presenting a measurement</span></span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>Depending on the data you are looking at, various ways of representing them are possible. I can't stress enough the importance of picking the right representation for your data, it is the expression of your physical sense. A good representation will help you make sense of your data and communicate your results. A bad representation, well...</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Histograms</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a>When looking at discrete values or when you want to characterize the distribution of a measurement, it is often a good idea to use the histogram representation, which represents the frequency at which a measurement is made within a certain range, called bin. Let's take @fig-histogramT and plot it with various bin sizes. One can see that the choice of bin size is important, as it determines whether your data are noisy or lack fine information.</span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-histograms</span></span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Histogram of the body temperature measurements with different bin widths.</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Bin width = 0.1 °C"</span></span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Bin width = 0.2 °C"</span></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Bin width = 1 °C"</span></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">T=</span><span class="fu">c</span>(<span class="dv">38</span>, <span class="fl">38.1</span>, <span class="fl">38.0</span>, <span class="fl">38.0</span>, <span class="fl">38.3</span>, <span class="fl">37.9</span>, <span class="fl">38.1</span>, <span class="fl">38.2</span>, <span class="fl">39.8</span>))</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T)) <span class="sc">+</span></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_histogram</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">xintercept =</span> <span class="fu">mean</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">xintercept =</span> <span class="fu">median</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"T [°C]"</span>)</span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T)) <span class="sc">+</span></span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_histogram</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">binwidth =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">xintercept =</span> <span class="fu">mean</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">xintercept =</span> <span class="fu">median</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"T [°C]"</span>)</span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T)) <span class="sc">+</span></span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_histogram</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">binwidth =</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"T [°C]"</span>)</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Graphs</span></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>In case you want to represent continuous data, say the evolution of a quantity $y$ with respect to a quantity $x$, you should then use the graph representation. As we saw before, any physical quantity should be given with its uncertainty and unit. **The same applies to a graph**: it **must** clearly display the **units** of the quantities $x$ and $y$, and **error bars** that are usually taken as the standard deviation of each individual measurement (that should thus be performed a number of times, depending on what you are looking at). </span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-graphs</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Representing the same datapoints without error bars, with large error bars with respect to the data, and with small error bars with respect to the data: the difference between meaningless data, noise, and meaningful data."</span></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Meaningless graph"</span></span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Noise"</span></span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Meaningful graph"</span></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">1</span>), </span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span><span class="dv">1</span><span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">10</span>,<span class="at">sd=</span><span class="dv">5</span>)<span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">58</span>,<span class="at">sd=</span><span class="dv">10</span>)<span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">75</span>,<span class="at">sd=</span><span class="dv">15</span>)<span class="sc">+</span>.<span class="dv">01</span><span class="sc">*</span><span class="fu">runif</span>(<span class="fu">length</span>(x)),</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>              <span class="at">dy1=</span>.<span class="dv">1</span><span class="sc">/</span>y,</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>              <span class="at">dy2=</span>.<span class="dv">1</span><span class="sc">*</span>(y<span class="dv">-1</span>)</span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"x"</span>, <span class="at">y=</span><span class="st">"y"</span>)</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>y<span class="sc">-</span>dy1,<span class="at">ymax=</span>y<span class="sc">+</span>dy1))<span class="sc">+</span></span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"x [unit]"</span>, <span class="at">y=</span><span class="st">"y [unit]"</span>)</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>y<span class="sc">-</span>dy2,<span class="at">ymax=</span>y<span class="sc">+</span>dy2))<span class="sc">+</span></span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"x [unit]"</span>, <span class="at">y=</span><span class="st">"y [unit]"</span>)</span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-162"><a href="#cb12-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-163"><a href="#cb12-163" aria-hidden="true" tabindex="-1"></a>You can think of each set of {datapoint + error bar} as an histogram: the displayed point is the mean value of the histogram, and the error bar is its standard deviation. **Therefore, plotting a straight line between points is usually pointless**. Plotting a line going through the data points only has meaning if this line results from a physical model explaining the variation of the quantity $y$ with the evolution of the quantity $x$ -- this is called a **fit**, and we will see more about it in the <span class="co">[</span><span class="ot">R class later</span><span class="co">](#fitting)</span>.</span>
<span id="cb12-164"><a href="#cb12-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-165"><a href="#cb12-165" aria-hidden="true" tabindex="-1"></a><span class="fu">### Characterizing an ensemble of measurements</span></span>
<span id="cb12-166"><a href="#cb12-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-167"><a href="#cb12-167" aria-hidden="true" tabindex="-1"></a>If we take $N$ repeated measurements of an observable $x$, it is then natural to try to assess our knowledge of the ensemble of measures through (1) a single number representing the measured quantity, and (2) a second number representing the spread of measurements. As we saw before, the observable $x$ is thus generally defined by its central (mean) value $\left&lt; x \right&gt;$, its spread $\sigma_x$ (standard deviation or uncertainty), and its unit. </span>
<span id="cb12-168"><a href="#cb12-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-169"><a href="#cb12-169" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Central value: mode, median and mean</span></span>
<span id="cb12-170"><a href="#cb12-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-171"><a href="#cb12-171" aria-hidden="true" tabindex="-1"></a>The **mode** of an ensemble of measurements is its *most frequent value*. If the measurement in question is of a continuous variable, one has to bin the data in terms of a histogram in order to quantify the modal value of that distribution: the mode will be the position of the maximum of the histogram.</span>
<span id="cb12-172"><a href="#cb12-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-173"><a href="#cb12-173" aria-hidden="true" tabindex="-1"></a>The **median** value of the ensemble is the value of $x$ for which there are an equal number of measurements above and below that point. If there is an even number of measurements, then the median value is taken as the midpoint between the two most central values.</span>
<span id="cb12-174"><a href="#cb12-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-175"><a href="#cb12-175" aria-hidden="true" tabindex="-1"></a>The **mean** (or arithmetic average) is more often used than the two previous quantities, as it usually provides a better way to quantify the "typical" value measured. The mean value is denoted either by $\overline{x}$ or $\left&lt; x \right&gt;$, and is given by:</span>
<span id="cb12-176"><a href="#cb12-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-177"><a href="#cb12-177" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-178"><a href="#cb12-178" aria-hidden="true" tabindex="-1"></a>\overline{x}=\left&lt; x \right&gt;=\frac{1}{N}\sum_{i=1}^Nx_i,</span>
<span id="cb12-179"><a href="#cb12-179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-180"><a href="#cb12-180" aria-hidden="true" tabindex="-1"></a>where $x_i$ is the $i$-th measurement of $x$. </span>
<span id="cb12-181"><a href="#cb12-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-182"><a href="#cb12-182" aria-hidden="true" tabindex="-1"></a>@fig-histogramT shows the representation of a sample of data plotted in a histogram. This figure shows the mode, mean and median. For this particular sample of data, the mean is <span class="in">`r round(mean(temp$T),1)`</span> °C, the median is <span class="in">`r round(median(temp$T),1)`</span> °C, and the mode is 38.0 °C. The fact that the mode is smaller than the mean is an indication that the data are asymmetric about the mean. We usually refer to such a distribution as being skewed, and in this case the data are skewed to the right.</span>
<span id="cb12-183"><a href="#cb12-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-184"><a href="#cb12-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-185"><a href="#cb12-185" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Quantifying the spread of data: variance and standard deviation</span></span>
<span id="cb12-186"><a href="#cb12-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-187"><a href="#cb12-187" aria-hidden="true" tabindex="-1"></a>The mean of an ensemble of data doesn't provide any information as to how the data are distributed. So any description of a set of data just quoting a mean value is incomplete. We need a second number in order to quantify the dispersion of data around the mean value. The average deviations from the mean, $\left&lt; x-\overline{x} \right&gt;$, is not a useful quantity as, by definition, this will be zero for a symmetrically distributed sample of data (which is always the case for randomly distributed data -- a consequence of the central limit theorem, as we will see later). We should rather consider the average value of the squared deviations from the mean as a measure of the spread of our ensemble of measurements. This is called the **variance** $V(x)$, which is given by:</span>
<span id="cb12-188"><a href="#cb12-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-189"><a href="#cb12-189" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-190"><a href="#cb12-190" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-191"><a href="#cb12-191" aria-hidden="true" tabindex="-1"></a>V(x)&amp;=\left&lt; (x-\overline{x})^2 \right&gt;<span class="sc">\\</span></span>
<span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a>    &amp;=\frac{1}{N}\sum_{i=1}^N(x_i-\overline{x})^2<span class="sc">\\</span></span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>    &amp;=\overline{x^2}-\overline{x}^2</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a>$$ {#eq-variance}</span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a>The square root of the mean-squared (root-mean-squared or RMS) deviation is called the **standard deviation**, and this is given by:</span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>\sigma(x)&amp;=\sqrt{V(x)}<span class="sc">\\</span></span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>         &amp;=\sqrt{\overline{x^2}-\overline{x}^2}</span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>$$ {#eq-sd}</span>
<span id="cb12-205"><a href="#cb12-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-206"><a href="#cb12-206" aria-hidden="true" tabindex="-1"></a>The standard deviation quantifies the amount by which it is reasonable for a measurement of $x$ to differ from the mean value $\overline{x}$. Considering a Gaussian distribution, we would expect to have 31.7% of measurements deviating from the mean value by more than 1$\sigma$, and this goes down to 4.5% of measurements to deviate by more than 2$\sigma$, and 0.3% of measurements to deviate by more than 3$\sigma$. Thus, if we perform a measurement that deviates by a significant margin from the expected value of $\left&lt; x \right&gt;\pm\sigma$, we need to ask ourselves about the significance of our measurement.</span>
<span id="cb12-207"><a href="#cb12-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-208"><a href="#cb12-208" aria-hidden="true" tabindex="-1"></a>In general, scientists often prefer using the standard deviation rather than the variance when describing data, since as the former has the same units as the observable being measured.</span>
<span id="cb12-209"><a href="#cb12-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-210"><a href="#cb12-210" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb12-211"><a href="#cb12-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-212"><a href="#cb12-212" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb12-213"><a href="#cb12-213" aria-hidden="true" tabindex="-1"></a>A measurement of a quantity $x$ is therefore usually presented under the form $\left&lt; x \right&gt;\pm\sigma_x$, where $\left&lt; x \right&gt;$ is the arithmetic average and $\sigma_x$ is the standard deviation of the data.</span>
<span id="cb12-214"><a href="#cb12-214" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-215"><a href="#cb12-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-216"><a href="#cb12-216" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Caveats</span></span>
<span id="cb12-217"><a href="#cb12-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-218"><a href="#cb12-218" aria-hidden="true" tabindex="-1"></a>The above considerations all assume that the distribution of measured values is mono-modal, *i.e.* the histogram of the measured values is centered around a single value. In the case of a multimodal distribution such as shown in @fig-multimodal, it would be meaningless to use such tools as the fine information on the distribution would be lost. </span>
<span id="cb12-219"><a href="#cb12-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-222"><a href="#cb12-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-223"><a href="#cb12-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-multimodal</span></span>
<span id="cb12-224"><a href="#cb12-224" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "A trimodal distribution of measurements. The red line shows the mean value of the distribution: it fails to grasp the reality of the distribution."</span></span>
<span id="cb12-225"><a href="#cb12-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb12-226"><a href="#cb12-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb12-227"><a href="#cb12-227" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-228"><a href="#cb12-228" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">130</span>,.<span class="dv">1</span>), </span>
<span id="cb12-229"><a href="#cb12-229" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">12</span>,<span class="at">sd=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">54</span>,<span class="at">sd=</span><span class="dv">10</span>)<span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">80</span>,<span class="at">sd=</span><span class="dv">12</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-230"><a href="#cb12-230" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">y =</span> y<span class="sc">/</span>(<span class="fu">sum</span>(y)<span class="sc">*</span>.<span class="dv">1</span>))</span>
<span id="cb12-231"><a href="#cb12-231" aria-hidden="true" tabindex="-1"></a>MM <span class="ot">&lt;-</span> <span class="fu">sum</span>(dat<span class="sc">$</span>x<span class="sc">*</span>dat<span class="sc">$</span>y)<span class="sc">*</span>.<span class="dv">1</span></span>
<span id="cb12-232"><a href="#cb12-232" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb12-233"><a href="#cb12-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb12-234"><a href="#cb12-234" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb12-235"><a href="#cb12-235" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MM, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb12-236"><a href="#cb12-236" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x [unit]"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb12-237"><a href="#cb12-237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-238"><a href="#cb12-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-239"><a href="#cb12-239" aria-hidden="true" tabindex="-1"></a>In this case, one should try to deconvolute the distribution in terms of individual peaks, and gather their positions, widths and intensities.</span>
<span id="cb12-240"><a href="#cb12-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-241"><a href="#cb12-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-242"><a href="#cb12-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-243"><a href="#cb12-243" aria-hidden="true" tabindex="-1"></a><span class="fu">## Useful distributions</span></span>
<span id="cb12-244"><a href="#cb12-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-245"><a href="#cb12-245" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability Density Functions</span></span>
<span id="cb12-246"><a href="#cb12-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-247"><a href="#cb12-247" aria-hidden="true" tabindex="-1"></a>We should now introduce the notion of **Probability Density Function** (PDF). </span>
<span id="cb12-248"><a href="#cb12-248" aria-hidden="true" tabindex="-1"></a>*By definition*, a PDF is a distribution where the **total area is unity**. The variation of the PDF is represents the probability of something occurring at that point in the parameter space.</span>
<span id="cb12-249"><a href="#cb12-249" aria-hidden="true" tabindex="-1"></a>In general, a PDF will be described by some function $P(x)$, where</span>
<span id="cb12-250"><a href="#cb12-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-251"><a href="#cb12-251" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-252"><a href="#cb12-252" aria-hidden="true" tabindex="-1"></a>\int_a^b P(x)dx=1,</span>
<span id="cb12-253"><a href="#cb12-253" aria-hidden="true" tabindex="-1"></a>$$ {#eq-PDFnorm}</span>
<span id="cb12-254"><a href="#cb12-254" aria-hidden="true" tabindex="-1"></a>where $a$ and $b$ are the limits of the valid domain for the $P(x)$ function. The probability of obtaining a result between $x$ and $x + dx$ is thus $P(x)dx$. Usual PDFs encountered in physics are the Poisson distribution as well as the Gaussian distribution, that we will describe in a bit.</span>
<span id="cb12-255"><a href="#cb12-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-256"><a href="#cb12-256" aria-hidden="true" tabindex="-1"></a><span class="fu">### PDFs, mean and variance</span></span>
<span id="cb12-257"><a href="#cb12-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-258"><a href="#cb12-258" aria-hidden="true" tabindex="-1"></a>Let us define a PDF $P(x)$ describing a continuous distribution.</span>
<span id="cb12-259"><a href="#cb12-259" aria-hidden="true" tabindex="-1"></a>We can compute the average value of some quantity by computing the integral over this quantity multiplied by the PDF. </span>
<span id="cb12-260"><a href="#cb12-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-261"><a href="#cb12-261" aria-hidden="true" tabindex="-1"></a>For example, the **average value** of the variable $x$, distributed according to the PDF $P(x)$ in the domain $-\infty &lt; x &lt;\infty$, is given by:</span>
<span id="cb12-262"><a href="#cb12-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-263"><a href="#cb12-263" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-264"><a href="#cb12-264" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-265"><a href="#cb12-265" aria-hidden="true" tabindex="-1"></a>\left&lt; x \right&gt;&amp;=\int_{-\infty}^{\infty}xP(x)dx<span class="sc">\\</span></span>
<span id="cb12-266"><a href="#cb12-266" aria-hidden="true" tabindex="-1"></a>\text{or } \left&lt; x \right&gt;&amp;=\sum_{i}x_iP(x_i) \text{ in the case of a discrete distribution}</span>
<span id="cb12-267"><a href="#cb12-267" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-268"><a href="#cb12-268" aria-hidden="true" tabindex="-1"></a>$$ {#eq-firstmoment}</span>
<span id="cb12-269"><a href="#cb12-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-270"><a href="#cb12-270" aria-hidden="true" tabindex="-1"></a>This is called the *first moment* of the PDF.</span>
<span id="cb12-271"><a href="#cb12-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-272"><a href="#cb12-272" aria-hidden="true" tabindex="-1"></a>This method can be used to compute average values of more complicated expressions. The mean value of $(x - \overline{x})^2$, *i.e.* the variance $V$, is thus given by the $\overline{x}$-centered second moment of the PDF, such as:</span>
<span id="cb12-273"><a href="#cb12-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-274"><a href="#cb12-274" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-275"><a href="#cb12-275" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-276"><a href="#cb12-276" aria-hidden="true" tabindex="-1"></a>V&amp;=\int_{-\infty}^{\infty}(x - \overline{x})^2P(x)dx<span class="sc">\\</span></span>
<span id="cb12-277"><a href="#cb12-277" aria-hidden="true" tabindex="-1"></a>\text{or } V&amp;=\sum_{i}(x_i - \overline{x})^2P(x_i) \text{ in the case of a discrete distribution}</span>
<span id="cb12-278"><a href="#cb12-278" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-279"><a href="#cb12-279" aria-hidden="true" tabindex="-1"></a>$$ {#eq-secondmoment}</span>
<span id="cb12-280"><a href="#cb12-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-281"><a href="#cb12-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-282"><a href="#cb12-282" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Poisson distribution</span></span>
<span id="cb12-283"><a href="#cb12-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-284"><a href="#cb12-284" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Definition</span></span>
<span id="cb12-285"><a href="#cb12-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-286"><a href="#cb12-286" aria-hidden="true" tabindex="-1"></a>When a certain reaction happens randomly in time with an average frequency $\lambda$ in a given time interval, then the number $k$ of reactions in that time interval will follow a Poisson distribution:</span>
<span id="cb12-287"><a href="#cb12-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-288"><a href="#cb12-288" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-289"><a href="#cb12-289" aria-hidden="true" tabindex="-1"></a>P_\lambda(k) = \frac{\lambda^ke^{-\lambda}}{k!}</span>
<span id="cb12-290"><a href="#cb12-290" aria-hidden="true" tabindex="-1"></a>$$ {#eq-poisson}</span>
<span id="cb12-291"><a href="#cb12-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-292"><a href="#cb12-292" aria-hidden="true" tabindex="-1"></a>Examples of encounters of Poisson distributions could be as various as the number of calls received per hours in a call center, the yearly number of Prussian soldiers killed by horse kicks... or the number of particles (photons, neutrons, neutrinos...) hitting a detector every second.</span>
<span id="cb12-293"><a href="#cb12-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-294"><a href="#cb12-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-297"><a href="#cb12-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-298"><a href="#cb12-298" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-poissondistrib</span></span>
<span id="cb12-299"><a href="#cb12-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Poisson distribution for various parameters. While asymmetric for small values of $k$ and $\\lambda$, it tends towards a Gaussian lineshape at larger values."</span></span>
<span id="cb12-300"><a href="#cb12-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb12-301"><a href="#cb12-301" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - " "</span></span>
<span id="cb12-302"><a href="#cb12-302" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - " "</span></span>
<span id="cb12-303"><a href="#cb12-303" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - " "</span></span>
<span id="cb12-304"><a href="#cb12-304" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb12-305"><a href="#cb12-305" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb12-306"><a href="#cb12-306" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-307"><a href="#cb12-307" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb12-308"><a href="#cb12-308" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="cf">function</span>(lam, k) {</span>
<span id="cb12-309"><a href="#cb12-309" aria-hidden="true" tabindex="-1"></a>    lam<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam)<span class="sc">/</span><span class="fu">factorial</span>(k)</span>
<span id="cb12-310"><a href="#cb12-310" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-311"><a href="#cb12-311" aria-hidden="true" tabindex="-1"></a>P2 <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, k) {</span>
<span id="cb12-312"><a href="#cb12-312" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">lam =</span> lambda, <span class="at">poisson =</span> lambda<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lam) <span class="sc">/</span> <span class="fu">factorial</span>(k))</span>
<span id="cb12-313"><a href="#cb12-313" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-314"><a href="#cb12-314" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">k=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">4</span>), </span>
<span id="cb12-315"><a href="#cb12-315" aria-hidden="true" tabindex="-1"></a>              <span class="at">lam=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>), <span class="at">each=</span><span class="dv">11</span>),</span>
<span id="cb12-316"><a href="#cb12-316" aria-hidden="true" tabindex="-1"></a>              <span class="at">poisson=</span><span class="fu">P</span>(lam,k))</span>
<span id="cb12-317"><a href="#cb12-317" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">k=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb12-318"><a href="#cb12-318" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">poisson=</span><span class="fu">map</span>(k, <span class="sc">~</span><span class="fu">P2</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,.<span class="dv">1</span>), .))) <span class="sc">%&gt;%</span> </span>
<span id="cb12-319"><a href="#cb12-319" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest</span>(poisson)</span>
<span id="cb12-320"><a href="#cb12-320" aria-hidden="true" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">k =</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-321"><a href="#cb12-321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">poisson =</span> <span class="fu">map</span>(k, <span class="sc">~</span> <span class="fu">P2</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, .<span class="dv">1</span>), .))) <span class="sc">%&gt;%</span></span>
<span id="cb12-322"><a href="#cb12-322" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(poisson)</span>
<span id="cb12-323"><a href="#cb12-323" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb12-324"><a href="#cb12-324" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> poisson, <span class="at">color=</span><span class="fu">factor</span>(lam))) <span class="sc">+</span></span>
<span id="cb12-325"><a href="#cb12-325" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb12-326"><a href="#cb12-326" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">color=</span><span class="fu">expression</span>(lambda), </span>
<span id="cb12-327"><a href="#cb12-327" aria-hidden="true" tabindex="-1"></a>            <span class="at">x=</span><span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"k"</span>)), </span>
<span id="cb12-328"><a href="#cb12-328" aria-hidden="true" tabindex="-1"></a>            <span class="at">y=</span><span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"P"</span>)[lambda]<span class="sc">*</span>(<span class="fu">italic</span>(<span class="st">"k"</span>))))<span class="sc">+</span></span>
<span id="cb12-329"><a href="#cb12-329" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))</span>
<span id="cb12-330"><a href="#cb12-330" aria-hidden="true" tabindex="-1"></a>dat2 <span class="sc">%&gt;%</span> </span>
<span id="cb12-331"><a href="#cb12-331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lam, <span class="at">y =</span> poisson, <span class="at">color=</span><span class="fu">factor</span>(k))) <span class="sc">+</span></span>
<span id="cb12-332"><a href="#cb12-332" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb12-333"><a href="#cb12-333" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">color =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"k"</span>)), </span>
<span id="cb12-334"><a href="#cb12-334" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">expression</span>(lambda), </span>
<span id="cb12-335"><a href="#cb12-335" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"P"</span>)[lambda] <span class="sc">*</span> (<span class="fu">italic</span>(<span class="st">"k"</span>))))<span class="sc">+</span></span>
<span id="cb12-336"><a href="#cb12-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))</span>
<span id="cb12-337"><a href="#cb12-337" aria-hidden="true" tabindex="-1"></a>dat3 <span class="sc">%&gt;%</span> </span>
<span id="cb12-338"><a href="#cb12-338" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lam, <span class="at">y =</span> poisson, <span class="at">color=</span><span class="fu">factor</span>(k))) <span class="sc">+</span></span>
<span id="cb12-339"><a href="#cb12-339" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb12-340"><a href="#cb12-340" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">color =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"k"</span>)), </span>
<span id="cb12-341"><a href="#cb12-341" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">expression</span>(lambda), </span>
<span id="cb12-342"><a href="#cb12-342" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"P"</span>)[lambda] <span class="sc">*</span> (<span class="fu">italic</span>(<span class="st">"k"</span>))))<span class="sc">+</span></span>
<span id="cb12-343"><a href="#cb12-343" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))</span>
<span id="cb12-344"><a href="#cb12-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-345"><a href="#cb12-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-346"><a href="#cb12-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-347"><a href="#cb12-347" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Characteristics</span></span>
<span id="cb12-348"><a href="#cb12-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-349"><a href="#cb12-349" aria-hidden="true" tabindex="-1"></a>As shown on @fig-poissondistrib, for small $\lambda$ the distribution is asymmetric and skewed to the right. As $\lambda$ increases the Poisson distribution becomes more symmetric.</span>
<span id="cb12-350"><a href="#cb12-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-351"><a href="#cb12-351" aria-hidden="true" tabindex="-1"></a>Following @eq-firstmoment, the average number of observed events, $\left&lt; k \right&gt;$, is given by:</span>
<span id="cb12-352"><a href="#cb12-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-353"><a href="#cb12-353" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-354"><a href="#cb12-354" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-355"><a href="#cb12-355" aria-hidden="true" tabindex="-1"></a>\left&lt; k \right&gt; &amp;= \sum_{k=0}^\infty kP_\lambda(k) = \sum_{k=1}^\infty k\frac{\lambda^ke^{-\lambda}}{k!}<span class="sc">\\</span></span>
<span id="cb12-356"><a href="#cb12-356" aria-hidden="true" tabindex="-1"></a>        &amp;= \lambda e^{-\lambda} \sum_{k=1}^\infty \frac{\lambda^{k-1}}{(k-1)!}= \lambda e^{-\lambda} \sum_{k=0}^\infty \frac{\lambda^{k}}{k!}<span class="sc">\\</span></span>
<span id="cb12-357"><a href="#cb12-357" aria-hidden="true" tabindex="-1"></a>        &amp;= \lambda</span>
<span id="cb12-358"><a href="#cb12-358" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-359"><a href="#cb12-359" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-360"><a href="#cb12-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-361"><a href="#cb12-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-362"><a href="#cb12-362" aria-hidden="true" tabindex="-1"></a>In the same manner and by using the "trick" $x^2=x(x-1)+x$, the variance $\sigma^2(k)$ of the distribution is given by:</span>
<span id="cb12-363"><a href="#cb12-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-364"><a href="#cb12-364" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-365"><a href="#cb12-365" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-366"><a href="#cb12-366" aria-hidden="true" tabindex="-1"></a>\sigma^2(k) &amp;= \sum_{k=1}^\infty (k-\lambda)^2\frac{\lambda^k e^{-\lambda}}{k!}<span class="sc">\\</span></span>
<span id="cb12-367"><a href="#cb12-367" aria-hidden="true" tabindex="-1"></a>        &amp;= \lambda e^{-\lambda} \left<span class="co">[</span><span class="ot">\sum_{k=1}^\infty k^2\frac{\lambda^{k-1}}{k!} \underbrace{-2\lambda\sum_{k=1}^\infty \frac{\lambda^{k-1}}{(k-1)!}}_{-2\lambda e^\lambda}+\underbrace{\sum_{k=1}^\infty \lambda^2\frac{\lambda^{k-1}}{k!}}_{\lambda e^\lambda}\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb12-368"><a href="#cb12-368" aria-hidden="true" tabindex="-1"></a>        &amp;= \lambda e^{-\lambda} \left<span class="co">[</span><span class="ot"> \underbrace{\sum_{k=2}^\infty k(k-1)\frac{\lambda^{k-1}}{k!}}_{\lambda e^\lambda} + \underbrace{\sum_{k=1}^\infty k\frac{\lambda^{k-1}}{k!}}_{e^\lambda} - \lambda e^\lambda\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb12-369"><a href="#cb12-369" aria-hidden="true" tabindex="-1"></a>        &amp;=\lambda = \left&lt; k \right&gt;</span>
<span id="cb12-370"><a href="#cb12-370" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-371"><a href="#cb12-371" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-372"><a href="#cb12-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-373"><a href="#cb12-373" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb12-374"><a href="#cb12-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-375"><a href="#cb12-375" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb12-376"><a href="#cb12-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-377"><a href="#cb12-377" aria-hidden="true" tabindex="-1"></a>The important result here is that, **when counting random events with an average of** $\left&lt; N \right&gt;$, **the standard deviation is** $\sigma=\sqrt{\left&lt; N \right&gt;}$. This is typically what happens when performing a diffraction or spectroscopic measurement, such as X-ray diffraction, Raman, IR or neutron spectroscopy, etc.: the longer we acquire data, the higher the number of detected "events" $N$ (particle hits detector), and the "better is the statistics". Indeed, the relative error is thus $\sqrt{N}/N=1/\sqrt{N}$. </span>
<span id="cb12-378"><a href="#cb12-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-379"><a href="#cb12-379" aria-hidden="true" tabindex="-1"></a>The consequence of this is that to make a factor 10 improvement on the relative error, one has to increase by 100 the number of events. This is usually done by increasing the acquisition time, which is fine as long as it is short enough. If irrealistic acquisition times start to become necessary, one should maybe try to find another way to increase $N$: this can be done by improving the detector efficiency, increasing the probe (laser, neutron/x-ray) brightness, changing the experimental geometry, etc.</span>
<span id="cb12-380"><a href="#cb12-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-381"><a href="#cb12-381" aria-hidden="true" tabindex="-1"></a>Finally, for "large" numbers ($\lambda\gtrsim 100$) the Poisson distribution tends towards a symmetric Gaussian distribution that we will describe just after. </span>
<span id="cb12-382"><a href="#cb12-382" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-383"><a href="#cb12-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-384"><a href="#cb12-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-385"><a href="#cb12-385" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Gaussian distribution</span></span>
<span id="cb12-386"><a href="#cb12-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-387"><a href="#cb12-387" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Definition</span></span>
<span id="cb12-388"><a href="#cb12-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-389"><a href="#cb12-389" aria-hidden="true" tabindex="-1"></a>The Gaussian distribution, also known as the *normal distribution*, with a mean value $\mu$ and standard deviation $\sigma$ as a function of some variable $x$ is given by:</span>
<span id="cb12-390"><a href="#cb12-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-391"><a href="#cb12-391" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-392"><a href="#cb12-392" aria-hidden="true" tabindex="-1"></a>P(x, \mu, \sigma)=\frac{1}{\sigma\sqrt{2\pi}}e^{-(x-\mu)^2/2\sigma^2}</span>
<span id="cb12-393"><a href="#cb12-393" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-394"><a href="#cb12-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-395"><a href="#cb12-395" aria-hidden="true" tabindex="-1"></a>It is useful to transform data from the $x$ space to a corresponding $z$ space which has a mean value of zero, and a standard deviation of one. This transformation is given by the mapping $z=\frac{x-\mu}{\sigma}$, and the Gaussian distribution in terms of $z$ is thus:</span>
<span id="cb12-396"><a href="#cb12-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-397"><a href="#cb12-397" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-398"><a href="#cb12-398" aria-hidden="true" tabindex="-1"></a>P(z)=\frac{1}{\sqrt{2\pi}}e^{-z^2/2}</span>
<span id="cb12-399"><a href="#cb12-399" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-400"><a href="#cb12-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-401"><a href="#cb12-401" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Characteristics</span></span>
<span id="cb12-402"><a href="#cb12-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-405"><a href="#cb12-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-406"><a href="#cb12-406" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gaussian</span></span>
<span id="cb12-407"><a href="#cb12-407" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "A zero-centered Gaussian distribution with standard deviation of 1, $P(z)$. The red line marks the half maximum, $P(z_{HM})=1/2\\sqrt{2\\pi}$, and the blue lines the values of $z$ for which the half maximum is obtained, $z_{HM}=\\pm\\sqrt{2\\ln{2}}$."</span></span>
<span id="cb12-408"><a href="#cb12-408" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb12-409"><a href="#cb12-409" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb12-410"><a href="#cb12-410" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-411"><a href="#cb12-411" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,.<span class="dv">1</span>), <span class="at">y=</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))</span>
<span id="cb12-412"><a href="#cb12-412" aria-hidden="true" tabindex="-1"></a>seg1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)),<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>))),</span>
<span id="cb12-413"><a href="#cb12-413" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)))</span>
<span id="cb12-414"><a href="#cb12-414" aria-hidden="true" tabindex="-1"></a>seg2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="sc">-</span><span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)),<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>))),</span>
<span id="cb12-415"><a href="#cb12-415" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)))</span>
<span id="cb12-416"><a href="#cb12-416" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb12-417"><a href="#cb12-417" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb12-418"><a href="#cb12-418" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb12-419"><a href="#cb12-419" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"z"</span>, <span class="at">y=</span><span class="st">"P(z)"</span>)<span class="sc">+</span></span>
<span id="cb12-420"><a href="#cb12-420" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi), <span class="at">col=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb12-421"><a href="#cb12-421" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">data=</span>seg2, <span class="at">col=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb12-422"><a href="#cb12-422" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">data=</span>seg1, <span class="at">col=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb12-423"><a href="#cb12-423" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)), <span class="at">y =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb12-424"><a href="#cb12-424" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xend =</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)), <span class="at">yend =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb12-425"><a href="#cb12-425" aria-hidden="true" tabindex="-1"></a>            <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb12-426"><a href="#cb12-426" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">12</span>, <span class="at">label=</span><span class="st">"FWHM"</span>)</span>
<span id="cb12-427"><a href="#cb12-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-428"><a href="#cb12-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-429"><a href="#cb12-429" aria-hidden="true" tabindex="-1"></a>Sometimes instead of quantifying a Gaussian distribution (or any monomodal distribution, for that matter) using the variance or standard deviation, scientists will speak about the full width at half maximum (**FWHM**). </span>
<span id="cb12-430"><a href="#cb12-430" aria-hidden="true" tabindex="-1"></a>This has the advantage that any extreme outliers of the distribution do not contribute to the quantification of the spread of data. As the name suggests, the FWHM is the width of the distribution (the spread above and below the mean) at the points where the distribution reaches half of its maximum. </span>
<span id="cb12-431"><a href="#cb12-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-432"><a href="#cb12-432" aria-hidden="true" tabindex="-1"></a>For a Gaussian distribution $P(z)$, the half maximum is attained when $z_{HM}$ is so that:</span>
<span id="cb12-433"><a href="#cb12-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-434"><a href="#cb12-434" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-435"><a href="#cb12-435" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-436"><a href="#cb12-436" aria-hidden="true" tabindex="-1"></a>\frac{1}{\sqrt{2\pi}}e^{-z_{HM}^2/2}&amp;= \frac{1}{2}\frac{1}{\sqrt{2\pi}}<span class="sc">\\</span></span>
<span id="cb12-437"><a href="#cb12-437" aria-hidden="true" tabindex="-1"></a>\Rightarrow z_{HM}&amp;=\pm\sqrt{2\ln{2}}</span>
<span id="cb12-438"><a href="#cb12-438" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-439"><a href="#cb12-439" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-440"><a href="#cb12-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-441"><a href="#cb12-441" aria-hidden="true" tabindex="-1"></a>The FWHM of $P(z)$ is therefore $FWHM=2\sqrt{2\ln{2}}\simeq2.355$. Using the relation between $z$ and $\sigma$, we get the relation between the FWHM and the standard deviation:</span>
<span id="cb12-442"><a href="#cb12-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-443"><a href="#cb12-443" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-444"><a href="#cb12-444" aria-hidden="true" tabindex="-1"></a>FWHM=2\sqrt{2\ln{2}}\times\sigma</span>
<span id="cb12-445"><a href="#cb12-445" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-446"><a href="#cb12-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-447"><a href="#cb12-447" aria-hidden="true" tabindex="-1"></a>As can be seen on @tbl-tablevalues, using the FWHM ensures that roughly 76% of the data are comprised between $\mu-\sigma$ and $\mu+\sigma$, and this goes up to $\sim95$% for $\mu-2\sigma$ and $\mu+2\sigma$.</span>
<span id="cb12-448"><a href="#cb12-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-449"><a href="#cb12-449" aria-hidden="true" tabindex="-1"></a>|Integration range $a$  |$\int_{-a}^aP(z)dz$ |</span>
<span id="cb12-450"><a href="#cb12-450" aria-hidden="true" tabindex="-1"></a>|:----------------------|:-------------------|</span>
<span id="cb12-451"><a href="#cb12-451" aria-hidden="true" tabindex="-1"></a>|$\sigma$               |0.68293             |</span>
<span id="cb12-452"><a href="#cb12-452" aria-hidden="true" tabindex="-1"></a>|$\sqrt{2\ln{2}}\sigma$ |0.76100             |</span>
<span id="cb12-453"><a href="#cb12-453" aria-hidden="true" tabindex="-1"></a>|$2\sigma$              |0.95455             |</span>
<span id="cb12-454"><a href="#cb12-454" aria-hidden="true" tabindex="-1"></a>|$3\sigma$              |0.99730             |</span>
<span id="cb12-455"><a href="#cb12-455" aria-hidden="true" tabindex="-1"></a>|$4\sigma$              |0.99994             |</span>
<span id="cb12-456"><a href="#cb12-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-457"><a href="#cb12-457" aria-hidden="true" tabindex="-1"></a>: Integral values for various values of $a$ in $\int_{-a}^aP(z)dz$. {#tbl-tablevalues}</span>
<span id="cb12-458"><a href="#cb12-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-459"><a href="#cb12-459" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span></span>
<span id="cb12-460"><a href="#cb12-460" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tablevalues</span></span>
<span id="cb12-461"><a href="#cb12-461" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Integral values for various values of $a$ in $\\int_{-a}^aP(z)dz$."</span></span>
<span id="cb12-462"><a href="#cb12-462" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb12-463"><a href="#cb12-463" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb12-464"><a href="#cb12-464" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-465"><a href="#cb12-465" aria-hidden="true" tabindex="-1"></a><span class="co">x &lt;- seq(-10,10,.001)</span></span>
<span id="cb12-466"><a href="#cb12-466" aria-hidden="true" tabindex="-1"></a><span class="co">y &lt;- dnorm(x,0,1)</span></span>
<span id="cb12-467"><a href="#cb12-467" aria-hidden="true" tabindex="-1"></a><span class="co">integral &lt;- function(x,a=1) {</span></span>
<span id="cb12-468"><a href="#cb12-468" aria-hidden="true" tabindex="-1"></a><span class="co">    sprintf("%.5f", sum(y[abs(x) &lt;= a] * (x[2] - x[1])))</span></span>
<span id="cb12-469"><a href="#cb12-469" aria-hidden="true" tabindex="-1"></a><span class="co">}</span></span>
<span id="cb12-470"><a href="#cb12-470" aria-hidden="true" tabindex="-1"></a><span class="co">dat &lt;- tibble(`Integration range $a$` = c("$\\sigma$", "$\\sqrt{2\\ln{2}}\\sigma$", "$2\\sigma$", "$3\\sigma$", "$4\\sigma$"),</span></span>
<span id="cb12-471"><a href="#cb12-471" aria-hidden="true" tabindex="-1"></a><span class="co">       `$\\int_{-a}^aP(z)dz$` = c(integral(x, a = 1), integral(x, a = sqrt(2 * log(2))), integral(x, a = 2), integral(x, a = 3), integral(x, a = 4))</span></span>
<span id="cb12-472"><a href="#cb12-472" aria-hidden="true" tabindex="-1"></a><span class="co">      )</span></span>
<span id="cb12-473"><a href="#cb12-473" aria-hidden="true" tabindex="-1"></a><span class="co">knitr::kable(dat)</span></span>
<span id="cb12-474"><a href="#cb12-474" aria-hidden="true" tabindex="-1"></a><span class="co">--&gt;</span></span>
<span id="cb12-475"><a href="#cb12-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-476"><a href="#cb12-476" aria-hidden="true" tabindex="-1"></a><span class="fu">## Usual statistical tests on distributions</span></span>
<span id="cb12-477"><a href="#cb12-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-478"><a href="#cb12-478" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hypothesis testing and p-values</span></span>
<span id="cb12-479"><a href="#cb12-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-480"><a href="#cb12-480" aria-hidden="true" tabindex="-1"></a>A **hypothesis test** is a statistical test that is used to determine whether a given hypothesis is true or not.</span>
<span id="cb12-481"><a href="#cb12-481" aria-hidden="true" tabindex="-1"></a>It is based on the comparison of the observed data with the expected data, given the hypothesis.</span>
<span id="cb12-482"><a href="#cb12-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-483"><a href="#cb12-483" aria-hidden="true" tabindex="-1"></a>The **null hypothesis** (usually noted $H_0$) is the hypothesis that is tested, and the **alternative hypothesis** (usually noted $H_1$) is the hypothesis that is assumed to be true if the null hypothesis is rejected.</span>
<span id="cb12-484"><a href="#cb12-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-485"><a href="#cb12-485" aria-hidden="true" tabindex="-1"></a>The **p-value** is the probability of obtaining a fluctuation in data under the null hypothesis that is as, or more, extreme than that observed by a given experiment. </span>
<span id="cb12-486"><a href="#cb12-486" aria-hidden="true" tabindex="-1"></a>If the p-value is smaller than a predifined tolerance (usually set to 0.05), then one might consider rejecting the null hypothesis as the probability of observing such a fluctuation under the null hypothesis is extremely small.</span>
<span id="cb12-487"><a href="#cb12-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-488"><a href="#cb12-488" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb12-489"><a href="#cb12-489" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $\ge\alpha$ (typically 0.05), the null hypothesis is accepted.</span>
<span id="cb12-490"><a href="#cb12-490" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** is below a certain threshold $\alpha$, the null hypothesis is rejected.</span>
<span id="cb12-491"><a href="#cb12-491" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-492"><a href="#cb12-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-493"><a href="#cb12-493" aria-hidden="true" tabindex="-1"></a>In R, most tests will automatically return a p-value, which will help you decide whether the test is conclusive or not – we will not delve into the details of computing these p-values.</span>
<span id="cb12-494"><a href="#cb12-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-495"><a href="#cb12-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-496"><a href="#cb12-496" aria-hidden="true" tabindex="-1"></a><span class="fu">### Asserting the Gaussian nature of a distribution: the Shapiro–Wilk test</span></span>
<span id="cb12-497"><a href="#cb12-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-498"><a href="#cb12-498" aria-hidden="true" tabindex="-1"></a>The Shapiro-Wilk test is a statistical test that can be used to determine whether a distribution of data is Gaussian or not. </span>
<span id="cb12-499"><a href="#cb12-499" aria-hidden="true" tabindex="-1"></a>It is based on the comparison of the observed distribution with the expected distribution of a Gaussian distribution with the same mean and standard deviation.</span>
<span id="cb12-500"><a href="#cb12-500" aria-hidden="true" tabindex="-1"></a>Its **null hypothesis** is that the data are normally distributed, thus:</span>
<span id="cb12-501"><a href="#cb12-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-502"><a href="#cb12-502" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $\lt\alpha$, the null hypothesis is rejected and the data are not normally distributed.</span>
<span id="cb12-503"><a href="#cb12-503" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $\ge\alpha$, the null hypothesis is not rejected and the data are normally distributed.</span>
<span id="cb12-504"><a href="#cb12-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-505"><a href="#cb12-505" aria-hidden="true" tabindex="-1"></a>Let's perform a Shapiro-Wilk test on the distribution of the data in @fig-histogramT:</span>
<span id="cb12-506"><a href="#cb12-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-509"><a href="#cb12-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-510"><a href="#cb12-510" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb12-511"><a href="#cb12-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb12-512"><a href="#cb12-512" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb12-513"><a href="#cb12-513" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="fl">38.1</span>, <span class="fl">38.0</span>, <span class="fl">38.0</span>, <span class="fl">38.3</span>, <span class="fl">37.9</span>, <span class="fl">38.1</span>, <span class="fl">38.2</span>, <span class="fl">39.8</span>)</span>
<span id="cb12-514"><a href="#cb12-514" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(temp)</span>
<span id="cb12-515"><a href="#cb12-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-516"><a href="#cb12-516" aria-hidden="true" tabindex="-1"></a>We see here that the p-value is <span class="in">`r sprintf("%.3g",shapiro.test(temp)$p.value)`</span>, which is below the threshold $\alpha$ = 0.05. </span>
<span id="cb12-517"><a href="#cb12-517" aria-hidden="true" tabindex="-1"></a>This means that **it is extremely unlikely that you'd observe such measurements if their distribution were normal**.</span>
<span id="cb12-518"><a href="#cb12-518" aria-hidden="true" tabindex="-1"></a>The null hypothesis that the data are normally distributed is thus rejected, and we can conclude that the data are not normally distributed -- as expected from their representation in @fig-histogramT.</span>
<span id="cb12-519"><a href="#cb12-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-520"><a href="#cb12-520" aria-hidden="true" tabindex="-1"></a>If we were to remove the outlier (39.8) and perform the test again, we would get a p-value of <span class="in">`r sprintf("%.3g",shapiro.test(temp[temp!=39.8])$p.value)`</span>, which means that there is a <span class="in">`r round(100*shapiro.test(temp[temp!=39.8])$p.value,1)`</span>% chance to observe such measurements if their distribution were normal. As p-value &gt; 0.05, the null hypothesis that the data are normally distributed is not rejected, and we can conclude that the data are normally distributed.</span>
<span id="cb12-521"><a href="#cb12-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-522"><a href="#cb12-522" aria-hidden="true" tabindex="-1"></a><span class="fu">### Student's t-test </span></span>
<span id="cb12-523"><a href="#cb12-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-524"><a href="#cb12-524" aria-hidden="true" tabindex="-1"></a>The Student's t-test is a statistical test that can be used to determine whether two sets of data are significantly different from each other.</span>
<span id="cb12-525"><a href="#cb12-525" aria-hidden="true" tabindex="-1"></a>Its **null hypothesis** is that **the two sets of data are drawn from the same distribution**, thus:</span>
<span id="cb12-526"><a href="#cb12-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-527"><a href="#cb12-527" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $\lt\alpha$, the null hypothesis is rejected and the data are not drawn from the same distribution.</span>
<span id="cb12-528"><a href="#cb12-528" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $\ge\alpha$, the null hypothesis is not rejected and the data are drawn from the same distribution.</span>
<span id="cb12-529"><a href="#cb12-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-530"><a href="#cb12-530" aria-hidden="true" tabindex="-1"></a>Let's work on two sets of temperature measurements performed on two different days on two different person. We want to assert whether the temperature evolution between the two days is significant or not for each patient. For the sake of example, let's say that in both cases, they present the same average temperature on day 1 and on day 2 but with a different spread in data.</span>
<span id="cb12-531"><a href="#cb12-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-534"><a href="#cb12-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-535"><a href="#cb12-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-536"><a href="#cb12-536" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb12-537"><a href="#cb12-537" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-538"><a href="#cb12-538" aria-hidden="true" tabindex="-1"></a>temps1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Day1=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="fl">38.5</span>, .<span class="dv">2</span>),</span>
<span id="cb12-539"><a href="#cb12-539" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Day2=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="fl">37.7</span>, .<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-540"><a href="#cb12-540" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), </span>
<span id="cb12-541"><a href="#cb12-541" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to =</span> <span class="st">"Day"</span>, </span>
<span id="cb12-542"><a href="#cb12-542" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to =</span>  <span class="st">"Temperature"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-543"><a href="#cb12-543" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">Patient=</span><span class="st">"A"</span>)</span>
<span id="cb12-544"><a href="#cb12-544" aria-hidden="true" tabindex="-1"></a>temps2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Day1=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="fl">38.5</span>, <span class="dv">3</span>),</span>
<span id="cb12-545"><a href="#cb12-545" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Day2=</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="fl">37.7</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-546"><a href="#cb12-546" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), </span>
<span id="cb12-547"><a href="#cb12-547" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to =</span> <span class="st">"Day"</span>, </span>
<span id="cb12-548"><a href="#cb12-548" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to =</span> <span class="st">"Temperature"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb12-549"><a href="#cb12-549" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">Patient=</span><span class="st">"B"</span>)</span>
<span id="cb12-550"><a href="#cb12-550" aria-hidden="true" tabindex="-1"></a>temperatures <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(temps1, temps2)</span>
<span id="cb12-551"><a href="#cb12-551" aria-hidden="true" tabindex="-1"></a>temperatures <span class="sc">%&gt;%</span> </span>
<span id="cb12-552"><a href="#cb12-552" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Temperature, <span class="at">color =</span> Patient)) <span class="sc">+</span></span>
<span id="cb12-553"><a href="#cb12-553" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">04</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb12-554"><a href="#cb12-554" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">notch=</span><span class="cn">TRUE</span>, <span class="at">position =</span> <span class="st">"identity"</span>, </span>
<span id="cb12-555"><a href="#cb12-555" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">width=</span>.<span class="dv">2</span>, </span>
<span id="cb12-556"><a href="#cb12-556" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb12-557"><a href="#cb12-557" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="st">"identity"</span>, </span>
<span id="cb12-558"><a href="#cb12-558" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb12-559"><a href="#cb12-559" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"royalblue"</span>))<span class="sc">+</span></span>
<span id="cb12-560"><a href="#cb12-560" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"royalblue"</span>))<span class="sc">+</span></span>
<span id="cb12-561"><a href="#cb12-561" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">geom =</span> <span class="st">"point"</span>)<span class="sc">+</span></span>
<span id="cb12-562"><a href="#cb12-562" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x     =</span> <span class="st">"Day"</span>,</span>
<span id="cb12-563"><a href="#cb12-563" aria-hidden="true" tabindex="-1"></a>             <span class="at">y     =</span> <span class="st">"Temperature [˚C]"</span>)</span>
<span id="cb12-564"><a href="#cb12-564" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-565"><a href="#cb12-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-568"><a href="#cb12-568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-569"><a href="#cb12-569" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb12-570"><a href="#cb12-570" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb12-571"><a href="#cb12-571" aria-hidden="true" tabindex="-1"></a>TA <span class="ot">&lt;-</span> <span class="fu">t.test</span>(temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"A"</span>, Day<span class="sc">==</span><span class="st">"Day1"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature), </span>
<span id="cb12-572"><a href="#cb12-572" aria-hidden="true" tabindex="-1"></a>       temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"A"</span>, Day<span class="sc">==</span><span class="st">"Day2"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature))</span>
<span id="cb12-573"><a href="#cb12-573" aria-hidden="true" tabindex="-1"></a>TB <span class="ot">&lt;-</span> <span class="fu">t.test</span>(temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"B"</span>, Day<span class="sc">==</span><span class="st">"Day1"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature), </span>
<span id="cb12-574"><a href="#cb12-574" aria-hidden="true" tabindex="-1"></a>       temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"B"</span>, Day<span class="sc">==</span><span class="st">"Day2"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature))</span>
<span id="cb12-575"><a href="#cb12-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-576"><a href="#cb12-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-577"><a href="#cb12-577" aria-hidden="true" tabindex="-1"></a>Data means and 95% confidence intervals:</span>
<span id="cb12-580"><a href="#cb12-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-581"><a href="#cb12-581" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-582"><a href="#cb12-582" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb12-583"><a href="#cb12-583" aria-hidden="true" tabindex="-1"></a>temperatures <span class="sc">%&gt;%</span> </span>
<span id="cb12-584"><a href="#cb12-584" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>(<span class="at">data=</span>Temperature) <span class="sc">%&gt;%</span></span>
<span id="cb12-585"><a href="#cb12-585" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">CI =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">as_tibble</span>(<span class="fu">as.list</span>(Rmisc<span class="sc">::</span><span class="fu">CI</span>(.<span class="sc">$</span>Temperature,<span class="at">ci=</span>.<span class="dv">95</span>))))) <span class="sc">%&gt;%</span> </span>
<span id="cb12-586"><a href="#cb12-586" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(CI) </span>
<span id="cb12-587"><a href="#cb12-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-588"><a href="#cb12-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-589"><a href="#cb12-589" aria-hidden="true" tabindex="-1"></a>We want to determine whether the temperature evolution between the two days is significant or not for each patient.</span>
<span id="cb12-590"><a href="#cb12-590" aria-hidden="true" tabindex="-1"></a>We can perform a Student's t-test to assert whether the two sets of data are significantly different from each other. </span>
<span id="cb12-591"><a href="#cb12-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-592"><a href="#cb12-592" aria-hidden="true" tabindex="-1"></a>First, **to apply a t-test, we need to make sure that the data are normally distributed**, which we can do by performing a Shapiro-Wilk test on each set of data:</span>
<span id="cb12-595"><a href="#cb12-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-596"><a href="#cb12-596" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb12-597"><a href="#cb12-597" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb12-598"><a href="#cb12-598" aria-hidden="true" tabindex="-1"></a>temperatures <span class="sc">%&gt;%</span> </span>
<span id="cb12-599"><a href="#cb12-599" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>(<span class="at">data =</span> Temperature) <span class="sc">%&gt;%</span> </span>
<span id="cb12-600"><a href="#cb12-600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">shapiro =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">as_tibble</span>(</span>
<span id="cb12-601"><a href="#cb12-601" aria-hidden="true" tabindex="-1"></a>        <span class="fu">shapiro.test</span>(.<span class="sc">$</span>Temperature)[<span class="fu">c</span>(<span class="st">'statistic'</span>,<span class="st">'p.value'</span>)]))) <span class="sc">%&gt;%</span> </span>
<span id="cb12-602"><a href="#cb12-602" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(shapiro)</span>
<span id="cb12-603"><a href="#cb12-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-604"><a href="#cb12-604" aria-hidden="true" tabindex="-1"></a>In all cases the p-value is above 0.05, which means that the null hypothesis that the data are normally distributed is not rejected, and **we can conclude that the data are normally distributed**. The application of the t-test is thus valid.</span>
<span id="cb12-605"><a href="#cb12-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-606"><a href="#cb12-606" aria-hidden="true" tabindex="-1"></a>Let's start now with patient A:</span>
<span id="cb12-609"><a href="#cb12-609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-610"><a href="#cb12-610" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"A"</span>, Day<span class="sc">==</span><span class="st">"Day1"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature), </span>
<span id="cb12-611"><a href="#cb12-611" aria-hidden="true" tabindex="-1"></a>       temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"A"</span>, Day<span class="sc">==</span><span class="st">"Day2"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature))</span>
<span id="cb12-612"><a href="#cb12-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-613"><a href="#cb12-613" aria-hidden="true" tabindex="-1"></a>As could be intuited by the graphical representation, the t-test on patient A shows that their temperature decreased significantly between day 1 and day 2, with a p-value of <span class="in">`r sprintf("%.3g",TA$p.value)`</span>, which is largely below the threshold $\alpha$ = 0.05.</span>
<span id="cb12-614"><a href="#cb12-614" aria-hidden="true" tabindex="-1"></a>To report it properly, we can say that "the temperature of patient A on day 1 (<span class="in">`r round(TA$estimate[1],2)`</span>˚C, 95% CI = <span class="co">[</span><span class="ot">`r sort(round(Rmisc::CI(temperatures %&gt;% filter(Patient == "A", Day=="Day1") %&gt;% pull(Temperature))[c(1,3)],2))`</span><span class="co">]</span>˚C), was statistically significantly higher than on day 2 (<span class="in">`r round(TA$estimate[2],2)`</span>˚C, 95% CI = <span class="co">[</span><span class="ot">`r sort(round(Rmisc::CI(temperatures %&gt;% filter(Patient == "A", Day=="Day2") %&gt;% pull(Temperature))[c(1,3)],2))`</span><span class="co">]</span>˚C), t(<span class="in">`r round(TA$parameter,2)`</span>) = <span class="in">`r round(TA$statistic,2)`</span>, p = <span class="in">`r sprintf("%.3g",TA$p.value)`</span>."</span>
<span id="cb12-615"><a href="#cb12-615" aria-hidden="true" tabindex="-1"></a>Here , <span class="in">`r round(TA$parameter,2)`</span> is the degrees of freedom associated with the t test-statistic.</span>
<span id="cb12-616"><a href="#cb12-616" aria-hidden="true" tabindex="-1"></a>The 95% confidence interval for the difference between the means is <span class="in">`r round(TA$conf.int[1],2)`</span>˚C to <span class="in">`r round(TA$conf.int[2],2)`</span>˚C.</span>
<span id="cb12-617"><a href="#cb12-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-618"><a href="#cb12-618" aria-hidden="true" tabindex="-1"></a>For patient B however, even though the average temperature decreased between the two days, the spread in data is so large that the t-test does not allow concluding concerning any significant temperature difference between the two days:</span>
<span id="cb12-621"><a href="#cb12-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb12-622"><a href="#cb12-622" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"B"</span>, Day<span class="sc">==</span><span class="st">"Day1"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature), </span>
<span id="cb12-623"><a href="#cb12-623" aria-hidden="true" tabindex="-1"></a>       temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"B"</span>, Day<span class="sc">==</span><span class="st">"Day2"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature))</span>
<span id="cb12-624"><a href="#cb12-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb12-625"><a href="#cb12-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-626"><a href="#cb12-626" aria-hidden="true" tabindex="-1"></a><span class="fu">## Uncertainty and errors</span></span>
<span id="cb12-627"><a href="#cb12-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-628"><a href="#cb12-628" aria-hidden="true" tabindex="-1"></a><span class="fu">### Central limit theorem: on the Gaussian nature of statistical uncertainty</span></span>
<span id="cb12-629"><a href="#cb12-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-630"><a href="#cb12-630" aria-hidden="true" tabindex="-1"></a>The **central limit theorem** states that if one takes $N$ random independent samples of a distribution of data that describes some variable $x$, then as $N$ tends to infinity, the distribution of the sum of the samples tends to a Gaussian distribution. </span>
<span id="cb12-631"><a href="#cb12-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-632"><a href="#cb12-632" aria-hidden="true" tabindex="-1"></a>In other terms: the mean value of a large number $N$ of independent random variables (that can be distributed following any distribution with finite variance), obeying the same distribution with variance $\sigma_0^2$, approaches a normal distribution with variance $\sigma^2 = \sigma _0^2/N$.</span>
<span id="cb12-633"><a href="#cb12-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-634"><a href="#cb12-634" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb12-635"><a href="#cb12-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-636"><a href="#cb12-636" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb12-637"><a href="#cb12-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-638"><a href="#cb12-638" aria-hidden="true" tabindex="-1"></a>**This result is fundamental** as it implies that **independent measurements of any observable will show values that will be spread following a Gaussian distribution**, and thus statistical uncertainties that are Gaussian in nature.</span>
<span id="cb12-639"><a href="#cb12-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-640"><a href="#cb12-640" aria-hidden="true" tabindex="-1"></a>Moreover, we see here the typical property of statistical errors, which is that **the relative error is proportional to** $1/\sqrt{N}$. Increasing the number of observations thus decreases the error, *i.e.* increases the precision.</span>
<span id="cb12-641"><a href="#cb12-641" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-642"><a href="#cb12-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-643"><a href="#cb12-643" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combination of errors</span></span>
<span id="cb12-644"><a href="#cb12-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-645"><a href="#cb12-645" aria-hidden="true" tabindex="-1"></a>Let us consider a function of $n$ variables, $f(u_1, u_2, ..., u_n)$. We can Taylor expand this function about the various mean values $u_i=\overline{u_i}$, so that, at the first order:</span>
<span id="cb12-646"><a href="#cb12-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-647"><a href="#cb12-647" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-648"><a href="#cb12-648" aria-hidden="true" tabindex="-1"></a>f(u_1, ..., u_n) = f(\overline{u_1}, ..., \overline{u_n}) + \sum_{i=1}^n (u_i-\overline{u_i})\frac{\partial f}{\partial u_i}</span>
<span id="cb12-649"><a href="#cb12-649" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-650"><a href="#cb12-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-651"><a href="#cb12-651" aria-hidden="true" tabindex="-1"></a>Considering that the variance of a quantity $f$ is given by $\sigma^2(f) = (f - \overline{f} )^2$, it follows that the variance of our multivariable function is given by:</span>
<span id="cb12-652"><a href="#cb12-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-653"><a href="#cb12-653" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-654"><a href="#cb12-654" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-655"><a href="#cb12-655" aria-hidden="true" tabindex="-1"></a>\sigma^2(f) &amp;= \left(\sum_{i=1}^n (u_i-\overline{u_i})\frac{\partial f}{\partial u_i}\right)^2<span class="sc">\\</span></span>
<span id="cb12-656"><a href="#cb12-656" aria-hidden="true" tabindex="-1"></a>         &amp;= \sum_{i=1}^n \left(\frac{\partial f}{\partial u_i}\right)^2\sigma_{u_i}^2 + 2\sum_{i\ne j}\frac{\partial f}{\partial u_i}\frac{\partial f}{\partial u_j}\sigma_{u_iu_j}<span class="sc">\\</span></span>
<span id="cb12-657"><a href="#cb12-657" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-658"><a href="#cb12-658" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-659"><a href="#cb12-659" aria-hidden="true" tabindex="-1"></a>where we have replaced $(u_i-\overline{u_i})^2$ by the variance $\sigma_{u_i}^2$ and $(u_i-\overline{u_i})(u_j-\overline{u_j})$ by the covariance $\sigma_{u_iu_j}$.</span>
<span id="cb12-660"><a href="#cb12-660" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb12-661"><a href="#cb12-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-662"><a href="#cb12-662" aria-hidden="true" tabindex="-1"></a>If the variables $u_i$ are independent then the covariance $\sigma_{u_iu_j}$ is null, and it follows the general expression of the standard error that can be applied to **any function of independent variables**:</span>
<span id="cb12-663"><a href="#cb12-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-664"><a href="#cb12-664" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="minimal"}</span>
<span id="cb12-665"><a href="#cb12-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-666"><a href="#cb12-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-667"><a href="#cb12-667" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-668"><a href="#cb12-668" aria-hidden="true" tabindex="-1"></a>\sigma(f) = \sqrt{\sum_{i=1}^n \left(\frac{\partial f}{\partial u_i}\right)^2\sigma_{u_i}^2}</span>
<span id="cb12-669"><a href="#cb12-669" aria-hidden="true" tabindex="-1"></a>$$ {#eq-uncertainty}</span>
<span id="cb12-670"><a href="#cb12-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-671"><a href="#cb12-671" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-672"><a href="#cb12-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-673"><a href="#cb12-673" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Functions of one variable</span></span>
<span id="cb12-674"><a href="#cb12-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-675"><a href="#cb12-675" aria-hidden="true" tabindex="-1"></a>Let us consider a function $f$ having a form that depends only on one observable $x$, for example:</span>
<span id="cb12-676"><a href="#cb12-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-677"><a href="#cb12-677" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-678"><a href="#cb12-678" aria-hidden="true" tabindex="-1"></a>f = Ax + B</span>
<span id="cb12-679"><a href="#cb12-679" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-680"><a href="#cb12-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-681"><a href="#cb12-681" aria-hidden="true" tabindex="-1"></a>Then, following @eq-uncertainty, the standard error on that function is given by:</span>
<span id="cb12-682"><a href="#cb12-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-683"><a href="#cb12-683" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-684"><a href="#cb12-684" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-685"><a href="#cb12-685" aria-hidden="true" tabindex="-1"></a>\sigma_f &amp;= \sqrt{\left(\frac{\partial f}{\partial x}\right)^2\sigma_x^2}<span class="sc">\\</span></span>
<span id="cb12-686"><a href="#cb12-686" aria-hidden="true" tabindex="-1"></a>         &amp;= A\sigma_x</span>
<span id="cb12-687"><a href="#cb12-687" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-688"><a href="#cb12-688" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-689"><a href="#cb12-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-690"><a href="#cb12-690" aria-hidden="true" tabindex="-1"></a>So, **independently of any offset of the measured observable**, the resulting error must be corrected by the same factor as the intensity.</span>
<span id="cb12-691"><a href="#cb12-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-692"><a href="#cb12-692" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb12-693"><a href="#cb12-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-694"><a href="#cb12-694" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb12-695"><a href="#cb12-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-696"><a href="#cb12-696" aria-hidden="true" tabindex="-1"></a>**In practice**, let's say we measure a Raman spectrum. As we saw above, the error on each intensity count is given by the square root of this intensity count. </span>
<span id="cb12-697"><a href="#cb12-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-698"><a href="#cb12-698" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It is possible to shift vertically this spectrum without having to recompute the error bars.</span>
<span id="cb12-699"><a href="#cb12-699" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>But if you want to normalize (say, to 1) this spectrum, you have to multiply all the errors by the renormalization constant.</span>
<span id="cb12-700"><a href="#cb12-700" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-701"><a href="#cb12-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-702"><a href="#cb12-702" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Functions of two variables</span></span>
<span id="cb12-703"><a href="#cb12-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-704"><a href="#cb12-704" aria-hidden="true" tabindex="-1"></a>Now consider the function $f = Ax + By$, where we have measured the mean and standard deviation of both $x$ and $y$, and want to compute the standard deviation on their sum/subtraction. We can use the general formula of @eq-uncertainty to determine how to do this, hence:</span>
<span id="cb12-705"><a href="#cb12-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-706"><a href="#cb12-706" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-707"><a href="#cb12-707" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb12-708"><a href="#cb12-708" aria-hidden="true" tabindex="-1"></a>\sigma_f &amp;= \sqrt{\left(\frac{\partial f}{\partial x}\right)^2\sigma_x^2 + \left(\frac{\partial f}{\partial y}\right)^2\sigma_y^2}<span class="sc">\\</span></span>
<span id="cb12-709"><a href="#cb12-709" aria-hidden="true" tabindex="-1"></a>         &amp;= \sqrt{A^2\sigma_x^2 + B^2\sigma_y^2}</span>
<span id="cb12-710"><a href="#cb12-710" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb12-711"><a href="#cb12-711" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb12-712"><a href="#cb12-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-713"><a href="#cb12-713" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb12-714"><a href="#cb12-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-715"><a href="#cb12-715" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb12-716"><a href="#cb12-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-717"><a href="#cb12-717" aria-hidden="true" tabindex="-1"></a>**In practice**, let's say we measure an UV spectrum of a solution (a molecule in a solvent), and a reference spectrum of this solvent. As we saw above, the error on each intensity count is given by the square root of this intensity count. We want to subtract the signal of the solvent to get only the signal of the molecule.</span>
<span id="cb12-718"><a href="#cb12-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-719"><a href="#cb12-719" aria-hidden="true" tabindex="-1"></a>We thus have to perform the above operation on the errors, $\sigma_{result}=\sqrt{\sigma^2_{solution}+\sigma^2_{reference}}$. It means that in order to have a statistically sound resulting spectrum, the reference needs to be measured with a very good statistics in order to not dominate the resulting error.</span>
<span id="cb12-720"><a href="#cb12-720" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb12-721"><a href="#cb12-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-722"><a href="#cb12-722" aria-hidden="true" tabindex="-1"></a>It is a good thing to think about error propagation and where it comes from... but you don't have to bother computing it by hand, as <span class="co">[</span><span class="ot">packages are here to do it for you</span><span class="co">](#working-with-experimental-errors)</span>, as we will see later in the class.</span>
<span id="cb12-723"><a href="#cb12-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-724"><a href="#cb12-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-725"><a href="#cb12-725" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further reading</span></span>
<span id="cb12-726"><a href="#cb12-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-727"><a href="#cb12-727" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A. Bevan, *[Statistical Data Analysis for the Physical Sciences](https://www.cambridge.org/core/books/statistical-data-analysis-for-the-physical-sciences/2E3D132870E72277EE5FB96FE616B9F1)*, Cambridge University Press (2013)</span>
<span id="cb12-728"><a href="#cb12-728" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>G. Bohm, *[Introduction to Statistics and Data Analysis for Physicists](http://www-library.desy.de/preparch/books/vstatmp_engl.pdf)*, Hamburg: Verl. Dt. Elektronen-Synchrotron (2010).</span>
<span id="cb12-729"><a href="#cb12-729" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>J. Watkins, *[An Introduction to the Science of Statistics](https://www.math.arizona.edu/~jwatkins/statbook.pdf)*</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>