<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>2&nbsp; A little reminder on Statistics – Reproducible data treatment with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-getting_ready.html" rel="next">
<link href="./01-about.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-152051691-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-stats.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A little reminder on Statistics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Reproducible data treatment with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/colinbousige/rclass" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About the class</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-stats.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A little reminder on Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-getting_ready.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting ready</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variables, booleans and strings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data frames</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-reading_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reading/writing all kinds of files</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lists</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-conditions_loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Conditional actions and loops</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Plotting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-3d_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">3D color plots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fitting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing documents with Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Graphical interfaces with Shiny</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-units.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Working with units and experimental errors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">List of exercises</span></span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code_bits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code bits</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#why-are-statistical-tools-necessary-in-physical-science" id="toc-why-are-statistical-tools-necessary-in-physical-science" class="nav-link active" data-scroll-target="#why-are-statistical-tools-necessary-in-physical-science"><span class="header-section-number">2.1</span> Why are statistical tools necessary in physical science?</a>
  <ul class="collapse">
<li><a href="#a-practical-example" id="toc-a-practical-example" class="nav-link" data-scroll-target="#a-practical-example"><span class="header-section-number">2.1.1</span> A practical example</a></li>
  <li><a href="#probabilistic-description-of-physical-systems" id="toc-probabilistic-description-of-physical-systems" class="nav-link" data-scroll-target="#probabilistic-description-of-physical-systems"><span class="header-section-number">2.1.2</span> Probabilistic description of physical systems</a></li>
  </ul>
</li>
  <li>
<a href="#quantifying-the-properties-of-data" id="toc-quantifying-the-properties-of-data" class="nav-link" data-scroll-target="#quantifying-the-properties-of-data"><span class="header-section-number">2.2</span> Quantifying the properties of data</a>
  <ul class="collapse">
<li><a href="#data-representation-presenting-a-measurement" id="toc-data-representation-presenting-a-measurement" class="nav-link" data-scroll-target="#data-representation-presenting-a-measurement"><span class="header-section-number">2.2.1</span> Data representation – presenting a measurement</a></li>
  <li><a href="#characterizing-an-ensemble-of-measurements" id="toc-characterizing-an-ensemble-of-measurements" class="nav-link" data-scroll-target="#characterizing-an-ensemble-of-measurements"><span class="header-section-number">2.2.2</span> Characterizing an ensemble of measurements</a></li>
  </ul>
</li>
  <li>
<a href="#useful-distributions" id="toc-useful-distributions" class="nav-link" data-scroll-target="#useful-distributions"><span class="header-section-number">2.3</span> Useful distributions</a>
  <ul class="collapse">
<li><a href="#probability-density-functions" id="toc-probability-density-functions" class="nav-link" data-scroll-target="#probability-density-functions"><span class="header-section-number">2.3.1</span> Probability Density Functions</a></li>
  <li><a href="#pdfs-mean-and-variance" id="toc-pdfs-mean-and-variance" class="nav-link" data-scroll-target="#pdfs-mean-and-variance"><span class="header-section-number">2.3.2</span> PDFs, mean and variance</a></li>
  <li><a href="#cumulative-distribution-functions" id="toc-cumulative-distribution-functions" class="nav-link" data-scroll-target="#cumulative-distribution-functions"><span class="header-section-number">2.3.3</span> Cumulative Distribution Functions</a></li>
  <li><a href="#the-poisson-distribution" id="toc-the-poisson-distribution" class="nav-link" data-scroll-target="#the-poisson-distribution"><span class="header-section-number">2.3.4</span> The Poisson distribution</a></li>
  <li><a href="#the-gaussian-distribution" id="toc-the-gaussian-distribution" class="nav-link" data-scroll-target="#the-gaussian-distribution"><span class="header-section-number">2.3.5</span> The Gaussian distribution</a></li>
  <li><a href="#the-students-t-distribution" id="toc-the-students-t-distribution" class="nav-link" data-scroll-target="#the-students-t-distribution"><span class="header-section-number">2.3.6</span> The Student’s t-distribution</a></li>
  <li><a href="#tolerence-interval-and-confidence-interval" id="toc-tolerence-interval-and-confidence-interval" class="nav-link" data-scroll-target="#tolerence-interval-and-confidence-interval"><span class="header-section-number">2.3.7</span> Tolerence interval and confidence interval</a></li>
  </ul>
</li>
  <li>
<a href="#usual-statistical-tests-on-distributions" id="toc-usual-statistical-tests-on-distributions" class="nav-link" data-scroll-target="#usual-statistical-tests-on-distributions"><span class="header-section-number">2.4</span> Usual statistical tests on distributions</a>
  <ul class="collapse">
<li><a href="#hypothesis-testing-and-p-values" id="toc-hypothesis-testing-and-p-values" class="nav-link" data-scroll-target="#hypothesis-testing-and-p-values"><span class="header-section-number">2.4.1</span> Hypothesis testing and p-values</a></li>
  <li><a href="#asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test" id="toc-asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test" class="nav-link" data-scroll-target="#asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test"><span class="header-section-number">2.4.2</span> Asserting the Gaussian nature of a distribution: the Shapiro–Wilk test</a></li>
  <li><a href="#students-t-test" id="toc-students-t-test" class="nav-link" data-scroll-target="#students-t-test"><span class="header-section-number">2.4.3</span> Student’s t-test</a></li>
  </ul>
</li>
  <li>
<a href="#uncertainty-and-errors" id="toc-uncertainty-and-errors" class="nav-link" data-scroll-target="#uncertainty-and-errors"><span class="header-section-number">2.5</span> Uncertainty and errors</a>
  <ul class="collapse">
<li><a href="#central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty" id="toc-central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty" class="nav-link" data-scroll-target="#central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty"><span class="header-section-number">2.5.1</span> Central limit theorem: on the Gaussian nature of statistical uncertainty</a></li>
  <li><a href="#combination-of-errors" id="toc-combination-of-errors" class="nav-link" data-scroll-target="#combination-of-errors"><span class="header-section-number">2.5.2</span> Combination of errors</a></li>
  </ul>
</li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">2.6</span> Further reading</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/colinbousige/rclass/blob/main/02-stats.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/colinbousige/rclass/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A little reminder on Statistics</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><section id="why-are-statistical-tools-necessary-in-physical-science" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="why-are-statistical-tools-necessary-in-physical-science">
<span class="header-section-number">2.1</span> Why are statistical tools necessary in physical science?</h2>
<p>When doing Science, one has to fully grasp the concept of <em>physical measurement</em>. Let’s take an example to visualize the importance of this concept.</p>
<section id="a-practical-example" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="a-practical-example">
<span class="header-section-number">2.1.1</span> A practical example</h3>
<p>Let’s say you want to communicate to someone a temperature, and tell this person that the temperature is “38”. If this is a random person in the street, they might think: “nice, let’s go to the beach today!”. If this random person is from the USA, they’re gonna think: “damn, where did I put my coat?”. If that person happens to be a physician, they might think: “that kid’s got a slight fever”. If they are a physicist doing a cryostat experiment, they might think “let’s check the He tank level”… you see that one of the most important part of the measurement is missing: its unit. Units are there so that people understand each other when exchanging data, and you see here that 38 Celsius, 38 Fahrenheit or 38 Kelvin are quite different, and this quantity will mean different things in different contexts. A physical quantity given without its unit would be absolutely meaningless (unless, of course, you are looking at a unit-less quantity, like a count).</p>
<p>Now let’s consider the body temperature of 38 °C given to a physician. How did you measure this temperature? With a mercury graduated thermometer or with a thermocouple? In the first case, you can probably assume that this value is given with a measurement error of at least 1 °C, meaning that the temperature you give to the physician is (38±1) °C, <em>i.e.</em> the physician won’t be able to decide whether they should be concerned or not. In the second case, the temperature is often given with a 0.1 °C precision, so the physician, seeing that the body temperature is (38±0.1) °C, will probably tell you to take an aspirin and rest instead of giving you something stronger to treat a possible infection. Given that the uncertainty on the given value is of 0.1 °C, one should in fact give the temperature with matching decimal precision, <em>i.e.</em> (38.0±0.1) °C. Writing (38±0.1) °C, (38.00001±0.1) °C or (38.00±0.10000) °C would be meaningless too.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>With this, we see that a physical measurement should be given with four parts: its actual <strong>value</strong>, its <strong>decimal precision</strong>, its <strong>uncertainty</strong>, and its <strong>unit</strong>. Should any of these four parts be missing in a physical quantity that you wanted to share, it would at best be imprecise, and at worst be utterly meaningless.</p>
</div>
</div>
</section><section id="probabilistic-description-of-physical-systems" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="probabilistic-description-of-physical-systems">
<span class="header-section-number">2.1.2</span> Probabilistic description of physical systems</h3>
<p>Let’s continue with our example of the body temperature measured with a thermocouple or a laser thermometer with a 0.1 °C precision. Our first measurement of the body temperature yielded (38.0±0.1) °C. Now let’s repeat this measurement a number of times in various area of the body (which are left to your imagination). Let’s say it then shows (38.1±0.1) °C, (38.0±0.1) °C, (38.3±0.1) °C, (37.9±0.1) °C, (38.2±0.1) °C, (38.1±0.1) °C, (38.1±0.1) °C, (39.8±0.1) °C. What is the actual body temperature then? Should we stick to a single measurement? Of course not. We have to make an histogram of the measured values, and study the distribution of the measurements (<a href="#fig-histogramT" class="quarto-xref">Figure&nbsp;<span>2.1</span></a>). We can then see that one of the values is clearly an outlier – something might have gone wrong there. What if we had done the measurement only once and only measured that value? We might have jumped to a very wrong conclusion, with possibly a very serious consequence like giving the wrong medicine.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-histogramT" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histogramT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-histogramT-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histogramT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.1: Histogram of the body temperature measurements. The red line is the mean value, the orange one is the mode and the blue one is the median.
</figcaption></figure>
</div>
</div>
</div>
<p>With this example, we see that <strong>a physical measurement is not absolute</strong>. In fact, a physical measurement is an assessment of the <strong>probability</strong> that the physical value is within a certain range. In the case of our example, after removing the outlier for which we are certain that the measurement is wrong, it means that the measured body temperature has a high probability to be somewhere between 38.0 °C and 38.2 °C. In other (more general) terms, one could consider a measurement of a quantity <span class="math inline">\(X\)</span> as a probability <span class="math inline">\(P(x - \sigma &lt; X &lt; x + \sigma )\)</span> that the quantity <span class="math inline">\(X\)</span> has a value between <span class="math inline">\(x-\sigma\)</span> and <span class="math inline">\(x+\sigma\)</span>. The <strong>uncertainty</strong> <span class="math inline">\(\sigma\)</span> around the <strong>mean value</strong> <span class="math inline">\(x\)</span> is usually given as the <strong>standard deviation</strong> of the distribution of measurements around the mean.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Since physical measurements are in fact <strong>probabilities</strong>, we <strong>can</strong> – and <strong>must</strong> – use <strong>statistical tools</strong> to characterize them.</p>
</div>
</div>
</section></section><section id="quantifying-the-properties-of-data" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="quantifying-the-properties-of-data">
<span class="header-section-number">2.2</span> Quantifying the properties of data</h2>
<section id="data-representation-presenting-a-measurement" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="data-representation-presenting-a-measurement">
<span class="header-section-number">2.2.1</span> Data representation – presenting a measurement</h3>
<p>Depending on the data you are looking at, various ways of representing them are possible. I can’t stress enough the importance of picking the right representation for your data, it is the expression of your physical sense. A good representation will help you make sense of your data and communicate your results. A bad representation, well…</p>
<section id="histograms" class="level4" data-number="2.2.1.1"><h4 data-number="2.2.1.1" class="anchored" data-anchor-id="histograms">
<span class="header-section-number">2.2.1.1</span> Histograms</h4>
<p>When looking at discrete values or when you want to characterize the distribution of a measurement, it is often a good idea to use the histogram representation, which represents the frequency at which a measurement is made within a certain range, called bin. Let’s take <a href="#fig-histogramT" class="quarto-xref">Figure&nbsp;<span>2.1</span></a> and plot it with various bin sizes. One can see that the choice of bin size is important, as it determines whether your data are noisy or lack fine information.</p>
<div id="fig-histograms" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-histograms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-histograms" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-histograms-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-histograms-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-histograms-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-histograms" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-histograms-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Bin width = 0.1 °C
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-histograms" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-histograms-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-histograms-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-histograms-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-histograms" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-histograms-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Bin width = 0.2 °C
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-histograms" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-histograms-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-histograms-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-histograms-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-histograms" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-histograms-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Bin width = 1 °C
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-histograms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.2: Histogram of the body temperature measurements with different bin widths.
</figcaption></figure>
</div>
</section><section id="graphs" class="level4" data-number="2.2.1.2"><h4 data-number="2.2.1.2" class="anchored" data-anchor-id="graphs">
<span class="header-section-number">2.2.1.2</span> Graphs</h4>
<p>In case you want to represent continuous data, say the evolution of a quantity <span class="math inline">\(y\)</span> with respect to a quantity <span class="math inline">\(x\)</span>, you should then use the graph representation. As we saw before, any physical quantity should be given with its uncertainty and unit. <strong>The same applies to a graph</strong>: it <strong>must</strong> clearly display the <strong>units</strong> of the quantities <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and <strong>error bars</strong> that are usually taken as the standard deviation of each individual measurement (that should thus be performed a number of times, depending on what you are looking at).</p>
<div id="fig-graphs" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-graphs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphs" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-graphs-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-graphs-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-graphs-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-graphs" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphs-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Meaningless graph
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphs" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-graphs-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-graphs-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-graphs-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-graphs" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphs-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Noise
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-graphs" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-graphs-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-graphs-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-graphs-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-graphs" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-graphs-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Meaningful graph
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-graphs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.3: Representing the same datapoints without error bars, with large error bars with respect to the data, and with small error bars with respect to the data: the difference between meaningless data, noise, and meaningful data.
</figcaption></figure>
</div>
<p>You can think of each set of {datapoint + error bar} as an histogram: the displayed point is the mean value of the histogram, and the error bar is its standard deviation. <strong>Therefore, plotting a straight line between points is usually pointless</strong>. Plotting a line going through the data points only has meaning if this line results from a physical model explaining the variation of the quantity <span class="math inline">\(y\)</span> with the evolution of the quantity <span class="math inline">\(x\)</span> – this is called a <strong>fit</strong>, and we will see more about it in the <a href="https://colinbousige.github.io/rclass/14-fitting.html">R class later</a>.</p>
</section></section><section id="characterizing-an-ensemble-of-measurements" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="characterizing-an-ensemble-of-measurements">
<span class="header-section-number">2.2.2</span> Characterizing an ensemble of measurements</h3>
<p>If we take <span class="math inline">\(N\)</span> repeated measurements of an observable <span class="math inline">\(x\)</span>, it is then natural to try to assess our knowledge of the ensemble of measures through (1) a single number representing the measured quantity, and (2) a second number representing the spread of measurements. As we saw before, the observable <span class="math inline">\(x\)</span> is thus generally defined by its central (mean) value <span class="math inline">\(\left&lt; x \right&gt;\)</span>, its spread <span class="math inline">\(\sigma_x\)</span> (standard deviation or uncertainty), and its unit.</p>
<section id="central-value-mode-median-and-mean" class="level4" data-number="2.2.2.1"><h4 data-number="2.2.2.1" class="anchored" data-anchor-id="central-value-mode-median-and-mean">
<span class="header-section-number">2.2.2.1</span> Central value: mode, median and mean</h4>
<p>The <strong>mode</strong> of an ensemble of measurements is its <em>most frequent value</em>. If the measurement in question is of a continuous variable, one has to bin the data in terms of a histogram in order to quantify the modal value of that distribution: the mode will be the position of the maximum of the histogram.</p>
<p>The <strong>median</strong> value of the ensemble is the value of <span class="math inline">\(x\)</span> for which there are an equal number of measurements above and below that point. If there is an even number of measurements, then the median value is taken as the midpoint between the two most central values.</p>
<p>The <strong>mean</strong> (or arithmetic average) is more often used than the two previous quantities, as it usually provides a better way to quantify the “typical” value measured. The mean value is denoted either by <span class="math inline">\(\overline{x}\)</span> or <span class="math inline">\(\left&lt; x \right&gt;\)</span>, and is given by:</p>
<p><span class="math display">\[
\overline{x}=\left&lt; x \right&gt;=\frac{1}{N}\sum_{i=1}^Nx_i,
\]</span> where <span class="math inline">\(x_i\)</span> is the <span class="math inline">\(i\)</span>-th measurement of <span class="math inline">\(x\)</span>.</p>
<p><a href="#fig-histogramT" class="quarto-xref">Figure&nbsp;<span>2.1</span></a> shows the representation of a sample of data plotted in a histogram. This figure shows the mode, mean and median. For this particular sample of data, the mean is 38.3 °C, the median is 38.1 °C, and the mode is 38.0 °C. The fact that the mode is smaller than the mean is an indication that the data are asymmetric about the mean. We usually refer to such a distribution as being skewed, and in this case the data are skewed to the right.</p>
</section><section id="quantifying-the-spread-of-data-variance-standard-deviation-and-standard-error" class="level4" data-number="2.2.2.2"><h4 data-number="2.2.2.2" class="anchored" data-anchor-id="quantifying-the-spread-of-data-variance-standard-deviation-and-standard-error">
<span class="header-section-number">2.2.2.2</span> Quantifying the spread of data: variance, standard deviation and standard error</h4>
<p>The mean of an ensemble of data doesn’t provide any information as to how the data are distributed. So any description of a set of data just quoting a mean value is incomplete. We need a second number in order to quantify the dispersion of data around the mean value. The average deviations from the mean, <span class="math inline">\(\left&lt; x-\overline{x} \right&gt;\)</span>, is not a useful quantity as, by definition, this will be zero for a symmetrically distributed sample of data (which is always the case for randomly distributed data – a consequence of the central limit theorem, as we will see later). We should rather consider the average value of the squared deviations from the mean as a measure of the spread of our ensemble of measurements. This is called the <strong>variance</strong> <span class="math inline">\(V(x)\)</span>, which is given by:</p>
<p><span id="eq-variance"><span class="math display">\[
\begin{aligned}
V(x)&amp;=\left&lt; (x-\overline{x})^2 \right&gt;\\
    &amp;=\frac{1}{N}\sum_{i=1}^N(x_i-\overline{x})^2\\
    &amp;=\overline{x^2}-\overline{x}^2
\end{aligned}
\tag{2.1}\]</span></span></p>
<p>The square root of the mean-squared (root-mean-squared or RMS) deviation is called the <strong>standard deviation</strong>, and this is given by:</p>
<p><span id="eq-sd"><span class="math display">\[
\begin{aligned}
\sigma(x)&amp;=\sqrt{V(x)}\\
         &amp;=\sqrt{\overline{x^2}-\overline{x}^2}
\end{aligned}
\tag{2.2}\]</span></span></p>
<p>The standard deviation quantifies the amount by which it is reasonable for a measurement of <span class="math inline">\(x\)</span> to differ from the mean value <span class="math inline">\(\overline{x}\)</span>. Considering a Gaussian distribution, we would expect to have 31.7% of measurements deviating from the mean value by more than 1<span class="math inline">\(\sigma\)</span>, and this goes down to 4.5% of measurements to deviate by more than 2<span class="math inline">\(\sigma\)</span>, and 0.3% of measurements to deviate by more than 3<span class="math inline">\(\sigma\)</span>. Thus, if we perform a measurement that deviates by a significant margin from the expected value of <span class="math inline">\(\left&lt; x \right&gt;\pm\sigma\)</span>, we need to ask ourselves about the significance of our measurement.</p>
<p>In general, scientists often prefer using the standard deviation rather than the variance when describing data, since as the former has the same units as the observable being measured.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>A measurement of a quantity <span class="math inline">\(x\)</span> is therefore usually presented under the form <span class="math inline">\(\left&lt; x \right&gt;\pm\sigma_x\)</span>, where <span class="math inline">\(\left&lt; x \right&gt;\)</span> is the arithmetic average and <span class="math inline">\(\sigma_x\)</span> is the standard deviation of the data.</p>
</div>
</div>
<p>The <strong>standard error</strong> is defined as the standard deviation of the mean, and is given by: <span id="eq-se"><span class="math display">\[
\begin{aligned}
\sigma(\overline{x})=\frac{\sigma(x)}{\sqrt{N}}
\end{aligned}
\tag{2.3}\]</span></span> where <span class="math inline">\(N\)</span> is the number of measurements. The standard error is a measure of the precision of the mean value <span class="math inline">\(\overline{x}\)</span>, and is often used to quantify the uncertainty on the mean value.</p>
</section><section id="caveats" class="level4" data-number="2.2.2.3"><h4 data-number="2.2.2.3" class="anchored" data-anchor-id="caveats">
<span class="header-section-number">2.2.2.3</span> Caveats</h4>
<p>The above considerations all assume that the distribution of measured values is mono-modal, <em>i.e.</em> the histogram of the measured values is centered around a single value. In the case of a multimodal distribution such as shown in <a href="#fig-multimodal" class="quarto-xref">Figure&nbsp;<span>2.4</span></a>, it would be meaningless to use such tools as the fine information on the distribution would be lost.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-multimodal" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-multimodal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-multimodal-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-multimodal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.4: A trimodal distribution of measurements. The red line shows the mean value of the distribution: it fails to grasp the reality of the distribution.
</figcaption></figure>
</div>
</div>
</div>
<p>In this case, one should try to deconvolute the distribution in terms of individual peaks, and gather their positions, widths and intensities.</p>
</section></section></section><section id="useful-distributions" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="useful-distributions">
<span class="header-section-number">2.3</span> Useful distributions</h2>
<section id="probability-density-functions" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="probability-density-functions">
<span class="header-section-number">2.3.1</span> Probability Density Functions</h3>
<p>We should now introduce the notion of <strong>Probability Density Function</strong> (PDF). <em>By definition</em>, a PDF is a distribution where the <strong>total area is unity</strong>. The variation of the PDF is represents the probability of something occurring at that point in the parameter space. In general, a PDF will be described by some function <span class="math inline">\(P(x)\)</span>, where</p>
<p><span id="eq-PDFnorm"><span class="math display">\[
\int_a^b P(x)dx=1,
\tag{2.4}\]</span></span> where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the limits of the valid domain for the <span class="math inline">\(P(x)\)</span> function. The probability of obtaining a result between <span class="math inline">\(x\)</span> and <span class="math inline">\(x + dx\)</span> is thus <span class="math inline">\(P(x)dx\)</span>. Usual PDFs encountered in physics are the Poisson distribution as well as the Gaussian distribution, that we will describe in a bit.</p>
</section><section id="pdfs-mean-and-variance" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="pdfs-mean-and-variance">
<span class="header-section-number">2.3.2</span> PDFs, mean and variance</h3>
<p>Let us define a PDF <span class="math inline">\(P(x)\)</span> describing a continuous distribution. We can compute the average value of some quantity by computing the integral over this quantity multiplied by the PDF.</p>
<p>For example, the <strong>average value</strong> of the variable <span class="math inline">\(x\)</span>, distributed according to the PDF <span class="math inline">\(P(x)\)</span> in the domain <span class="math inline">\(-\infty &lt; x &lt;\infty\)</span>, is given by:</p>
<p><span id="eq-firstmoment"><span class="math display">\[
\begin{aligned}
\left&lt; x \right&gt;&amp;=\int_{-\infty}^{\infty}xP(x)dx\\
\text{or } \left&lt; x \right&gt;&amp;=\sum_{i}x_iP(x_i) \text{ in the case of a discrete distribution}
\end{aligned}
\tag{2.5}\]</span></span></p>
<p>This is called the <em>first moment</em> of the PDF.</p>
<p>This method can be used to compute average values of more complicated expressions. The mean value of <span class="math inline">\((x - \overline{x})^2\)</span>, <em>i.e.</em> the variance <span class="math inline">\(V\)</span>, is thus given by the <span class="math inline">\(\overline{x}\)</span>-centered second moment of the PDF, such as:</p>
<p><span id="eq-secondmoment"><span class="math display">\[
\begin{aligned}
V&amp;=\int_{-\infty}^{\infty}(x - \overline{x})^2P(x)dx\\
\text{or } V&amp;=\sum_{i}(x_i - \overline{x})^2P(x_i) \text{ in the case of a discrete distribution}
\end{aligned}
\tag{2.6}\]</span></span></p>
</section><section id="cumulative-distribution-functions" class="level3" data-number="2.3.3"><h3 data-number="2.3.3" class="anchored" data-anchor-id="cumulative-distribution-functions">
<span class="header-section-number">2.3.3</span> Cumulative Distribution Functions</h3>
<p>The <strong>Cumulative Distribution Function</strong> (CDF) is defined as the integral of the PDF from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(x\)</span>:</p>
<p><span id="eq-CDF"><span class="math display">\[
\begin{aligned}
F(x)&amp;=\int_{-\infty}^{x}P(t)dt\\
\text{or } F(x)&amp;=\sum_{i}P(x_i) \text{ for a discrete distribution}
\end{aligned}
\tag{2.7}\]</span></span></p>
<p>It gives the probability of obtaining a value smaller than <span class="math inline">\(x\)</span>. The CDF is thus a monotonically increasing function, with <span class="math inline">\(F(-\infty)=0\)</span> and <span class="math inline">\(F(\infty)=1\)</span>.</p>
</section><section id="the-poisson-distribution" class="level3" data-number="2.3.4"><h3 data-number="2.3.4" class="anchored" data-anchor-id="the-poisson-distribution">
<span class="header-section-number">2.3.4</span> The Poisson distribution</h3>
<section id="definition" class="level4" data-number="2.3.4.1"><h4 data-number="2.3.4.1" class="anchored" data-anchor-id="definition">
<span class="header-section-number">2.3.4.1</span> Definition</h4>
<p>When a certain reaction happens randomly in time with an average frequency <span class="math inline">\(\lambda\)</span> in a given time interval, then the number <span class="math inline">\(k\)</span> of reactions in that time interval will follow a Poisson distribution:</p>
<p><span id="eq-poisson"><span class="math display">\[
P_\lambda(k) = \frac{\lambda^ke^{-\lambda}}{k!}
\tag{2.8}\]</span></span></p>
<p>Examples of encounters of Poisson distributions could be as various as the number of calls received per hours in a call center, the yearly number of Prussian soldiers killed by horse kicks… or the number of particles (photons, neutrons, neutrinos…) hitting a detector every second.</p>
<div id="fig-poissondistrib" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-poissondistrib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-poissondistrib" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-poissondistrib-1" class="quarto-float quarto-figure quarto-figure-center anchored" width="672" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-poissondistrib-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-poissondistrib-1.png" id="fig-poissondistrib-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-poissondistrib" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-poissondistrib-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-poissondistrib" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-poissondistrib-2" class="quarto-float quarto-figure quarto-figure-center anchored" width="672" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-poissondistrib-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-poissondistrib-2.png" id="fig-poissondistrib-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-poissondistrib" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-poissondistrib-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b)
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-poissondistrib" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-poissondistrib-3" class="quarto-float quarto-figure quarto-figure-center anchored" width="672" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-poissondistrib-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-poissondistrib-3.png" id="fig-poissondistrib-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-poissondistrib" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-poissondistrib-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c)
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-poissondistrib-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.5: Poisson distribution for various parameters. While asymmetric for small values of <span class="math inline">\(k\)</span> and <span class="math inline">\(\lambda\)</span>, it tends towards a Gaussian lineshape at larger values.
</figcaption></figure>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>In R, the Poisson distribution is implemented in the <code class="sourceCode r"><span class="fu">dpois</span>(x, lambda)</code> function. The <code>x</code> argument is the number of events, and <code>lambda</code> is the average number of events. The <code class="sourceCode r"><span class="fu">ppois</span>(x, lambda)</code> function gives the cumulative probability of observing less than <code>x</code> events. The <code class="sourceCode r"><span class="fu">qpois</span>(p, lambda)</code> function gives the number of events <code>x</code> for which the cumulative probability is <code>p</code>. Finally, the <code class="sourceCode r"><span class="fu">rpois</span>(n, lambda)</code> function generates <code>n</code> random numbers following a Poisson distribution with average <code>lambda</code>.</p>
</div>
</div>
</div>
</section><section id="characteristics" class="level4" data-number="2.3.4.2"><h4 data-number="2.3.4.2" class="anchored" data-anchor-id="characteristics">
<span class="header-section-number">2.3.4.2</span> Characteristics</h4>
<p>As shown on <a href="#fig-poissondistrib" class="quarto-xref">Figure&nbsp;<span>2.5</span></a>, for small <span class="math inline">\(\lambda\)</span> the distribution is asymmetric and skewed to the right. As <span class="math inline">\(\lambda\)</span> increases the Poisson distribution becomes more symmetric.</p>
<p>Following <a href="#eq-firstmoment" class="quarto-xref">Equation&nbsp;<span>2.5</span></a>, the average number of observed events, <span class="math inline">\(\left&lt; k \right&gt;\)</span>, is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\left&lt; k \right&gt; &amp;= \sum_{k=0}^\infty kP_\lambda(k) = \sum_{k=1}^\infty k\frac{\lambda^ke^{-\lambda}}{k!}\\
        &amp;= \lambda e^{-\lambda} \sum_{k=1}^\infty \frac{\lambda^{k-1}}{(k-1)!}= \lambda e^{-\lambda} \sum_{k=0}^\infty \frac{\lambda^{k}}{k!}\\
        &amp;= \lambda
\end{aligned}
\]</span></p>
<p>In the same manner and by using the “trick” <span class="math inline">\(x^2=x(x-1)+x\)</span>, the variance <span class="math inline">\(\sigma^2(k)\)</span> of the distribution is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma^2(k) &amp;= \sum_{k=1}^\infty (k-\lambda)^2\frac{\lambda^k e^{-\lambda}}{k!}\\
        &amp;= \lambda e^{-\lambda} \left[\sum_{k=1}^\infty k^2\frac{\lambda^{k-1}}{k!} \underbrace{-2\lambda\sum_{k=1}^\infty \frac{\lambda^{k-1}}{(k-1)!}}_{-2\lambda e^\lambda}+\underbrace{\sum_{k=1}^\infty \lambda^2\frac{\lambda^{k-1}}{k!}}_{\lambda e^\lambda}\right]\\
        &amp;= \lambda e^{-\lambda} \left[ \underbrace{\sum_{k=2}^\infty k(k-1)\frac{\lambda^{k-1}}{k!}}_{\lambda e^\lambda} + \underbrace{\sum_{k=1}^\infty k\frac{\lambda^{k-1}}{k!}}_{e^\lambda} - \lambda e^\lambda\right]\\
        &amp;=\lambda = \left&lt; k \right&gt;
\end{aligned}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The important result here is that, <strong>when counting random events with an average of</strong> <span class="math inline">\(\left&lt; N \right&gt;\)</span>, <strong>the standard deviation is</strong> <span class="math inline">\(\sigma=\sqrt{\left&lt; N \right&gt;}\)</span>. This is typically what happens when performing a diffraction or spectroscopic measurement, such as X-ray diffraction, Raman, IR or neutron spectroscopy, etc.: the longer we acquire data, the higher the number of detected “events” <span class="math inline">\(N\)</span> (particle hits detector), and the “better is the statistics”. Indeed, the relative error is thus <span class="math inline">\(\sqrt{N}/N=1/\sqrt{N}\)</span>.</p>
<p>The consequence of this is that to make a factor 10 improvement on the relative error, one has to increase by 100 the number of events. This is usually done by increasing the acquisition time, which is fine as long as it is short enough. If irrealistic acquisition times start to become necessary, one should maybe try to find another way to increase <span class="math inline">\(N\)</span>: this can be done by improving the detector efficiency, increasing the probe (laser, neutron/x-ray) brightness, changing the experimental geometry, etc.</p>
<p>Finally, for “large” numbers (<span class="math inline">\(\lambda\gtrsim 100\)</span>) the Poisson distribution tends towards a symmetric Gaussian distribution that we will describe just after.</p>
</div>
</div>
</section></section><section id="the-gaussian-distribution" class="level3" data-number="2.3.5"><h3 data-number="2.3.5" class="anchored" data-anchor-id="the-gaussian-distribution">
<span class="header-section-number">2.3.5</span> The Gaussian distribution</h3>
<section id="definition-1" class="level4" data-number="2.3.5.1"><h4 data-number="2.3.5.1" class="anchored" data-anchor-id="definition-1">
<span class="header-section-number">2.3.5.1</span> Definition</h4>
<p>The Gaussian distribution, also known as the <em>normal distribution</em>, with a mean value <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> as a function of some variable <span class="math inline">\(x\)</span> is given by:</p>
<p><span class="math display">\[
P(x, \mu, \sigma)=\frac{1}{\sigma\sqrt{2\pi}}e^{-(x-\mu)^2/2\sigma^2}
\]</span></p>
<p>It is useful to transform data from the <span class="math inline">\(x\)</span> space to a corresponding <span class="math inline">\(z\)</span> space which has a mean value of zero, and a standard deviation of one. This transformation is given by the mapping <span class="math inline">\(z=\frac{x-\mu}{\sigma}\)</span>, and the Gaussian distribution in terms of <span class="math inline">\(z\)</span> is thus:</p>
<p><span class="math display">\[
P(z)=\frac{1}{\sqrt{2\pi}}e^{-z^2/2}
\]</span></p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>In R, the Gaussian distribution is implemented in the function <code class="sourceCode r"><span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</code>. The function <code class="sourceCode r"><span class="fu">pnorm</span>(x, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</code> gives the cumulative distribution function (CDF), <em>i.e.</em> the probability that a random variable <span class="math inline">\(X\)</span> is less than or equal to <span class="math inline">\(x\)</span>. The function <code class="sourceCode r"><span class="fu">qnorm</span>(p, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="dv">1</span>)</code> gives the quantile function, <em>i.e.</em> the value of <span class="math inline">\(x\)</span> for which the CDF is equal to <span class="math inline">\(p\)</span>.</p>
</div>
</div>
</div>
</section><section id="characteristics-1" class="level4" data-number="2.3.5.2"><h4 data-number="2.3.5.2" class="anchored" data-anchor-id="characteristics-1">
<span class="header-section-number">2.3.5.2</span> Characteristics</h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-gaussian" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-gaussian-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-gaussian-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gaussian-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.6: A zero-centered Gaussian distribution with standard deviation of 1, <span class="math inline">\(P(z)\)</span>. The red line marks the half maximum, <span class="math inline">\(P(z_{HM})=1/2\sqrt{2\pi}\)</span>, and the blue lines the values of <span class="math inline">\(z\)</span> for which the half maximum is obtained, <span class="math inline">\(z_{HM}=\pm\sqrt{2\ln{2}}\)</span>.
</figcaption></figure>
</div>
</div>
</div>
<p>Sometimes instead of quantifying a Gaussian distribution (or any monomodal distribution, for that matter) using the variance or standard deviation, scientists will speak about the full width at half maximum (<strong>FWHM</strong>). This has the advantage that any extreme outliers of the distribution do not contribute to the quantification of the spread of data. As the name suggests, the FWHM is the width of the distribution (the spread above and below the mean) at the points where the distribution reaches half of its maximum. You can also encounter the HWHM = FWHM/2, the Half Width at Half Maximum.</p>
<p>For a Gaussian distribution <span class="math inline">\(P(z)\)</span>, the half maximum is attained when <span class="math inline">\(z_{HM}\)</span> is so that:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{1}{\sqrt{2\pi}}e^{-z_{HM}^2/2}&amp;= \frac{1}{2}\frac{1}{\sqrt{2\pi}}\\
\Rightarrow z_{HM}&amp;=\pm\sqrt{2\ln{2}}
\end{aligned}
\]</span></p>
<p>The FWHM of <span class="math inline">\(P(z)\)</span> is therefore <span class="math inline">\(FWHM=2\sqrt{2\ln{2}}\simeq2.355\)</span>. Using the relation between <span class="math inline">\(z\)</span> and <span class="math inline">\(\sigma\)</span>, we get the relation between the FWHM and the standard deviation:</p>
<p><span class="math display">\[
FWHM=2\sqrt{2\ln{2}}\times\sigma
\]</span></p>
<p>As can be seen on <a href="#tbl-tablevalues" class="quarto-xref">Table&nbsp;<span>2.1</span></a>, using the FWHM ensures that roughly 76% of the data are comprised between <span class="math inline">\(\mu-HWHM\)</span> and <span class="math inline">\(\mu+HWHM\)</span>, and this goes up to <span class="math inline">\(\sim95\)</span>% for the range <span class="math inline">\([\mu-2\sigma, \mu+2\sigma]\)</span>.</p>
<div class="cell" data-layout-align="center">
<div id="tbl-tablevalues" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tablevalues-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.1: Integral values for various values of <span class="math inline">\(a\)</span> in <span class="math inline">\(\int_{-a}^aP(z)dz\)</span>.
</figcaption><div aria-describedby="tbl-tablevalues-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Integration range <span class="math inline">\(a\)</span>
</th>
<th style="text-align: left;"><span class="math inline">\(\int_{-a}^aP(z)dz\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\sigma\)</span></td>
<td style="text-align: left;">0.68293</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(HWHM=\sqrt{2\ln{2}}\sigma\)</span></td>
<td style="text-align: left;">0.76100</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(1.96\sigma\)</span></td>
<td style="text-align: left;">0.95000</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(2\sigma\)</span></td>
<td style="text-align: left;">0.95455</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(3\sigma\)</span></td>
<td style="text-align: left;">0.99730</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(4\sigma\)</span></td>
<td style="text-align: left;">0.99994</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can see from <a href="#tbl-tablevalues" class="quarto-xref">Table&nbsp;<span>2.1</span></a> that if you want to make sure that exactly 95% of your data will fall in the given range, <em>i.e.</em> which defines the <strong>95% tolerence interval</strong>, you need to use a range of <span class="math inline">\(1.96\sigma\)</span>.</p>
</div>
</div>
</section></section><section id="the-students-t-distribution" class="level3" data-number="2.3.6"><h3 data-number="2.3.6" class="anchored" data-anchor-id="the-students-t-distribution">
<span class="header-section-number">2.3.6</span> The Student’s t-distribution</h3>
<p>The Student’s t-distribution (or simply, “t-distribution”) is a probability distribution that is used to estimate population parameters <strong>when the sample size is small</strong> and/or when the population variance is unknown. It is a bell-shaped distribution that is symmetrical about the mean, showing that data near the mean are more frequent in occurrence than data far from the mean.</p>
<p>The t-distribution is used in place of the normal distribution when dealing with small samples (<span class="math inline">\(N &lt; 30\)</span>) or when the population standard deviation is unknown. Its shape is similar to the normal distribution but it has heavier tails, meaning that it is more prone to producing values that fall far from its mean. It has the following PDF formula:</p>
<p><span class="math display">\[
P(x, \nu)=\frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\nu\pi}\Gamma\left(\frac{\nu}{2}\right)}\left(1+\frac{x^2}{\nu}\right)^{-\frac{\nu+1}{2}}
\]</span> where <span class="math inline">\(\Gamma\)</span> is the <a href="https://en.wikipedia.org/wiki/Gamma_function">gamma function</a> and <span class="math inline">\(\nu\)</span> is the number of degrees of freedom defined as <span class="math inline">\(\nu=N-1\)</span>. For large number of observations, the t-distribution converges to the normal distribution.</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>In R, the t-distribution is implemented in the function <code class="sourceCode r"><span class="fu">dt</span>(x, df)</code> where <code>x</code> is the vector of quantiles and <code>df</code> is the number of degrees of freedom. The <code class="sourceCode r"><span class="fu">qt</span>(p, df)</code> function returns the quantiles <span class="math inline">\(q\)</span> of the t-distribution such that <span class="math inline">\(P(X\leq q)=p\)</span>.</p>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-t-distribution" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-t-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-t-distribution-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-t-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.7: The t-distribution for various degrees of freedom compared to the Gaussian distribution.
</figcaption></figure>
</div>
</div>
</div>
</section><section id="tolerence-interval-and-confidence-interval" class="level3" data-number="2.3.7"><h3 data-number="2.3.7" class="anchored" data-anchor-id="tolerence-interval-and-confidence-interval">
<span class="header-section-number">2.3.7</span> Tolerence interval and confidence interval</h3>
<section id="sec-tolerence-interval" class="level4" data-number="2.3.7.1"><h4 data-number="2.3.7.1" class="anchored" data-anchor-id="sec-tolerence-interval">
<span class="header-section-number">2.3.7.1</span> Tolerance interval</h4>
<p>A <strong>tolerance interval</strong> is a range of values that is likely to contain a certain proportion of the population. It is thus representative of the spread of data in the population, and it is usually given by the standard deviation <span class="math inline">\(\sigma\)</span> multiplied by a <strong>confidence level</strong> factor. As seen in <a href="#tbl-tablevalues" class="quarto-xref">Table&nbsp;<span>2.1</span></a>, for a Gaussian distribution, the range <span class="math inline">\([\mu-1.96\sigma, \mu+1.96\sigma]\)</span> contains roughly 95% of the data in the population, and this is the <strong>95% tolerence interval</strong>. It means that if you draw a sample of data from the population, the probability that the data points of the sample will fall in this range is 95%. If your distribution population is small however (<span class="math inline">\(N&lt;30\)</span>), you should use the t-distribution instead of the Gaussian distribution to compute the tolerence interval.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-tolerenceinterval" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-tolerenceinterval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-tolerenceinterval-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-tolerenceinterval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.8: The 95% tolerence interval for a Gaussian distribution.
</figcaption></figure>
</div>
</div>
</div>
<p>In R, you would use the <code class="sourceCode r"><span class="fu">qt</span>(p, df)</code> (for a t-distribution) or <code class="sourceCode r"><span class="fu">qnorm</span>(p)</code> (for a Gaussian distribution) functions to compute the quantiles <span class="math inline">\(q\)</span> such that <span class="math inline">\(P(X\leq q)=p\)</span>. If you want to compute the <strong>95% tolerence interval</strong> for a distribution, you need to compute the quantiles <span class="math inline">\(q\)</span> such that <span class="math inline">\(P(X\leq q)=0.025\)</span> and <span class="math inline">\(P(X\leq q)=0.975\)</span>, <em>i.e.</em> find the values below and above which 2.5% of the distribtution are left out, as shown in <a href="#fig-tolerenceinterval" class="quarto-xref">Figure&nbsp;<span>2.8</span></a>.</p>
<p>Since both the Gaussian and t-distributions are symmetric, the tolerence interval is given by <span class="math inline">\([q, -q]\)</span>: for a tolerance interval with <em>tolerence level</em> <span class="math inline">\(\alpha\)</span>, you want the quantile for the probability <span class="math inline">\(p=(1+\alpha)/2\)</span>. Some special values are gathered in <a href="#tbl-tolerenceinterval" class="quarto-xref">Table&nbsp;<span>2.2</span></a>.</p>
<div class="cell" data-layout-align="center">
<div id="tbl-tolerenceinterval" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tolerenceinterval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.2: Quantiles of the t- and Gaussian distributions for various degrees of freedom (<span class="math inline">\(\nu\)</span>) and tolerence levels (<span class="math inline">\(\alpha\)</span>).
</figcaption><div aria-describedby="tbl-tolerenceinterval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"><span class="math inline">\(\nu\)</span></th>
<th style="text-align: right;">
<span class="math inline">\(\alpha\)</span>: 50%</th>
<th style="text-align: right;">
<span class="math inline">\(\alpha\)</span>: 80%</th>
<th style="text-align: right;">
<span class="math inline">\(\alpha\)</span>: 90%</th>
<th style="text-align: right;">
<span class="math inline">\(\alpha\)</span>: 95%</th>
<th style="text-align: right;">
<span class="math inline">\(\alpha\)</span>: 99%</th>
<th style="text-align: right;">
<span class="math inline">\(\alpha\)</span>: 99.9%</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">3.077684</td>
<td style="text-align: right;">6.313752</td>
<td style="text-align: right;">12.706205</td>
<td style="text-align: right;">63.656741</td>
<td style="text-align: right;">636.619249</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0.8164966</td>
<td style="text-align: right;">1.885618</td>
<td style="text-align: right;">2.919986</td>
<td style="text-align: right;">4.302653</td>
<td style="text-align: right;">9.924843</td>
<td style="text-align: right;">31.599055</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.7648923</td>
<td style="text-align: right;">1.637744</td>
<td style="text-align: right;">2.353363</td>
<td style="text-align: right;">3.182446</td>
<td style="text-align: right;">5.840909</td>
<td style="text-align: right;">12.923979</td>
</tr>
<tr class="even">
<td style="text-align: left;">30</td>
<td style="text-align: right;">0.6827557</td>
<td style="text-align: right;">1.310415</td>
<td style="text-align: right;">1.697261</td>
<td style="text-align: right;">2.042273</td>
<td style="text-align: right;">2.749996</td>
<td style="text-align: right;">3.645959</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\infty\)</span></td>
<td style="text-align: right;">0.6744898</td>
<td style="text-align: right;">1.281552</td>
<td style="text-align: right;">1.644854</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.575829</td>
<td style="text-align: right;">3.290527</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gaussian</td>
<td style="text-align: right;">0.6744898</td>
<td style="text-align: right;">1.281552</td>
<td style="text-align: right;">1.644854</td>
<td style="text-align: right;">1.959964</td>
<td style="text-align: right;">2.575829</td>
<td style="text-align: right;">3.290527</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="confidence-interval" class="level4" data-number="2.3.7.2"><h4 data-number="2.3.7.2" class="anchored" data-anchor-id="confidence-interval">
<span class="header-section-number">2.3.7.2</span> Confidence interval</h4>
<p><strong>Confidence intervals</strong> represent the range of uncertainty associated with the estimate of a statistic (<em>i.e.</em> the mean, proportion or standard deviation etc…). An estimate is necessarily subject to the risk of sampling error. Confidence intervals are useful for establishing limits for the estimation of, for example, the mean or a standard deviation, but also regression coefficients, proportions, frequency rates (Poisson) and differences between populations.</p>
<p><strong>Confidence intervals</strong> are thus a measurement of the <strong>standard error of the estimated statistic</strong>, and their widths thus naturally decrease with the sampling size. As the sample size approaches the entire population, the width of the confidence interval approaches zero, as can be seen on <a href="#fig-confidenceinterval" class="quarto-xref">Figure&nbsp;<span>2.9</span></a>.</p>
<div id="fig-confidenceinterval" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-confidenceinterval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-confidenceinterval" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-confidenceinterval-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-confidenceinterval-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-confidenceinterval-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-confidenceinterval" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-confidenceinterval-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Population size: 20
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-confidenceinterval" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-confidenceinterval-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-confidenceinterval-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="02-stats_files/figure-html/fig-confidenceinterval-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" data-ref-parent="fig-confidenceinterval" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-confidenceinterval-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Population size: 500
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-confidenceinterval-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2.9: Histograms of a Gaussian distribution of mean 0 (red line) and standard deviation 1 with two samplings. The measured mean of the distribution is shown in black, and the 95% confidence interval of the mean is shown in orange. As the population size increases, the width of the confidence interval decreases since the error on the determination of the mean decreases.
</figcaption></figure>
</div>
<p>To compute the confidence interval of a statistic, you need to know the <strong>standard error</strong> of the statistic, which is the standard deviation of the sampling distribution of the statistic. <a href="#tbl-SE" class="quarto-xref">Table&nbsp;<span>2.3</span></a> gathers a few typical standard errors on statistics:</p>
<div id="tbl-SE" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-SE-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2.3: Standard errors of typical statistics
</figcaption><div aria-describedby="tbl-SE-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 39%">
<col style="width: 60%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Statistic</th>
<th style="text-align: left;">Standard error</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mean</td>
<td style="text-align: left;"><span class="math inline">\(SE(\overline{x})=\frac{\sigma(x)}{\sqrt{N}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Standard deviation</td>
<td style="text-align: left;"><span class="math inline">\(SE(\sigma(x))=\frac{\sigma(x)}{\sqrt{2(N-1)}}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Median</td>
<td style="text-align: left;"><span class="math inline">\(SE(\widetilde{x})=\sqrt{\frac{\pi}{2}}\frac{\sigma(x)}{\sqrt{N}}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Difference between two means</td>
<td style="text-align: left;"><span class="math inline">\(SE(\overline{x_1}-\overline{x_2})=\sqrt{\frac{\sigma(x_1)^2}{N_1}+\frac{\sigma(x_2)^2}{N_2}}\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Then, the confidence interval for the statistics <span class="math inline">\(X\)</span> with a confidence level <span class="math inline">\(\alpha\)</span> is computed as: <span id="eq-CI"><span class="math display">\[
CI(X, \alpha)=X\pm \text{qt}\left(\frac{1+\alpha}{2},\nu\right)\times SE(X)
\tag{2.9}\]</span></span> where <span class="math inline">\(\text{qt}\left(\frac{1+\alpha}{2},\nu\right)\)</span> is the quantile of the Student distribution with <span class="math inline">\(\nu\)</span> degrees of freedom and a probability of <span class="math inline">\(\frac{1+\alpha}{2}\)</span> (as seen in <a href="#sec-tolerence-interval" class="quarto-xref"><span>Section 2.3.7.1</span></a>).</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remember
</div>
</div>
<div class="callout-body-container callout-body">
<p>The width of a <strong>tolerance interval</strong> is due to both the sampling error and the variance in the population. It is a measurement of the spread of data.</p>
<p>The width of a <strong>confidence interval</strong> is due to the sampling error only. It is a measurement of the precision of the estimate of a statistic.</p>
</div>
</div>
</section></section></section><section id="usual-statistical-tests-on-distributions" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="usual-statistical-tests-on-distributions">
<span class="header-section-number">2.4</span> Usual statistical tests on distributions</h2>
<section id="hypothesis-testing-and-p-values" class="level3" data-number="2.4.1"><h3 data-number="2.4.1" class="anchored" data-anchor-id="hypothesis-testing-and-p-values">
<span class="header-section-number">2.4.1</span> Hypothesis testing and p-values</h3>
<p>A <strong>hypothesis test</strong> is a statistical test that is used to determine whether a given hypothesis is true or not. It is based on the comparison of the observed data with the expected data, given the hypothesis.</p>
<p>The <strong>null hypothesis</strong> (usually noted <span class="math inline">\(H_0\)</span>) is the hypothesis that is tested, and the <strong>alternative hypothesis</strong> (usually noted <span class="math inline">\(H_1\)</span>) is the hypothesis that is assumed to be true if the null hypothesis is rejected.</p>
<p>The <strong>p-value</strong> is the probability of obtaining a fluctuation in data under the null hypothesis that is as, or more, extreme than that observed by a given experiment. If the p-value is smaller than a predifined tolerance (usually set to 0.05), then one might consider rejecting the null hypothesis as the probability of observing such a fluctuation under the null hypothesis is extremely small.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>If the <strong>p-value</strong> <span class="math inline">\(\ge\alpha\)</span> (typically 0.05), the null hypothesis is accepted.</li>
<li>If the <strong>p-value</strong> is below a certain threshold <span class="math inline">\(\alpha\)</span>, the null hypothesis is rejected.</li>
</ul>
</div>
</div>
<p>In R, most tests will automatically return a p-value, which will help you decide whether the test is conclusive or not – we will not delve into the details of computing these p-values.</p>
</section><section id="asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test" class="level3" data-number="2.4.2"><h3 data-number="2.4.2" class="anchored" data-anchor-id="asserting-the-gaussian-nature-of-a-distribution-the-shapirowilk-test">
<span class="header-section-number">2.4.2</span> Asserting the Gaussian nature of a distribution: the Shapiro–Wilk test</h3>
<p>The Shapiro-Wilk test is a statistical test that can be used to determine whether a distribution of data is Gaussian or not. It is based on the comparison of the observed distribution with the expected distribution of a Gaussian distribution with the same mean and standard deviation. Its <strong>null hypothesis</strong> is that the data are normally distributed, thus:</p>
<ul>
<li>If the <strong>p-value</strong> <span class="math inline">\(&lt;\alpha\)</span>, the null hypothesis is rejected and the data are not normally distributed.</li>
<li>If the <strong>p-value</strong> <span class="math inline">\(\ge\alpha\)</span>, the null hypothesis is not rejected and the data are normally distributed.</li>
</ul>
<p>Let’s perform a Shapiro-Wilk test on the distribution of the data in <a href="#fig-histogramT" class="quarto-xref">Figure&nbsp;<span>2.1</span></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">38</span>, <span class="fl">38.1</span>, <span class="fl">38.0</span>, <span class="fl">38.0</span>, <span class="fl">38.3</span>, <span class="fl">37.9</span>, <span class="fl">38.1</span>, <span class="fl">38.2</span>, <span class="fl">39.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Shapiro-Wilk normality test
#&gt; 
#&gt; data:  temp
#&gt; W = 0.57969, p-value = 5.526e-05</code></pre>
</div>
</div>
<p>We see here that the p-value is 5.53e-05, which is below the threshold <span class="math inline">\(\alpha\)</span> = 0.05. This means that <strong>it is extremely unlikely that you’d observe such measurements if their distribution were normal</strong>. The null hypothesis that the data are normally distributed is thus rejected, and we can conclude that the data are not normally distributed – as expected from their representation in <a href="#fig-histogramT" class="quarto-xref">Figure&nbsp;<span>2.1</span></a>.</p>
<p>If we were to remove the outlier (39.8) and perform the test again, we would get a p-value of 0.592, which means that there is a 59.2% chance to observe such measurements if their distribution were normal. As p-value &gt; 0.05, the null hypothesis that the data are normally distributed is not rejected, and we can conclude that the data are normally distributed.</p>
</section><section id="students-t-test" class="level3" data-number="2.4.3"><h3 data-number="2.4.3" class="anchored" data-anchor-id="students-t-test">
<span class="header-section-number">2.4.3</span> Student’s t-test</h3>
<p>The Student’s t-test is a statistical test that can be used to determine whether two sets of data are significantly different from each other. Its <strong>null hypothesis</strong> is that <strong>the two sets of data are drawn from the same distribution</strong>, thus:</p>
<ul>
<li>If the <strong>p-value</strong> <span class="math inline">\(&lt;\alpha\)</span>, the null hypothesis is rejected and the data are not drawn from the same distribution.</li>
<li>If the <strong>p-value</strong> <span class="math inline">\(\ge\alpha\)</span>, the null hypothesis is not rejected and the data are drawn from the same distribution.</li>
</ul>
<p>Let’s work on two sets of temperature measurements performed on two different days on two different person. We want to assert whether the temperature evolution between the two days is significant or not for each patient. For the sake of example, let’s say that in both cases, they present the same average temperature on day 1 and on day 2 but with a different spread in data.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-stats_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data means and standard deviations</caption>
<thead><tr class="header">
<th style="text-align: left;">Day</th>
<th style="text-align: left;">Patient</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Day1</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">38.21147</td>
<td style="text-align: right;">0.1860482</td>
</tr>
<tr class="even">
<td style="text-align: left;">Day2</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">37.78760</td>
<td style="text-align: right;">0.3382961</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Day1</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">37.05121</td>
<td style="text-align: right;">2.0474910</td>
</tr>
<tr class="even">
<td style="text-align: left;">Day2</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">38.83840</td>
<td style="text-align: right;">3.1268909</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We want to determine whether the temperature evolution between the two days is significant or not for each patient. We can perform a Student’s t-test to assert whether the two sets of data are significantly different from each other.</p>
<p>First, <strong>to apply a t-test, we need to make sure that the data are normally distributed</strong>, which we can do by performing a Shapiro-Wilk test on each set of data:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Day</th>
<th style="text-align: left;">Patient</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Day1</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">0.9442119</td>
<td style="text-align: right;">0.2876294</td>
</tr>
<tr class="even">
<td style="text-align: left;">Day2</td>
<td style="text-align: left;">A</td>
<td style="text-align: right;">0.9390758</td>
<td style="text-align: right;">0.2303134</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Day1</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">0.9760261</td>
<td style="text-align: right;">0.8732331</td>
</tr>
<tr class="even">
<td style="text-align: left;">Day2</td>
<td style="text-align: left;">B</td>
<td style="text-align: right;">0.9836235</td>
<td style="text-align: right;">0.9719258</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In all cases the p-value is above 0.05, which means that the null hypothesis that the data are normally distributed is not rejected, and <strong>we can conclude that the data are normally distributed</strong>. The application of the t-test is thus valid.</p>
<p>Let’s start now with patient A:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">temperatures</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Patient</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span>,</span>
<span>       <span class="va">Temperature</span> <span class="op">~</span> <span class="va">Day</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  Temperature by Day
#&gt; t = 4.9099, df = 29.53, p-value = 3.12e-05
#&gt; alternative hypothesis: true difference in means between group Day1 and group Day2 is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  0.2474455 0.6003007
#&gt; sample estimates:
#&gt; mean in group Day1 mean in group Day2 
#&gt;           38.21147           37.78760</code></pre>
</div>
</div>
<p>As could be intuited by the graphical representation, the t-test on patient A shows that their temperature decreased significantly between day 1 and day 2, with a p-value of 3.12e-05, which is largely below the threshold <span class="math inline">\(\alpha\)</span> = 0.05. To report it properly, we can say that “the temperature of patient A on day 1 (38.21°C, 95% CI = [38.12, 38.3]°C), was statistically significantly higher than on day 2 (37.79°C, 95% CI = [37.63, 37.95]°C), t(29.53) = 4.91, p = 3.12e-05.” Here , 29.53 is the degrees of freedom associated with the t test-statistic. The 95% confidence interval for the difference between the means is 0.25°C to 0.6°C.</p>
<p>For patient B however, even though the average temperature decreased between the two days, the spread in data is so large that the t-test does not allow concluding concerning any significant temperature difference between the two days:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">temperatures</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Patient</span> <span class="op">==</span> <span class="st">"B"</span><span class="op">)</span>,</span>
<span>       <span class="va">Temperature</span> <span class="op">~</span> <span class="va">Day</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Welch Two Sample t-test
#&gt; 
#&gt; data:  Temperature by Day
#&gt; t = -2.1384, df = 32.763, p-value = 0.04003
#&gt; alternative hypothesis: true difference in means between group Day1 and group Day2 is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -3.48800945 -0.08636915
#&gt; sample estimates:
#&gt; mean in group Day1 mean in group Day2 
#&gt;           37.05121           38.83840</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Performing a t-test on a single distribution will test whether the distribution’s mean is equal to 0:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">temperatures</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Patient</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="va">Day</span><span class="op">==</span><span class="st">"Day1"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">Temperature</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  One Sample t-test
#&gt; 
#&gt; data:  temperatures %&gt;% filter(Patient == "B", Day == "Day1") %&gt;% pull(Temperature)
#&gt; t = 80.927, df = 19, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: true mean is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  36.09295 38.00946
#&gt; sample estimates:
#&gt; mean of x 
#&gt;  37.05121</code></pre>
</div>
</div>
</div>
</div>
</section></section><section id="uncertainty-and-errors" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="uncertainty-and-errors">
<span class="header-section-number">2.5</span> Uncertainty and errors</h2>
<section id="central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty" class="level3" data-number="2.5.1"><h3 data-number="2.5.1" class="anchored" data-anchor-id="central-limit-theorem-on-the-gaussian-nature-of-statistical-uncertainty">
<span class="header-section-number">2.5.1</span> Central limit theorem: on the Gaussian nature of statistical uncertainty</h3>
<p>The <strong>central limit theorem</strong> states that if one takes <span class="math inline">\(N\)</span> random independent samples of a distribution of data that describes some variable <span class="math inline">\(x\)</span>, then as <span class="math inline">\(N\)</span> tends to infinity, the distribution of the sum of the samples tends to a Gaussian distribution.</p>
<p>In other terms: the mean value of a large number <span class="math inline">\(N\)</span> of independent random variables (that can be distributed following any distribution with finite variance), obeying the same distribution with variance <span class="math inline">\(\sigma_0^2\)</span>, approaches a normal distribution with variance <span class="math inline">\(\sigma^2 = \sigma _0^2/N\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>This result is fundamental</strong> as it implies that <strong>independent measurements of any observable will show values that will be spread following a Gaussian distribution</strong>, and thus statistical uncertainties that are Gaussian in nature.</p>
<p>Moreover, we see here the typical property of statistical errors, which is that <strong>the relative error is proportional to</strong> <span class="math inline">\(1/\sqrt{N}\)</span>. Increasing the number of observations thus decreases the error, <em>i.e.</em> increases the precision.</p>
</div>
</div>
</section><section id="combination-of-errors" class="level3" data-number="2.5.2"><h3 data-number="2.5.2" class="anchored" data-anchor-id="combination-of-errors">
<span class="header-section-number">2.5.2</span> Combination of errors</h3>
<p>Let us consider a function of <span class="math inline">\(n\)</span> variables, <span class="math inline">\(f(u_1, u_2, ..., u_n)\)</span>. We can Taylor expand this function about the various mean values <span class="math inline">\(u_i=\overline{u_i}\)</span>, so that, at the first order:</p>
<p><span class="math display">\[
f(u_1, ..., u_n) = f(\overline{u_1}, ..., \overline{u_n}) + \sum_{i=1}^n (u_i-\overline{u_i})\frac{\partial f}{\partial u_i}
\]</span></p>
<p>Considering that the variance of a quantity <span class="math inline">\(f\)</span> is given by <span class="math inline">\(\sigma^2(f) = (f - \overline{f} )^2\)</span>, it follows that the variance of our multivariable function is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma^2(f) &amp;= \left(\sum_{i=1}^n (u_i-\overline{u_i})\frac{\partial f}{\partial u_i}\right)^2\\
         &amp;= \sum_{i=1}^n \left(\frac{\partial f}{\partial u_i}\right)^2\sigma_{u_i}^2 + 2\sum_{i\ne j}\frac{\partial f}{\partial u_i}\frac{\partial f}{\partial u_j}\sigma_{u_iu_j}\\
\end{aligned}
\]</span> where we have replaced <span class="math inline">\((u_i-\overline{u_i})^2\)</span> by the variance <span class="math inline">\(\sigma_{u_i}^2\)</span> and <span class="math inline">\((u_i-\overline{u_i})(u_j-\overline{u_j})\)</span> by the covariance <span class="math inline">\(\sigma_{u_iu_j}\)</span>.<br></p>
<p>If the variables <span class="math inline">\(u_i\)</span> are independent then the covariance <span class="math inline">\(\sigma_{u_iu_j}\)</span> is null, and it follows the general expression of the standard error that can be applied to <strong>any function of independent variables</strong>:</p>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><span id="eq-uncertainty"><span class="math display">\[
\sigma(f) = \sqrt{\sum_{i=1}^n \left(\frac{\partial f}{\partial u_i}\right)^2\sigma_{u_i}^2}
\tag{2.10}\]</span></span></p>
</div>
</div>
</div>
<section id="functions-of-one-variable" class="level4" data-number="2.5.2.1"><h4 data-number="2.5.2.1" class="anchored" data-anchor-id="functions-of-one-variable">
<span class="header-section-number">2.5.2.1</span> Functions of one variable</h4>
<p>Let us consider a function <span class="math inline">\(f\)</span> having a form that depends only on one observable <span class="math inline">\(x\)</span>, for example:</p>
<p><span class="math display">\[
f = Ax + B
\]</span></p>
<p>Then, following <a href="#eq-uncertainty" class="quarto-xref">Equation&nbsp;<span>2.10</span></a>, the standard error on that function is given by:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma_f &amp;= \sqrt{\left(\frac{\partial f}{\partial x}\right)^2\sigma_x^2}\\
         &amp;= A\sigma_x
\end{aligned}
\]</span></p>
<p>So, <strong>independently of any offset of the measured observable</strong>, the resulting error must be corrected by the same factor as the intensity.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>In practice</strong>, let’s say we measure a Raman spectrum. As we saw above, the error on each intensity count is given by the square root of this intensity count.</p>
<ul>
<li>It is possible to shift vertically this spectrum without having to recompute the error bars.</li>
<li>But if you want to normalize (say, to 1) this spectrum, you have to multiply all the errors by the renormalization constant.</li>
</ul>
</div>
</div>
</section><section id="functions-of-two-variables" class="level4" data-number="2.5.2.2"><h4 data-number="2.5.2.2" class="anchored" data-anchor-id="functions-of-two-variables">
<span class="header-section-number">2.5.2.2</span> Functions of two variables</h4>
<p>Now consider the function <span class="math inline">\(f = Ax + By\)</span>, where we have measured the mean and standard deviation of both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and want to compute the standard deviation on their sum/subtraction. We can use the general formula of <a href="#eq-uncertainty" class="quarto-xref">Equation&nbsp;<span>2.10</span></a> to determine how to do this, hence:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma_f &amp;= \sqrt{\left(\frac{\partial f}{\partial x}\right)^2\sigma_x^2 + \left(\frac{\partial f}{\partial y}\right)^2\sigma_y^2}\\
         &amp;= \sqrt{A^2\sigma_x^2 + B^2\sigma_y^2}
\end{aligned}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>In practice</strong>, let’s say we measure an UV spectrum of a solution (a molecule in a solvent), and a reference spectrum of this solvent. As we saw above, the error on each intensity count is given by the square root of this intensity count. We want to subtract the signal of the solvent to get only the signal of the molecule.</p>
<p>We thus have to perform the above operation on the errors, <span class="math inline">\(\sigma_{result}=\sqrt{\sigma^2_{solution}+\sigma^2_{reference}}\)</span>. It means that in order to have a statistically sound resulting spectrum, the reference needs to be measured with a very good statistics in order to not dominate the resulting error.</p>
</div>
</div>
<p>It is a good thing to think about error propagation and where it comes from… but you don’t have to bother computing it by hand, as <a href="https://colinbousige.github.io/rclass/17-units.html#working-with-experimental-errors">packages are here to do it for you</a>, as we will see later in the class.</p>
</section></section></section><section id="further-reading" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="further-reading">
<span class="header-section-number">2.6</span> Further reading</h2>
<ul>
<li>A. Bevan, <em><a href="https://www.cambridge.org/core/books/statistical-data-analysis-for-the-physical-sciences/2E3D132870E72277EE5FB96FE616B9F1">Statistical Data Analysis for the Physical Sciences</a></em>, Cambridge University Press (2013)</li>
<li>G. Bohm, <em><a href="http://www-library.desy.de/preparch/books/vstatmp_engl.pdf">Introduction to Statistics and Data Analysis for Physicists</a></em>, Hamburg: Verl. Dt. Elektronen-Synchrotron (2010).</li>
<li>J. Watkins, <em><a href="https://www.math.arizona.edu/~jwatkins/statbook.pdf">An Introduction to the Science of Statistics</a></em>
</li>
</ul>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./01-about.html" class="pagination-link" aria-label="About the class">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About the class</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-getting_ready.html" class="pagination-link" aria-label="Getting ready">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting ready</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb9" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># A little reminder on Statistics</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r include=FALSE, warning = FALSE, cache=FALSE}</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="in">library(pracma)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="in">library(kableExtra)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="in">library(quantities)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="in">library(broom)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="in">library(latex2exp)</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="in">opts_chunk$set(fig.align = "center")</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_bw()+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(text=element_text(size=10),</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.background = element_blank(),</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.text = element_text(face="bold"),</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="in">          panel.border = element_rect(linewidth=1)</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="in">         )</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="in">colors &lt;- colorRampPalette(c("black","royalblue","seagreen","orange","red"))</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why are statistical tools necessary in physical science?</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>When doing Science, one has to fully grasp the concept of *physical measurement*. Let's take an example to visualize the importance of this concept.</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="fu">### A practical example</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>Let's say you want to communicate to someone a temperature, and tell this person that the temperature is "38". If this is a random person in the street, they might think: "nice, let's go to the beach today!". If this random person is from the USA, they're gonna think: "damn, where did I put my coat?". If that person happens to be a physician, they might think: "that kid's got a slight fever". If they are a physicist doing a cryostat experiment, they might think "let's check the He tank level"... you see that one of the most important part of the measurement is missing: its unit. Units are there so that people understand each other when exchanging data, and you see here that 38 Celsius, 38 Fahrenheit or 38 Kelvin are quite different, and this quantity will mean different things in different contexts. A physical quantity given without its unit would be absolutely meaningless (unless, of course, you are looking at a unit-less quantity, like a count).</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>Now let's consider the body temperature of 38 °C given to a physician. How did you measure this temperature? With a mercury graduated thermometer or with a thermocouple? In the first case, you can probably assume that this value is given with a measurement error of at least 1 °C, meaning that the temperature you give to the physician is (38±1) °C, *i.e.* the physician won't be able to decide whether they should be concerned or not. In the second case, the temperature is often given with a 0.1 °C precision, so the physician, seeing that the body temperature is (38±0.1) °C, will probably tell you to take an aspirin and rest instead of giving you something stronger to treat a possible infection. Given that the uncertainty on the given value is of 0.1 °C, one should in fact give the temperature with matching decimal precision, *i.e.* (38.0±0.1) °C. Writing (38±0.1) °C, (38.00001±0.1) °C or (38.00±0.10000) °C would be meaningless too.</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>With this, we see that a physical measurement should be given with four parts: its actual **value**, its **decimal precision**, its **uncertainty**, and its **unit**. Should any of these four parts be missing in a physical quantity that you wanted to share, it would at best be imprecise, and at worst be utterly meaningless.</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probabilistic description of physical systems</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>Let's continue with our example of the body temperature measured with a thermocouple or a laser thermometer with a 0.1 °C precision.</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>Our first measurement of the body temperature yielded (38.0±0.1) °C. Now let's repeat this measurement a number of times in various area of the body (which are left to your imagination). Let's say it then shows (38.1±0.1) °C, (38.0±0.1) °C, (38.3±0.1) °C, (37.9±0.1) °C, (38.2±0.1) °C, (38.1±0.1) °C, (38.1±0.1) °C, (39.8±0.1) °C. What is the actual body temperature then? Should we stick to a single measurement? Of course not. We have to make an histogram of the measured values, and study the distribution of the measurements (@fig-histogramT). We can then see that one of the values is clearly an outlier -- something might have gone wrong there. What if we had done the measurement only once and only measured that value? We might have jumped to a very wrong conclusion, with possibly a very serious consequence like giving the wrong medicine.</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-histogramT</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Histogram of the body temperature measurements. The red line is the mean value, the orange one is the mode and the blue one is the median.</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">T=</span><span class="fu">c</span>(<span class="dv">38</span>, <span class="fl">38.1</span>, <span class="fl">38.0</span>, <span class="fl">38.0</span>, <span class="fl">38.3</span>, <span class="fl">37.9</span>, <span class="fl">38.1</span>, <span class="fl">38.2</span>, <span class="fl">39.8</span>))</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T)) <span class="sc">+</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_histogram</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">38</span>, <span class="at">color=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"T [°C]"</span>)</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>With this example, we see that **a physical measurement is not absolute**. In fact, a physical measurement is an assessment of the **probability** that the physical value is within a certain range. In the case of our example, after removing the outlier for which we are certain that the measurement is wrong, it means that the measured body temperature has a high probability to be somewhere between 38.0 °C and 38.2 °C.</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a>In other (more general) terms, one could consider a measurement of a quantity $X$ as a probability $P(x - \sigma &lt; X &lt; x + \sigma )$ that the quantity $X$ has a value between $x-\sigma$ and $x+\sigma$. The **uncertainty** $\sigma$ around the **mean value** $x$ is usually given as the **standard deviation** of the distribution of measurements around the mean.</span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a>Since physical measurements are in fact **probabilities**, we **can** -- and **must** -- use **statistical tools** to characterize them.</span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantifying the properties of data</span></span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data representation -- presenting a measurement</span></span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>Depending on the data you are looking at, various ways of representing them are possible. I can't stress enough the importance of picking the right representation for your data, it is the expression of your physical sense. A good representation will help you make sense of your data and communicate your results. A bad representation, well...</span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Histograms</span></span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>When looking at discrete values or when you want to characterize the distribution of a measurement, it is often a good idea to use the histogram representation, which represents the frequency at which a measurement is made within a certain range, called bin. Let's take @fig-histogramT and plot it with various bin sizes. One can see that the choice of bin size is important, as it determines whether your data are noisy or lack fine information.</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-histograms</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Histogram of the body temperature measurements with different bin widths.</span></span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Bin width = 0.1 °C"</span></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Bin width = 0.2 °C"</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Bin width = 1 °C"</span></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">T=</span><span class="fu">c</span>(<span class="dv">38</span>, <span class="fl">38.1</span>, <span class="fl">38.0</span>, <span class="fl">38.0</span>, <span class="fl">38.3</span>, <span class="fl">37.9</span>, <span class="fl">38.1</span>, <span class="fl">38.2</span>, <span class="fl">39.8</span>))</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T)) <span class="sc">+</span></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_histogram</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">xintercept =</span> <span class="fu">mean</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">xintercept =</span> <span class="fu">median</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"T [°C]"</span>)</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T)) <span class="sc">+</span></span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_histogram</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">binwidth =</span> <span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">xintercept =</span> <span class="fu">mean</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">size=</span><span class="dv">2</span>, <span class="at">xintercept =</span> <span class="fu">median</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"T [°C]"</span>)</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>temp <span class="sc">%&gt;%</span> </span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> T)) <span class="sc">+</span></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_histogram</span>(<span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">color=</span><span class="st">"black"</span>, <span class="at">binwidth =</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(temp<span class="sc">$</span>T), <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"T [°C]"</span>)</span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Graphs</span></span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true" tabindex="-1"></a>In case you want to represent continuous data, say the evolution of a quantity $y$ with respect to a quantity $x$, you should then use the graph representation. As we saw before, any physical quantity should be given with its uncertainty and unit. **The same applies to a graph**: it **must** clearly display the **units** of the quantities $x$ and $y$, and **error bars** that are usually taken as the standard deviation of each individual measurement (that should thus be performed a number of times, depending on what you are looking at). </span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-graphs</span></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Representing the same datapoints without error bars, with large error bars with respect to the data, and with small error bars with respect to the data: the difference between meaningless data, noise, and meaningful data."</span></span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Meaningless graph"</span></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Noise"</span></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Meaningful graph"</span></span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-139"><a href="#cb9-139" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">1</span>), </span>
<span id="cb9-140"><a href="#cb9-140" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span><span class="dv">1</span><span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">10</span>,<span class="at">sd=</span><span class="dv">5</span>)<span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">58</span>,<span class="at">sd=</span><span class="dv">10</span>)<span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">75</span>,<span class="at">sd=</span><span class="dv">15</span>)<span class="sc">+</span>.<span class="dv">01</span><span class="sc">*</span><span class="fu">runif</span>(<span class="fu">length</span>(x)),</span>
<span id="cb9-141"><a href="#cb9-141" aria-hidden="true" tabindex="-1"></a>              <span class="at">dy1=</span>.<span class="dv">1</span><span class="sc">/</span>y,</span>
<span id="cb9-142"><a href="#cb9-142" aria-hidden="true" tabindex="-1"></a>              <span class="at">dy2=</span>.<span class="dv">1</span><span class="sc">*</span>(y<span class="dv">-1</span>)</span>
<span id="cb9-143"><a href="#cb9-143" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb9-144"><a href="#cb9-144" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-145"><a href="#cb9-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb9-146"><a href="#cb9-146" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb9-147"><a href="#cb9-147" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb9-148"><a href="#cb9-148" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"x"</span>, <span class="at">y=</span><span class="st">"y"</span>)</span>
<span id="cb9-149"><a href="#cb9-149" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-150"><a href="#cb9-150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb9-151"><a href="#cb9-151" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb9-152"><a href="#cb9-152" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>y<span class="sc">-</span>dy1,<span class="at">ymax=</span>y<span class="sc">+</span>dy1))<span class="sc">+</span></span>
<span id="cb9-153"><a href="#cb9-153" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb9-154"><a href="#cb9-154" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"x [unit]"</span>, <span class="at">y=</span><span class="st">"y [unit]"</span>)</span>
<span id="cb9-155"><a href="#cb9-155" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-156"><a href="#cb9-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb9-157"><a href="#cb9-157" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb9-158"><a href="#cb9-158" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>y<span class="sc">-</span>dy2,<span class="at">ymax=</span>y<span class="sc">+</span>dy2))<span class="sc">+</span></span>
<span id="cb9-159"><a href="#cb9-159" aria-hidden="true" tabindex="-1"></a>       <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb9-160"><a href="#cb9-160" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"x [unit]"</span>, <span class="at">y=</span><span class="st">"y [unit]"</span>)</span>
<span id="cb9-161"><a href="#cb9-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-162"><a href="#cb9-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-163"><a href="#cb9-163" aria-hidden="true" tabindex="-1"></a>You can think of each set of {datapoint + error bar} as an histogram: the displayed point is the mean value of the histogram, and the error bar is its standard deviation. **Therefore, plotting a straight line between points is usually pointless**. Plotting a line going through the data points only has meaning if this line results from a physical model explaining the variation of the quantity $y$ with the evolution of the quantity $x$ -- this is called a **fit**, and we will see more about it in the <span class="co">[</span><span class="ot">R class later</span><span class="co">](https://colinbousige.github.io/rclass/14-fitting.html)</span>.</span>
<span id="cb9-164"><a href="#cb9-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-165"><a href="#cb9-165" aria-hidden="true" tabindex="-1"></a><span class="fu">### Characterizing an ensemble of measurements</span></span>
<span id="cb9-166"><a href="#cb9-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-167"><a href="#cb9-167" aria-hidden="true" tabindex="-1"></a>If we take $N$ repeated measurements of an observable $x$, it is then natural to try to assess our knowledge of the ensemble of measures through (1) a single number representing the measured quantity, and (2) a second number representing the spread of measurements. As we saw before, the observable $x$ is thus generally defined by its central (mean) value $\left&lt; x \right&gt;$, its spread $\sigma_x$ (standard deviation or uncertainty), and its unit. </span>
<span id="cb9-168"><a href="#cb9-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-169"><a href="#cb9-169" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Central value: mode, median and mean</span></span>
<span id="cb9-170"><a href="#cb9-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-171"><a href="#cb9-171" aria-hidden="true" tabindex="-1"></a>The **mode** of an ensemble of measurements is its *most frequent value*. If the measurement in question is of a continuous variable, one has to bin the data in terms of a histogram in order to quantify the modal value of that distribution: the mode will be the position of the maximum of the histogram.</span>
<span id="cb9-172"><a href="#cb9-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-173"><a href="#cb9-173" aria-hidden="true" tabindex="-1"></a>The **median** value of the ensemble is the value of $x$ for which there are an equal number of measurements above and below that point. If there is an even number of measurements, then the median value is taken as the midpoint between the two most central values.</span>
<span id="cb9-174"><a href="#cb9-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-175"><a href="#cb9-175" aria-hidden="true" tabindex="-1"></a>The **mean** (or arithmetic average) is more often used than the two previous quantities, as it usually provides a better way to quantify the "typical" value measured. The mean value is denoted either by $\overline{x}$ or $\left&lt; x \right&gt;$, and is given by:</span>
<span id="cb9-176"><a href="#cb9-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-177"><a href="#cb9-177" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-178"><a href="#cb9-178" aria-hidden="true" tabindex="-1"></a>\overline{x}=\left&lt; x \right&gt;=\frac{1}{N}\sum_{i=1}^Nx_i,</span>
<span id="cb9-179"><a href="#cb9-179" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-180"><a href="#cb9-180" aria-hidden="true" tabindex="-1"></a>where $x_i$ is the $i$-th measurement of $x$. </span>
<span id="cb9-181"><a href="#cb9-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-182"><a href="#cb9-182" aria-hidden="true" tabindex="-1"></a>@fig-histogramT shows the representation of a sample of data plotted in a histogram. This figure shows the mode, mean and median. For this particular sample of data, the mean is <span class="in">`r round(mean(temp$T),1)`</span> °C, the median is <span class="in">`r round(median(temp$T),1)`</span> °C, and the mode is 38.0 °C. The fact that the mode is smaller than the mean is an indication that the data are asymmetric about the mean. We usually refer to such a distribution as being skewed, and in this case the data are skewed to the right.</span>
<span id="cb9-183"><a href="#cb9-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-184"><a href="#cb9-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-185"><a href="#cb9-185" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Quantifying the spread of data: variance, standard deviation and standard error</span></span>
<span id="cb9-186"><a href="#cb9-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-187"><a href="#cb9-187" aria-hidden="true" tabindex="-1"></a>The mean of an ensemble of data doesn't provide any information as to how the data are distributed. So any description of a set of data just quoting a mean value is incomplete. We need a second number in order to quantify the dispersion of data around the mean value. The average deviations from the mean, $\left&lt; x-\overline{x} \right&gt;$, is not a useful quantity as, by definition, this will be zero for a symmetrically distributed sample of data (which is always the case for randomly distributed data -- a consequence of the central limit theorem, as we will see later). We should rather consider the average value of the squared deviations from the mean as a measure of the spread of our ensemble of measurements. This is called the **variance** $V(x)$, which is given by:</span>
<span id="cb9-188"><a href="#cb9-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-189"><a href="#cb9-189" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-190"><a href="#cb9-190" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-191"><a href="#cb9-191" aria-hidden="true" tabindex="-1"></a>V(x)&amp;=\left&lt; (x-\overline{x})^2 \right&gt;<span class="sc">\\</span></span>
<span id="cb9-192"><a href="#cb9-192" aria-hidden="true" tabindex="-1"></a>    &amp;=\frac{1}{N}\sum_{i=1}^N(x_i-\overline{x})^2<span class="sc">\\</span></span>
<span id="cb9-193"><a href="#cb9-193" aria-hidden="true" tabindex="-1"></a>    &amp;=\overline{x^2}-\overline{x}^2</span>
<span id="cb9-194"><a href="#cb9-194" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-195"><a href="#cb9-195" aria-hidden="true" tabindex="-1"></a>$$ {#eq-variance}</span>
<span id="cb9-196"><a href="#cb9-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-197"><a href="#cb9-197" aria-hidden="true" tabindex="-1"></a>The square root of the mean-squared (root-mean-squared or RMS) deviation is called the **standard deviation**, and this is given by:</span>
<span id="cb9-198"><a href="#cb9-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-199"><a href="#cb9-199" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-200"><a href="#cb9-200" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-201"><a href="#cb9-201" aria-hidden="true" tabindex="-1"></a>\sigma(x)&amp;=\sqrt{V(x)}<span class="sc">\\</span></span>
<span id="cb9-202"><a href="#cb9-202" aria-hidden="true" tabindex="-1"></a>         &amp;=\sqrt{\overline{x^2}-\overline{x}^2}</span>
<span id="cb9-203"><a href="#cb9-203" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-204"><a href="#cb9-204" aria-hidden="true" tabindex="-1"></a>$$ {#eq-sd}</span>
<span id="cb9-205"><a href="#cb9-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-206"><a href="#cb9-206" aria-hidden="true" tabindex="-1"></a>The standard deviation quantifies the amount by which it is reasonable for a measurement of $x$ to differ from the mean value $\overline{x}$. Considering a Gaussian distribution, we would expect to have 31.7% of measurements deviating from the mean value by more than 1$\sigma$, and this goes down to 4.5% of measurements to deviate by more than 2$\sigma$, and 0.3% of measurements to deviate by more than 3$\sigma$. Thus, if we perform a measurement that deviates by a significant margin from the expected value of $\left&lt; x \right&gt;\pm\sigma$, we need to ask ourselves about the significance of our measurement.</span>
<span id="cb9-207"><a href="#cb9-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-208"><a href="#cb9-208" aria-hidden="true" tabindex="-1"></a>In general, scientists often prefer using the standard deviation rather than the variance when describing data, since as the former has the same units as the observable being measured.</span>
<span id="cb9-209"><a href="#cb9-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-210"><a href="#cb9-210" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-211"><a href="#cb9-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-212"><a href="#cb9-212" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-213"><a href="#cb9-213" aria-hidden="true" tabindex="-1"></a>A measurement of a quantity $x$ is therefore usually presented under the form $\left&lt; x \right&gt;\pm\sigma_x$, where $\left&lt; x \right&gt;$ is the arithmetic average and $\sigma_x$ is the standard deviation of the data.</span>
<span id="cb9-214"><a href="#cb9-214" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-215"><a href="#cb9-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-216"><a href="#cb9-216" aria-hidden="true" tabindex="-1"></a>The **standard error** is defined as the standard deviation of the mean, and is given by:</span>
<span id="cb9-217"><a href="#cb9-217" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-218"><a href="#cb9-218" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-219"><a href="#cb9-219" aria-hidden="true" tabindex="-1"></a>\sigma(\overline{x})=\frac{\sigma(x)}{\sqrt{N}}</span>
<span id="cb9-220"><a href="#cb9-220" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-221"><a href="#cb9-221" aria-hidden="true" tabindex="-1"></a>$$ {#eq-se}</span>
<span id="cb9-222"><a href="#cb9-222" aria-hidden="true" tabindex="-1"></a>where $N$ is the number of measurements. The standard error is a measure of the precision of the mean value $\overline{x}$, and is often used to quantify the uncertainty on the mean value.</span>
<span id="cb9-223"><a href="#cb9-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-224"><a href="#cb9-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-225"><a href="#cb9-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-226"><a href="#cb9-226" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Caveats</span></span>
<span id="cb9-227"><a href="#cb9-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-228"><a href="#cb9-228" aria-hidden="true" tabindex="-1"></a>The above considerations all assume that the distribution of measured values is mono-modal, *i.e.* the histogram of the measured values is centered around a single value. In the case of a multimodal distribution such as shown in @fig-multimodal, it would be meaningless to use such tools as the fine information on the distribution would be lost. </span>
<span id="cb9-229"><a href="#cb9-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-232"><a href="#cb9-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-233"><a href="#cb9-233" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-multimodal</span></span>
<span id="cb9-234"><a href="#cb9-234" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "A trimodal distribution of measurements. The red line shows the mean value of the distribution: it fails to grasp the reality of the distribution."</span></span>
<span id="cb9-235"><a href="#cb9-235" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-236"><a href="#cb9-236" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-237"><a href="#cb9-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-238"><a href="#cb9-238" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">130</span>,.<span class="dv">1</span>), </span>
<span id="cb9-239"><a href="#cb9-239" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">12</span>,<span class="at">sd=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fl">1.5</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">54</span>,<span class="at">sd=</span><span class="dv">10</span>)<span class="sc">+</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">80</span>,<span class="at">sd=</span><span class="dv">12</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-240"><a href="#cb9-240" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">y =</span> y<span class="sc">/</span>(<span class="fu">sum</span>(y)<span class="sc">*</span>.<span class="dv">1</span>))</span>
<span id="cb9-241"><a href="#cb9-241" aria-hidden="true" tabindex="-1"></a>MM <span class="ot">&lt;-</span> <span class="fu">sum</span>(dat<span class="sc">$</span>x<span class="sc">*</span>dat<span class="sc">$</span>y)<span class="sc">*</span>.<span class="dv">1</span></span>
<span id="cb9-242"><a href="#cb9-242" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-243"><a href="#cb9-243" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb9-244"><a href="#cb9-244" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb9-245"><a href="#cb9-245" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> MM, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-246"><a href="#cb9-246" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x [unit]"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span>
<span id="cb9-247"><a href="#cb9-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-248"><a href="#cb9-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-249"><a href="#cb9-249" aria-hidden="true" tabindex="-1"></a>In this case, one should try to deconvolute the distribution in terms of individual peaks, and gather their positions, widths and intensities.</span>
<span id="cb9-250"><a href="#cb9-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-251"><a href="#cb9-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-252"><a href="#cb9-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-253"><a href="#cb9-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## Useful distributions</span></span>
<span id="cb9-254"><a href="#cb9-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-255"><a href="#cb9-255" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probability Density Functions</span></span>
<span id="cb9-256"><a href="#cb9-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-257"><a href="#cb9-257" aria-hidden="true" tabindex="-1"></a>We should now introduce the notion of **Probability Density Function** (PDF). </span>
<span id="cb9-258"><a href="#cb9-258" aria-hidden="true" tabindex="-1"></a>*By definition*, a PDF is a distribution where the **total area is unity**. The variation of the PDF is represents the probability of something occurring at that point in the parameter space.</span>
<span id="cb9-259"><a href="#cb9-259" aria-hidden="true" tabindex="-1"></a>In general, a PDF will be described by some function $P(x)$, where</span>
<span id="cb9-260"><a href="#cb9-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-261"><a href="#cb9-261" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-262"><a href="#cb9-262" aria-hidden="true" tabindex="-1"></a>\int_a^b P(x)dx=1,</span>
<span id="cb9-263"><a href="#cb9-263" aria-hidden="true" tabindex="-1"></a>$$ {#eq-PDFnorm}</span>
<span id="cb9-264"><a href="#cb9-264" aria-hidden="true" tabindex="-1"></a>where $a$ and $b$ are the limits of the valid domain for the $P(x)$ function. The probability of obtaining a result between $x$ and $x + dx$ is thus $P(x)dx$. Usual PDFs encountered in physics are the Poisson distribution as well as the Gaussian distribution, that we will describe in a bit.</span>
<span id="cb9-265"><a href="#cb9-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-266"><a href="#cb9-266" aria-hidden="true" tabindex="-1"></a><span class="fu">### PDFs, mean and variance</span></span>
<span id="cb9-267"><a href="#cb9-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-268"><a href="#cb9-268" aria-hidden="true" tabindex="-1"></a>Let us define a PDF $P(x)$ describing a continuous distribution.</span>
<span id="cb9-269"><a href="#cb9-269" aria-hidden="true" tabindex="-1"></a>We can compute the average value of some quantity by computing the integral over this quantity multiplied by the PDF. </span>
<span id="cb9-270"><a href="#cb9-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-271"><a href="#cb9-271" aria-hidden="true" tabindex="-1"></a>For example, the **average value** of the variable $x$, distributed according to the PDF $P(x)$ in the domain $-\infty &lt; x &lt;\infty$, is given by:</span>
<span id="cb9-272"><a href="#cb9-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-273"><a href="#cb9-273" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-274"><a href="#cb9-274" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-275"><a href="#cb9-275" aria-hidden="true" tabindex="-1"></a>\left&lt; x \right&gt;&amp;=\int_{-\infty}^{\infty}xP(x)dx<span class="sc">\\</span></span>
<span id="cb9-276"><a href="#cb9-276" aria-hidden="true" tabindex="-1"></a>\text{or } \left&lt; x \right&gt;&amp;=\sum_{i}x_iP(x_i) \text{ in the case of a discrete distribution}</span>
<span id="cb9-277"><a href="#cb9-277" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-278"><a href="#cb9-278" aria-hidden="true" tabindex="-1"></a>$$ {#eq-firstmoment}</span>
<span id="cb9-279"><a href="#cb9-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-280"><a href="#cb9-280" aria-hidden="true" tabindex="-1"></a>This is called the *first moment* of the PDF.</span>
<span id="cb9-281"><a href="#cb9-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-282"><a href="#cb9-282" aria-hidden="true" tabindex="-1"></a>This method can be used to compute average values of more complicated expressions. The mean value of $(x - \overline{x})^2$, *i.e.* the variance $V$, is thus given by the $\overline{x}$-centered second moment of the PDF, such as:</span>
<span id="cb9-283"><a href="#cb9-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-284"><a href="#cb9-284" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-285"><a href="#cb9-285" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-286"><a href="#cb9-286" aria-hidden="true" tabindex="-1"></a>V&amp;=\int_{-\infty}^{\infty}(x - \overline{x})^2P(x)dx<span class="sc">\\</span></span>
<span id="cb9-287"><a href="#cb9-287" aria-hidden="true" tabindex="-1"></a>\text{or } V&amp;=\sum_{i}(x_i - \overline{x})^2P(x_i) \text{ in the case of a discrete distribution}</span>
<span id="cb9-288"><a href="#cb9-288" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-289"><a href="#cb9-289" aria-hidden="true" tabindex="-1"></a>$$ {#eq-secondmoment}</span>
<span id="cb9-290"><a href="#cb9-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-291"><a href="#cb9-291" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cumulative Distribution Functions</span></span>
<span id="cb9-292"><a href="#cb9-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-293"><a href="#cb9-293" aria-hidden="true" tabindex="-1"></a>The **Cumulative Distribution Function** (CDF) is defined as the integral of the PDF from $-\infty$ to $x$:</span>
<span id="cb9-294"><a href="#cb9-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-295"><a href="#cb9-295" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-296"><a href="#cb9-296" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-297"><a href="#cb9-297" aria-hidden="true" tabindex="-1"></a>F(x)&amp;=\int_{-\infty}^{x}P(t)dt<span class="sc">\\</span></span>
<span id="cb9-298"><a href="#cb9-298" aria-hidden="true" tabindex="-1"></a>\text{or } F(x)&amp;=\sum_{i}P(x_i) \text{ for a discrete distribution}</span>
<span id="cb9-299"><a href="#cb9-299" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-300"><a href="#cb9-300" aria-hidden="true" tabindex="-1"></a>$$ {#eq-CDF}</span>
<span id="cb9-301"><a href="#cb9-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-302"><a href="#cb9-302" aria-hidden="true" tabindex="-1"></a>It gives the probability of obtaining a value smaller than $x$. The CDF is thus a monotonically increasing function, with $F(-\infty)=0$ and $F(\infty)=1$.</span>
<span id="cb9-303"><a href="#cb9-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-304"><a href="#cb9-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-305"><a href="#cb9-305" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Poisson distribution</span></span>
<span id="cb9-306"><a href="#cb9-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-307"><a href="#cb9-307" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Definition</span></span>
<span id="cb9-308"><a href="#cb9-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-309"><a href="#cb9-309" aria-hidden="true" tabindex="-1"></a>When a certain reaction happens randomly in time with an average frequency $\lambda$ in a given time interval, then the number $k$ of reactions in that time interval will follow a Poisson distribution:</span>
<span id="cb9-310"><a href="#cb9-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-311"><a href="#cb9-311" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-312"><a href="#cb9-312" aria-hidden="true" tabindex="-1"></a>P_\lambda(k) = \frac{\lambda^ke^{-\lambda}}{k!}</span>
<span id="cb9-313"><a href="#cb9-313" aria-hidden="true" tabindex="-1"></a>$$ {#eq-poisson}</span>
<span id="cb9-314"><a href="#cb9-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-315"><a href="#cb9-315" aria-hidden="true" tabindex="-1"></a>Examples of encounters of Poisson distributions could be as various as the number of calls received per hours in a call center, the yearly number of Prussian soldiers killed by horse kicks... or the number of particles (photons, neutrons, neutrinos...) hitting a detector every second.</span>
<span id="cb9-316"><a href="#cb9-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-317"><a href="#cb9-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-320"><a href="#cb9-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-321"><a href="#cb9-321" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-poissondistrib</span></span>
<span id="cb9-322"><a href="#cb9-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Poisson distribution for various parameters. While asymmetric for small values of $k$ and $\\lambda$, it tends towards a Gaussian lineshape at larger values."</span></span>
<span id="cb9-323"><a href="#cb9-323" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb9-324"><a href="#cb9-324" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - " "</span></span>
<span id="cb9-325"><a href="#cb9-325" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - " "</span></span>
<span id="cb9-326"><a href="#cb9-326" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - " "</span></span>
<span id="cb9-327"><a href="#cb9-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-328"><a href="#cb9-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-329"><a href="#cb9-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-330"><a href="#cb9-330" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb9-331"><a href="#cb9-331" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="cf">function</span>(lam, k) {</span>
<span id="cb9-332"><a href="#cb9-332" aria-hidden="true" tabindex="-1"></a>    lam<span class="sc">^</span>k<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lam)<span class="sc">/</span><span class="fu">factorial</span>(k)</span>
<span id="cb9-333"><a href="#cb9-333" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-334"><a href="#cb9-334" aria-hidden="true" tabindex="-1"></a>P2 <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, k) {</span>
<span id="cb9-335"><a href="#cb9-335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">lam =</span> lambda, <span class="at">poisson =</span> lambda<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lam) <span class="sc">/</span> <span class="fu">factorial</span>(k))</span>
<span id="cb9-336"><a href="#cb9-336" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-337"><a href="#cb9-337" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">k=</span><span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">4</span>), </span>
<span id="cb9-338"><a href="#cb9-338" aria-hidden="true" tabindex="-1"></a>              <span class="at">lam=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>), <span class="at">each=</span><span class="dv">11</span>),</span>
<span id="cb9-339"><a href="#cb9-339" aria-hidden="true" tabindex="-1"></a>              <span class="at">poisson=</span><span class="fu">P</span>(lam,k))</span>
<span id="cb9-340"><a href="#cb9-340" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">k=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb9-341"><a href="#cb9-341" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">poisson=</span><span class="fu">map</span>(k, <span class="sc">~</span><span class="fu">P2</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,.<span class="dv">1</span>), .))) <span class="sc">%&gt;%</span> </span>
<span id="cb9-342"><a href="#cb9-342" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest</span>(poisson)</span>
<span id="cb9-343"><a href="#cb9-343" aria-hidden="true" tabindex="-1"></a>dat3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">k =</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-344"><a href="#cb9-344" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">poisson =</span> <span class="fu">map</span>(k, <span class="sc">~</span> <span class="fu">P2</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">200</span>, .<span class="dv">1</span>), .))) <span class="sc">%&gt;%</span></span>
<span id="cb9-345"><a href="#cb9-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(poisson)</span>
<span id="cb9-346"><a href="#cb9-346" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-347"><a href="#cb9-347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> poisson, <span class="at">color=</span><span class="fu">factor</span>(lam))) <span class="sc">+</span></span>
<span id="cb9-348"><a href="#cb9-348" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb9-349"><a href="#cb9-349" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">color=</span><span class="fu">expression</span>(lambda), </span>
<span id="cb9-350"><a href="#cb9-350" aria-hidden="true" tabindex="-1"></a>            <span class="at">x=</span><span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"k"</span>)), </span>
<span id="cb9-351"><a href="#cb9-351" aria-hidden="true" tabindex="-1"></a>            <span class="at">y=</span><span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"P"</span>)[lambda]<span class="sc">*</span>(<span class="fu">italic</span>(<span class="st">"k"</span>))))<span class="sc">+</span></span>
<span id="cb9-352"><a href="#cb9-352" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))</span>
<span id="cb9-353"><a href="#cb9-353" aria-hidden="true" tabindex="-1"></a>dat2 <span class="sc">%&gt;%</span> </span>
<span id="cb9-354"><a href="#cb9-354" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lam, <span class="at">y =</span> poisson, <span class="at">color=</span><span class="fu">factor</span>(k))) <span class="sc">+</span></span>
<span id="cb9-355"><a href="#cb9-355" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb9-356"><a href="#cb9-356" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">color =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"k"</span>)), </span>
<span id="cb9-357"><a href="#cb9-357" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">expression</span>(lambda), </span>
<span id="cb9-358"><a href="#cb9-358" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"P"</span>)[lambda] <span class="sc">*</span> (<span class="fu">italic</span>(<span class="st">"k"</span>))))<span class="sc">+</span></span>
<span id="cb9-359"><a href="#cb9-359" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))</span>
<span id="cb9-360"><a href="#cb9-360" aria-hidden="true" tabindex="-1"></a>dat3 <span class="sc">%&gt;%</span> </span>
<span id="cb9-361"><a href="#cb9-361" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lam, <span class="at">y =</span> poisson, <span class="at">color=</span><span class="fu">factor</span>(k))) <span class="sc">+</span></span>
<span id="cb9-362"><a href="#cb9-362" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb9-363"><a href="#cb9-363" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb9-364"><a href="#cb9-364" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">color =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"k"</span>)), </span>
<span id="cb9-365"><a href="#cb9-365" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fu">expression</span>(lambda), </span>
<span id="cb9-366"><a href="#cb9-366" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(<span class="st">"P"</span>)[lambda] <span class="sc">*</span> (<span class="fu">italic</span>(<span class="st">"k"</span>))))<span class="sc">+</span></span>
<span id="cb9-367"><a href="#cb9-367" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">35</span>), <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">25</span>))</span>
<span id="cb9-368"><a href="#cb9-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-369"><a href="#cb9-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-370"><a href="#cb9-370" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="minimal"}</span>
<span id="cb9-371"><a href="#cb9-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-372"><a href="#cb9-372" aria-hidden="true" tabindex="-1"></a>In R, the Poisson distribution is implemented in the <span class="in">`dpois(x, lambda)`</span>{.R} function. The <span class="in">`x`</span> argument is the number of events, and <span class="in">`lambda`</span> is the average number of events. The <span class="in">`ppois(x, lambda)`</span>{.R} function gives the cumulative probability of observing less than <span class="in">`x`</span> events.</span>
<span id="cb9-373"><a href="#cb9-373" aria-hidden="true" tabindex="-1"></a>The <span class="in">`qpois(p, lambda)`</span>{.R} function gives the number of events <span class="in">`x`</span> for which the cumulative probability is <span class="in">`p`</span>. Finally, the <span class="in">`rpois(n, lambda)`</span>{.R} function generates <span class="in">`n`</span> random numbers following a Poisson distribution with average <span class="in">`lambda`</span>.</span>
<span id="cb9-374"><a href="#cb9-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-375"><a href="#cb9-375" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-376"><a href="#cb9-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-377"><a href="#cb9-377" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Characteristics</span></span>
<span id="cb9-378"><a href="#cb9-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-379"><a href="#cb9-379" aria-hidden="true" tabindex="-1"></a>As shown on @fig-poissondistrib, for small $\lambda$ the distribution is asymmetric and skewed to the right. As $\lambda$ increases the Poisson distribution becomes more symmetric.</span>
<span id="cb9-380"><a href="#cb9-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-381"><a href="#cb9-381" aria-hidden="true" tabindex="-1"></a>Following @eq-firstmoment, the average number of observed events, $\left&lt; k \right&gt;$, is given by:</span>
<span id="cb9-382"><a href="#cb9-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-383"><a href="#cb9-383" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-384"><a href="#cb9-384" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-385"><a href="#cb9-385" aria-hidden="true" tabindex="-1"></a>\left&lt; k \right&gt; &amp;= \sum_{k=0}^\infty kP_\lambda(k) = \sum_{k=1}^\infty k\frac{\lambda^ke^{-\lambda}}{k!}<span class="sc">\\</span></span>
<span id="cb9-386"><a href="#cb9-386" aria-hidden="true" tabindex="-1"></a>        &amp;= \lambda e^{-\lambda} \sum_{k=1}^\infty \frac{\lambda^{k-1}}{(k-1)!}= \lambda e^{-\lambda} \sum_{k=0}^\infty \frac{\lambda^{k}}{k!}<span class="sc">\\</span></span>
<span id="cb9-387"><a href="#cb9-387" aria-hidden="true" tabindex="-1"></a>        &amp;= \lambda</span>
<span id="cb9-388"><a href="#cb9-388" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-389"><a href="#cb9-389" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-390"><a href="#cb9-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-391"><a href="#cb9-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-392"><a href="#cb9-392" aria-hidden="true" tabindex="-1"></a>In the same manner and by using the "trick" $x^2=x(x-1)+x$, the variance $\sigma^2(k)$ of the distribution is given by:</span>
<span id="cb9-393"><a href="#cb9-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-394"><a href="#cb9-394" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-395"><a href="#cb9-395" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-396"><a href="#cb9-396" aria-hidden="true" tabindex="-1"></a>\sigma^2(k) &amp;= \sum_{k=1}^\infty (k-\lambda)^2\frac{\lambda^k e^{-\lambda}}{k!}<span class="sc">\\</span></span>
<span id="cb9-397"><a href="#cb9-397" aria-hidden="true" tabindex="-1"></a>        &amp;= \lambda e^{-\lambda} \left<span class="co">[</span><span class="ot">\sum_{k=1}^\infty k^2\frac{\lambda^{k-1}}{k!} \underbrace{-2\lambda\sum_{k=1}^\infty \frac{\lambda^{k-1}}{(k-1)!}}_{-2\lambda e^\lambda}+\underbrace{\sum_{k=1}^\infty \lambda^2\frac{\lambda^{k-1}}{k!}}_{\lambda e^\lambda}\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb9-398"><a href="#cb9-398" aria-hidden="true" tabindex="-1"></a>        &amp;= \lambda e^{-\lambda} \left<span class="co">[</span><span class="ot"> \underbrace{\sum_{k=2}^\infty k(k-1)\frac{\lambda^{k-1}}{k!}}_{\lambda e^\lambda} + \underbrace{\sum_{k=1}^\infty k\frac{\lambda^{k-1}}{k!}}_{e^\lambda} - \lambda e^\lambda\right</span><span class="co">]</span><span class="sc">\\</span></span>
<span id="cb9-399"><a href="#cb9-399" aria-hidden="true" tabindex="-1"></a>        &amp;=\lambda = \left&lt; k \right&gt;</span>
<span id="cb9-400"><a href="#cb9-400" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-401"><a href="#cb9-401" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-402"><a href="#cb9-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-403"><a href="#cb9-403" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-404"><a href="#cb9-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-405"><a href="#cb9-405" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-406"><a href="#cb9-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-407"><a href="#cb9-407" aria-hidden="true" tabindex="-1"></a>The important result here is that, **when counting random events with an average of** $\left&lt; N \right&gt;$, **the standard deviation is** $\sigma=\sqrt{\left&lt; N \right&gt;}$. This is typically what happens when performing a diffraction or spectroscopic measurement, such as X-ray diffraction, Raman, IR or neutron spectroscopy, etc.: the longer we acquire data, the higher the number of detected "events" $N$ (particle hits detector), and the "better is the statistics". Indeed, the relative error is thus $\sqrt{N}/N=1/\sqrt{N}$. </span>
<span id="cb9-408"><a href="#cb9-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-409"><a href="#cb9-409" aria-hidden="true" tabindex="-1"></a>The consequence of this is that to make a factor 10 improvement on the relative error, one has to increase by 100 the number of events. This is usually done by increasing the acquisition time, which is fine as long as it is short enough. If irrealistic acquisition times start to become necessary, one should maybe try to find another way to increase $N$: this can be done by improving the detector efficiency, increasing the probe (laser, neutron/x-ray) brightness, changing the experimental geometry, etc.</span>
<span id="cb9-410"><a href="#cb9-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-411"><a href="#cb9-411" aria-hidden="true" tabindex="-1"></a>Finally, for "large" numbers ($\lambda\gtrsim 100$) the Poisson distribution tends towards a symmetric Gaussian distribution that we will describe just after. </span>
<span id="cb9-412"><a href="#cb9-412" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-413"><a href="#cb9-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-414"><a href="#cb9-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-415"><a href="#cb9-415" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Gaussian distribution</span></span>
<span id="cb9-416"><a href="#cb9-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-417"><a href="#cb9-417" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Definition</span></span>
<span id="cb9-418"><a href="#cb9-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-419"><a href="#cb9-419" aria-hidden="true" tabindex="-1"></a>The Gaussian distribution, also known as the *normal distribution*, with a mean value $\mu$ and standard deviation $\sigma$ as a function of some variable $x$ is given by:</span>
<span id="cb9-420"><a href="#cb9-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-421"><a href="#cb9-421" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-422"><a href="#cb9-422" aria-hidden="true" tabindex="-1"></a>P(x, \mu, \sigma)=\frac{1}{\sigma\sqrt{2\pi}}e^{-(x-\mu)^2/2\sigma^2}</span>
<span id="cb9-423"><a href="#cb9-423" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-424"><a href="#cb9-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-425"><a href="#cb9-425" aria-hidden="true" tabindex="-1"></a>It is useful to transform data from the $x$ space to a corresponding $z$ space which has a mean value of zero, and a standard deviation of one. This transformation is given by the mapping $z=\frac{x-\mu}{\sigma}$, and the Gaussian distribution in terms of $z$ is thus:</span>
<span id="cb9-426"><a href="#cb9-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-427"><a href="#cb9-427" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-428"><a href="#cb9-428" aria-hidden="true" tabindex="-1"></a>P(z)=\frac{1}{\sqrt{2\pi}}e^{-z^2/2}</span>
<span id="cb9-429"><a href="#cb9-429" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-430"><a href="#cb9-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-431"><a href="#cb9-431" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="minimal"}</span>
<span id="cb9-432"><a href="#cb9-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-433"><a href="#cb9-433" aria-hidden="true" tabindex="-1"></a>In R, the Gaussian distribution is implemented in the function <span class="in">`dnorm(x, mean=0, sd=1)`</span>{.R}. The function <span class="in">`pnorm(x, mean=0, sd=1)`</span>{.R} gives the cumulative distribution function (CDF), *i.e.* the probability that a random variable $X$ is less than or equal to $x$. The function `qnorm(p, mean=0, sd=1)`{.R} gives the quantile function, *i.e.* the value of $x$ for which the CDF is equal to $p$.</span>
<span id="cb9-434"><a href="#cb9-434" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-435"><a href="#cb9-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-436"><a href="#cb9-436" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Characteristics</span></span>
<span id="cb9-437"><a href="#cb9-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-440"><a href="#cb9-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-441"><a href="#cb9-441" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gaussian</span></span>
<span id="cb9-442"><a href="#cb9-442" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "A zero-centered Gaussian distribution with standard deviation of 1, $P(z)$. The red line marks the half maximum, $P(z_{HM})=1/2\\sqrt{2\\pi}$, and the blue lines the values of $z$ for which the half maximum is obtained, $z_{HM}=\\pm\\sqrt{2\\ln{2}}$."</span></span>
<span id="cb9-443"><a href="#cb9-443" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-444"><a href="#cb9-444" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-445"><a href="#cb9-445" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-446"><a href="#cb9-446" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,.<span class="dv">1</span>), <span class="at">y=</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi))</span>
<span id="cb9-447"><a href="#cb9-447" aria-hidden="true" tabindex="-1"></a>seg1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)),<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>))),</span>
<span id="cb9-448"><a href="#cb9-448" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)))</span>
<span id="cb9-449"><a href="#cb9-449" aria-hidden="true" tabindex="-1"></a>seg2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="sc">-</span><span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)),<span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>))),</span>
<span id="cb9-450"><a href="#cb9-450" aria-hidden="true" tabindex="-1"></a>               <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)))</span>
<span id="cb9-451"><a href="#cb9-451" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-452"><a href="#cb9-452" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb9-453"><a href="#cb9-453" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb9-454"><a href="#cb9-454" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"z"</span>, <span class="at">y=</span><span class="st">"P(z)"</span>)<span class="sc">+</span></span>
<span id="cb9-455"><a href="#cb9-455" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi), <span class="at">col=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb9-456"><a href="#cb9-456" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">data=</span>seg2, <span class="at">col=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-457"><a href="#cb9-457" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">data=</span>seg1, <span class="at">col=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-458"><a href="#cb9-458" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)), <span class="at">y =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="dv">2</span>, </span>
<span id="cb9-459"><a href="#cb9-459" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xend =</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)), <span class="at">yend =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="dv">2</span>),</span>
<span id="cb9-460"><a href="#cb9-460" aria-hidden="true" tabindex="-1"></a>            <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb9-461"><a href="#cb9-461" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> .<span class="dv">115</span>, <span class="at">label=</span><span class="st">"FWHM"</span>)<span class="sc">+</span></span>
<span id="cb9-462"><a href="#cb9-462" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="dv">4</span>, </span>
<span id="cb9-463"><a href="#cb9-463" aria-hidden="true" tabindex="-1"></a>                         <span class="at">xend =</span> <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)), <span class="at">yend =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">/</span><span class="dv">4</span>),</span>
<span id="cb9-464"><a href="#cb9-464" aria-hidden="true" tabindex="-1"></a>            <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb9-465"><a href="#cb9-465" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> .<span class="dv">6</span>, <span class="at">y =</span> .<span class="dv">065</span>, <span class="at">label=</span><span class="st">"HWHM"</span>)</span>
<span id="cb9-466"><a href="#cb9-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-467"><a href="#cb9-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-468"><a href="#cb9-468" aria-hidden="true" tabindex="-1"></a>Sometimes instead of quantifying a Gaussian distribution (or any monomodal distribution, for that matter) using the variance or standard deviation, scientists will speak about the full width at half maximum (**FWHM**). </span>
<span id="cb9-469"><a href="#cb9-469" aria-hidden="true" tabindex="-1"></a>This has the advantage that any extreme outliers of the distribution do not contribute to the quantification of the spread of data. As the name suggests, the FWHM is the width of the distribution (the spread above and below the mean) at the points where the distribution reaches half of its maximum. You can also encounter the HWHM = FWHM/2, the Half Width at Half Maximum.</span>
<span id="cb9-470"><a href="#cb9-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-471"><a href="#cb9-471" aria-hidden="true" tabindex="-1"></a>For a Gaussian distribution $P(z)$, the half maximum is attained when $z_{HM}$ is so that:</span>
<span id="cb9-472"><a href="#cb9-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-473"><a href="#cb9-473" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-474"><a href="#cb9-474" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-475"><a href="#cb9-475" aria-hidden="true" tabindex="-1"></a>\frac{1}{\sqrt{2\pi}}e^{-z_{HM}^2/2}&amp;= \frac{1}{2}\frac{1}{\sqrt{2\pi}}<span class="sc">\\</span></span>
<span id="cb9-476"><a href="#cb9-476" aria-hidden="true" tabindex="-1"></a>\Rightarrow z_{HM}&amp;=\pm\sqrt{2\ln{2}}</span>
<span id="cb9-477"><a href="#cb9-477" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-478"><a href="#cb9-478" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-479"><a href="#cb9-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-480"><a href="#cb9-480" aria-hidden="true" tabindex="-1"></a>The FWHM of $P(z)$ is therefore $FWHM=2\sqrt{2\ln{2}}\simeq2.355$. Using the relation between $z$ and $\sigma$, we get the relation between the FWHM and the standard deviation:</span>
<span id="cb9-481"><a href="#cb9-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-482"><a href="#cb9-482" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-483"><a href="#cb9-483" aria-hidden="true" tabindex="-1"></a>FWHM=2\sqrt{2\ln{2}}\times\sigma</span>
<span id="cb9-484"><a href="#cb9-484" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-485"><a href="#cb9-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-486"><a href="#cb9-486" aria-hidden="true" tabindex="-1"></a>As can be seen on @tbl-tablevalues, using the FWHM ensures that roughly 76% of the data are comprised between $\mu-HWHM$ and $\mu+HWHM$, and this goes up to $\sim95$% for the range $<span class="co">[</span><span class="ot">\mu-2\sigma, \mu+2\sigma</span><span class="co">]</span>$.</span>
<span id="cb9-487"><a href="#cb9-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-490"><a href="#cb9-490" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-491"><a href="#cb9-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tablevalues</span></span>
<span id="cb9-492"><a href="#cb9-492" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Integral values for various values of $a$ in $\\int_{-a}^aP(z)dz$."</span></span>
<span id="cb9-493"><a href="#cb9-493" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-494"><a href="#cb9-494" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-495"><a href="#cb9-495" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-496"><a href="#cb9-496" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,.<span class="dv">001</span>)</span>
<span id="cb9-497"><a href="#cb9-497" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb9-498"><a href="#cb9-498" aria-hidden="true" tabindex="-1"></a>integral <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">a=</span><span class="dv">1</span>) {</span>
<span id="cb9-499"><a href="#cb9-499" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sprintf</span>(<span class="st">"%.5f"</span>, <span class="fu">sum</span>(y[<span class="fu">abs</span>(x) <span class="sc">&lt;=</span> a] <span class="sc">*</span> (x[<span class="dv">2</span>] <span class="sc">-</span> x[<span class="dv">1</span>])))</span>
<span id="cb9-500"><a href="#cb9-500" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-501"><a href="#cb9-501" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">`</span><span class="at">Integration range $a$</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">sigma$"</span>, <span class="st">"$HWHM=</span><span class="sc">\\</span><span class="st">sqrt{2</span><span class="sc">\\</span><span class="st">ln{2}}</span><span class="sc">\\</span><span class="st">sigma$"</span>, <span class="st">"$1.96</span><span class="sc">\\</span><span class="st">sigma$"</span>, <span class="st">"$2</span><span class="sc">\\</span><span class="st">sigma$"</span>, <span class="st">"$3</span><span class="sc">\\</span><span class="st">sigma$"</span>, <span class="st">"$4</span><span class="sc">\\</span><span class="st">sigma$"</span>),</span>
<span id="cb9-502"><a href="#cb9-502" aria-hidden="true" tabindex="-1"></a>       <span class="st">`</span><span class="at">$</span><span class="sc">\\</span><span class="at">int_{-a}^aP(z)dz$</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">integral</span>(x, <span class="at">a =</span> <span class="dv">1</span>), <span class="fu">integral</span>(x, <span class="at">a =</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span>))), <span class="fu">integral</span>(x, <span class="at">a =</span> <span class="fl">1.96</span>), <span class="fu">integral</span>(x, <span class="at">a =</span> <span class="dv">2</span>), <span class="fu">integral</span>(x, <span class="at">a =</span> <span class="dv">3</span>), <span class="fu">integral</span>(x, <span class="at">a =</span> <span class="dv">4</span>))</span>
<span id="cb9-503"><a href="#cb9-503" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb9-504"><a href="#cb9-504" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(dat,<span class="at">format =</span> <span class="st">"markdown"</span>)</span>
<span id="cb9-505"><a href="#cb9-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-506"><a href="#cb9-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-507"><a href="#cb9-507" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-508"><a href="#cb9-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-509"><a href="#cb9-509" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-510"><a href="#cb9-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-511"><a href="#cb9-511" aria-hidden="true" tabindex="-1"></a>You can see from @tbl-tablevalues that if you want to make sure that exactly 95% of your data will fall in the given range, *i.e.* which defines the **95% tolerence interval**, you need to use a range of $1.96\sigma$.</span>
<span id="cb9-512"><a href="#cb9-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-513"><a href="#cb9-513" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-514"><a href="#cb9-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-515"><a href="#cb9-515" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Student's t-distribution</span></span>
<span id="cb9-516"><a href="#cb9-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-517"><a href="#cb9-517" aria-hidden="true" tabindex="-1"></a>The Student's t-distribution (or simply, "t-distribution") is a probability distribution that is used to estimate population parameters **when the sample size is small** and/or when the population variance is unknown. </span>
<span id="cb9-518"><a href="#cb9-518" aria-hidden="true" tabindex="-1"></a>It is a bell-shaped distribution that is symmetrical about the mean, showing that data near the mean are more frequent in occurrence than data far from the mean. </span>
<span id="cb9-519"><a href="#cb9-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-520"><a href="#cb9-520" aria-hidden="true" tabindex="-1"></a>The t-distribution is used in place of the normal distribution when dealing with small samples ($N &lt; 30$) or when the population standard deviation is unknown.</span>
<span id="cb9-521"><a href="#cb9-521" aria-hidden="true" tabindex="-1"></a>Its shape is similar to the normal distribution but it has heavier tails, meaning that it is more prone to producing values that fall far from its mean.</span>
<span id="cb9-522"><a href="#cb9-522" aria-hidden="true" tabindex="-1"></a>It has the following PDF formula:</span>
<span id="cb9-523"><a href="#cb9-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-524"><a href="#cb9-524" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-525"><a href="#cb9-525" aria-hidden="true" tabindex="-1"></a>P(x, \nu)=\frac{\Gamma\left(\frac{\nu+1}{2}\right)}{\sqrt{\nu\pi}\Gamma\left(\frac{\nu}{2}\right)}\left(1+\frac{x^2}{\nu}\right)^{-\frac{\nu+1}{2}}</span>
<span id="cb9-526"><a href="#cb9-526" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-527"><a href="#cb9-527" aria-hidden="true" tabindex="-1"></a>where $\Gamma$ is the <span class="co">[</span><span class="ot">gamma function</span><span class="co">](https://en.wikipedia.org/wiki/Gamma_function)</span> and $\nu$ is the number of degrees of freedom defined as $\nu=N-1$.</span>
<span id="cb9-528"><a href="#cb9-528" aria-hidden="true" tabindex="-1"></a>For large number of observations, the t-distribution converges to the normal distribution.</span>
<span id="cb9-529"><a href="#cb9-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-530"><a href="#cb9-530" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="minimal"}</span>
<span id="cb9-531"><a href="#cb9-531" aria-hidden="true" tabindex="-1"></a>In R, the t-distribution is implemented in the function <span class="in">`dt(x, df)`</span>{.R} where <span class="in">`x`</span> is the vector of quantiles and <span class="in">`df`</span> is the number of degrees of freedom. The <span class="in">`qt(p, df)`</span>{.R} function returns the quantiles $q$ of the t-distribution such that $P(X\leq q)=p$.</span>
<span id="cb9-532"><a href="#cb9-532" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-533"><a href="#cb9-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-536"><a href="#cb9-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-537"><a href="#cb9-537" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-538"><a href="#cb9-538" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-t-distribution</span></span>
<span id="cb9-539"><a href="#cb9-539" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-540"><a href="#cb9-540" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-541"><a href="#cb9-541" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The t-distribution for various degrees of freedom compared to the Gaussian distribution."</span></span>
<span id="cb9-542"><a href="#cb9-542" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: "center"</span></span>
<span id="cb9-543"><a href="#cb9-543" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,.<span class="dv">01</span>))</span>
<span id="cb9-544"><a href="#cb9-544" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"royalblue"</span>,<span class="st">"seagreen"</span>,<span class="st">"orange"</span>,<span class="st">"red"</span>))</span>
<span id="cb9-545"><a href="#cb9-545" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-546"><a href="#cb9-546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb9-547"><a href="#cb9-547" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">dnorm</span>(x), <span class="at">color=</span><span class="st">"Gaussian"</span>), <span class="at">linewidth=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb9-548"><a href="#cb9-548" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">1</span>), <span class="at">color=</span><span class="st">"1"</span>), <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-549"><a href="#cb9-549" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">2</span>), <span class="at">color=</span><span class="st">"2"</span>), <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-550"><a href="#cb9-550" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">3</span>), <span class="at">color=</span><span class="st">"3"</span>), <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-551"><a href="#cb9-551" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">30</span>), <span class="at">color=</span><span class="st">"30"</span>), <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-552"><a href="#cb9-552" aria-hidden="true" tabindex="-1"></a>       <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">colors</span>(<span class="dv">4</span>), <span class="st">"gray"</span>))<span class="sc">+</span></span>
<span id="cb9-553"><a href="#cb9-553" aria-hidden="true" tabindex="-1"></a>       <span class="fu">labs</span>(<span class="at">color=</span><span class="fu">TeX</span>(r<span class="st">'($</span><span class="sc">\n</span><span class="st">u$)'</span>), <span class="at">y=</span><span class="st">"Density"</span>, <span class="at">x=</span><span class="st">"x"</span>)</span>
<span id="cb9-554"><a href="#cb9-554" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-555"><a href="#cb9-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-556"><a href="#cb9-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-557"><a href="#cb9-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-558"><a href="#cb9-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-559"><a href="#cb9-559" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tolerence interval and confidence interval</span></span>
<span id="cb9-560"><a href="#cb9-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-561"><a href="#cb9-561" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Tolerance interval {#sec-tolerence-interval}</span></span>
<span id="cb9-562"><a href="#cb9-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-563"><a href="#cb9-563" aria-hidden="true" tabindex="-1"></a>A **tolerance interval** is a range of values that is likely to contain a certain proportion of the population. </span>
<span id="cb9-564"><a href="#cb9-564" aria-hidden="true" tabindex="-1"></a>It is thus representative of the spread of data in the population, and it is usually given by the standard deviation $\sigma$ multiplied by a **confidence level** factor.</span>
<span id="cb9-565"><a href="#cb9-565" aria-hidden="true" tabindex="-1"></a>As seen in @tbl-tablevalues, for a Gaussian distribution, the range $<span class="co">[</span><span class="ot">\mu-1.96\sigma, \mu+1.96\sigma</span><span class="co">]</span>$ contains roughly 95% of the data in the population, and this is the **95% tolerence interval**.</span>
<span id="cb9-566"><a href="#cb9-566" aria-hidden="true" tabindex="-1"></a>It means that if you draw a sample of data from the population, the probability that the data points of the sample will fall in this range is 95%.</span>
<span id="cb9-567"><a href="#cb9-567" aria-hidden="true" tabindex="-1"></a>If your distribution population is small however ($N&lt;30$), you should use the t-distribution instead of the Gaussian distribution to compute the tolerence interval.</span>
<span id="cb9-568"><a href="#cb9-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-571"><a href="#cb9-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-572"><a href="#cb9-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-tolerenceinterval</span></span>
<span id="cb9-573"><a href="#cb9-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-574"><a href="#cb9-574" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-575"><a href="#cb9-575" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-576"><a href="#cb9-576" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The 95% tolerence interval for a Gaussian distribution."</span></span>
<span id="cb9-577"><a href="#cb9-577" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-align: "center"</span></span>
<span id="cb9-578"><a href="#cb9-578" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,.<span class="dv">01</span>), <span class="at">y =</span> <span class="fu">dnorm</span>(x))</span>
<span id="cb9-579"><a href="#cb9-579" aria-hidden="true" tabindex="-1"></a>xlow <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.025</span>)</span>
<span id="cb9-580"><a href="#cb9-580" aria-hidden="true" tabindex="-1"></a>xhi <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb9-581"><a href="#cb9-581" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb9-582"><a href="#cb9-582" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb9-583"><a href="#cb9-583" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb9-584"><a href="#cb9-584" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_area</span>(<span class="at">data=</span>dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x<span class="sc">&lt;=</span>xlow), <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">fill=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-585"><a href="#cb9-585" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_area</span>(<span class="at">data=</span>dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(x<span class="sc">&gt;=</span>xhi), <span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">fill=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-586"><a href="#cb9-586" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb9-587"><a href="#cb9-587" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Density"</span>, <span class="at">x=</span><span class="st">"x"</span>)<span class="sc">+</span></span>
<span id="cb9-588"><a href="#cb9-588" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> xlow<span class="fl">-.75</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="st">"2.5%"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-589"><a href="#cb9-589" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> xhi<span class="fl">+.75</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">label =</span> <span class="st">"2.5%"</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-590"><a href="#cb9-590" aria-hidden="true" tabindex="-1"></a>        <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.15</span>, <span class="at">label =</span> <span class="st">"95%"</span>, <span class="at">size =</span> <span class="dv">13</span>)</span>
<span id="cb9-591"><a href="#cb9-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-592"><a href="#cb9-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-593"><a href="#cb9-593" aria-hidden="true" tabindex="-1"></a>In R, you would use the <span class="in">`qt(p, df)`</span>{.R} (for a t-distribution) or <span class="in">`qnorm(p)`</span>{.R} (for a Gaussian distribution) functions to compute the quantiles $q$ such that $P(X\leq q)=p$.</span>
<span id="cb9-594"><a href="#cb9-594" aria-hidden="true" tabindex="-1"></a>If you want to compute the **95% tolerence interval** for a distribution, you need to compute the quantiles $q$ such that $P(X\leq q)=0.025$ and $P(X\leq q)=0.975$, *i.e.* find the values below and above which 2.5% of the distribtution are left out, as shown in @fig-tolerenceinterval. </span>
<span id="cb9-595"><a href="#cb9-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-596"><a href="#cb9-596" aria-hidden="true" tabindex="-1"></a>Since both the Gaussian and t-distributions are symmetric, the tolerence interval is given by $<span class="co">[</span><span class="ot">q, -q</span><span class="co">]</span>$: for a tolerance interval with *tolerence level* $\alpha$, you want the quantile for the probability $p=(1+\alpha)/2$.</span>
<span id="cb9-597"><a href="#cb9-597" aria-hidden="true" tabindex="-1"></a>Some special values are gathered in @tbl-tolerenceinterval.</span>
<span id="cb9-598"><a href="#cb9-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-599"><a href="#cb9-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-602"><a href="#cb9-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-603"><a href="#cb9-603" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-tolerenceinterval</span></span>
<span id="cb9-604"><a href="#cb9-604" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-605"><a href="#cb9-605" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Quantiles of the t- and Gaussian distributions for various degrees of freedom ($\\nu$) and tolerence levels ($\\alpha$)."</span></span>
<span id="cb9-606"><a href="#cb9-606" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">30</span>, <span class="cn">Inf</span>)</span>
<span id="cb9-607"><a href="#cb9-607" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">8</span>, .<span class="dv">9</span>, .<span class="dv">95</span>, .<span class="dv">99</span>, .<span class="dv">999</span>)</span>
<span id="cb9-608"><a href="#cb9-608" aria-hidden="true" tabindex="-1"></a><span class="fu">expand_grid</span>(<span class="st">`</span><span class="at">$</span><span class="sc">\\</span><span class="at">nu$</span><span class="st">`</span><span class="ot">=</span>nu, <span class="at">P=</span>P) <span class="sc">%&gt;%</span> </span>
<span id="cb9-609"><a href="#cb9-609" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Q=</span><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>P)<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span><span class="st">`</span><span class="at">$</span><span class="sc">\\</span><span class="at">nu$</span><span class="st">`</span>),</span>
<span id="cb9-610"><a href="#cb9-610" aria-hidden="true" tabindex="-1"></a>           <span class="st">`</span><span class="at">$</span><span class="sc">\\</span><span class="at">nu$</span><span class="st">`</span><span class="ot">=</span><span class="fu">as.character</span>(<span class="st">`</span><span class="at">$</span><span class="sc">\\</span><span class="at">nu$</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-611"><a href="#cb9-611" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="st">`</span><span class="at">$</span><span class="sc">\\</span><span class="at">nu$</span><span class="st">`</span><span class="ot">=</span><span class="st">"Gaussian"</span>, <span class="at">P=</span>P, <span class="at">Q=</span><span class="fu">qnorm</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>P)<span class="sc">/</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb9-612"><a href="#cb9-612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">P=</span>glue<span class="sc">::</span><span class="fu">glue</span>(r<span class="st">"($</span><span class="sc">\a</span><span class="st">lpha$: {P*100}%)"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-613"><a href="#cb9-613" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>P, <span class="at">values_from=</span>Q) <span class="sc">%&gt;%</span> </span>
<span id="cb9-614"><a href="#cb9-614" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">$</span><span class="sc">\\</span><span class="at">nu$</span><span class="st">`</span><span class="ot">=</span><span class="fu">str_replace</span>(<span class="st">`</span><span class="at">$</span><span class="sc">\\</span><span class="at">nu$</span><span class="st">`</span>, <span class="st">"Inf"</span>, r<span class="st">"($</span><span class="sc">\\</span><span class="st">infty$)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb9-615"><a href="#cb9-615" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">format=</span><span class="st">"markdown"</span>)</span>
<span id="cb9-616"><a href="#cb9-616" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-617"><a href="#cb9-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-618"><a href="#cb9-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-619"><a href="#cb9-619" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Confidence interval</span></span>
<span id="cb9-620"><a href="#cb9-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-621"><a href="#cb9-621" aria-hidden="true" tabindex="-1"></a>**Confidence intervals** represent the range of uncertainty associated with the estimate of a statistic (*i.e.* the mean, proportion or standard deviation etc...). </span>
<span id="cb9-622"><a href="#cb9-622" aria-hidden="true" tabindex="-1"></a>An estimate is necessarily subject to the risk of sampling error. Confidence intervals are useful for establishing limits for the estimation of, for example, the mean or a standard deviation, but also regression coefficients, proportions, frequency rates (Poisson) and differences between populations.</span>
<span id="cb9-623"><a href="#cb9-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-624"><a href="#cb9-624" aria-hidden="true" tabindex="-1"></a>**Confidence intervals** are thus a measurement of the **standard error of the estimated statistic**, and their widths thus naturally decrease with the sampling size.</span>
<span id="cb9-625"><a href="#cb9-625" aria-hidden="true" tabindex="-1"></a>As the sample size approaches the entire population, the width of the confidence interval approaches zero, as can be seen on @fig-confidenceinterval.</span>
<span id="cb9-626"><a href="#cb9-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-629"><a href="#cb9-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-630"><a href="#cb9-630" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-confidenceinterval</span></span>
<span id="cb9-631"><a href="#cb9-631" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-632"><a href="#cb9-632" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-633"><a href="#cb9-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-634"><a href="#cb9-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb9-635"><a href="#cb9-635" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Histograms of a Gaussian distribution of mean 0 (red line) and standard deviation 1 with two samplings. The measured mean of the distribution is shown in black, and the 95% confidence interval of the mean is shown in orange. As the population size increases, the width of the confidence interval decreases since the error on the determination of the mean decreases.</span></span>
<span id="cb9-636"><a href="#cb9-636" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: </span></span>
<span id="cb9-637"><a href="#cb9-637" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Population size: 20"</span></span>
<span id="cb9-638"><a href="#cb9-638" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - "Population size: 500"</span></span>
<span id="cb9-639"><a href="#cb9-639" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">2e1</span>)</span>
<span id="cb9-640"><a href="#cb9-640" aria-hidden="true" tabindex="-1"></a>x1CI <span class="ot">&lt;-</span> <span class="fu">mean</span>(x1)<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="fl">-.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span><span class="fu">length</span>(x1)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sd</span>(x1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x1))</span>
<span id="cb9-641"><a href="#cb9-641" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">500</span>)</span>
<span id="cb9-642"><a href="#cb9-642" aria-hidden="true" tabindex="-1"></a>x2CI <span class="ot">&lt;-</span> <span class="fu">mean</span>(x2)<span class="sc">+</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">qt</span>(<span class="dv">1</span><span class="fl">-.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span><span class="fu">length</span>(x2)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sd</span>(x2)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(x2))</span>
<span id="cb9-643"><a href="#cb9-643" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x=</span>x1))<span class="sc">+</span></span>
<span id="cb9-644"><a href="#cb9-644" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax=</span><span class="cn">Inf</span>, <span class="at">xmin=</span>x1CI[<span class="dv">1</span>], <span class="at">xmax=</span>x1CI[<span class="dv">2</span>], <span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">fill=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb9-645"><a href="#cb9-645" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-646"><a href="#cb9-646" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(x1), <span class="at">color=</span><span class="st">"black"</span>, <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-647"><a href="#cb9-647" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">stat</span>(count <span class="sc">/</span> <span class="fu">max</span>(count))), <span class="at">bins=</span><span class="dv">50</span>, <span class="at">alpha=</span>.<span class="dv">8</span>, <span class="at">fill=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-648"><a href="#cb9-648" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb9-649"><a href="#cb9-649" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Density"</span>, <span class="at">x=</span><span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb9-650"><a href="#cb9-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb9-651"><a href="#cb9-651" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span><span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x=</span>x2))<span class="sc">+</span></span>
<span id="cb9-652"><a href="#cb9-652" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"rect"</span>, <span class="at">ymin=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax=</span><span class="cn">Inf</span>, <span class="at">xmin=</span>x2CI[<span class="dv">1</span>], <span class="at">xmax=</span>x2CI[<span class="dv">2</span>], <span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">fill=</span><span class="st">"orange"</span>)<span class="sc">+</span></span>
<span id="cb9-653"><a href="#cb9-653" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">mean</span>(x2), <span class="at">color=</span><span class="st">"black"</span>, <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-654"><a href="#cb9-654" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>, <span class="at">color=</span><span class="st">"red"</span>, <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-655"><a href="#cb9-655" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">stat</span>(count <span class="sc">/</span> <span class="fu">max</span>(count))), <span class="at">bins=</span><span class="dv">50</span>, <span class="at">alpha=</span>.<span class="dv">8</span>, <span class="at">fill=</span><span class="st">"royalblue"</span>)<span class="sc">+</span></span>
<span id="cb9-656"><a href="#cb9-656" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb9-657"><a href="#cb9-657" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Density"</span>, <span class="at">x=</span><span class="st">"x"</span>) <span class="sc">+</span></span>
<span id="cb9-658"><a href="#cb9-658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>))</span>
<span id="cb9-659"><a href="#cb9-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-660"><a href="#cb9-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-661"><a href="#cb9-661" aria-hidden="true" tabindex="-1"></a>To compute the confidence interval of a statistic, you need to know the **standard error** of the statistic, which is the standard deviation of the sampling distribution of the statistic.</span>
<span id="cb9-662"><a href="#cb9-662" aria-hidden="true" tabindex="-1"></a>@tbl-SE gathers a few typical standard errors on statistics:</span>
<span id="cb9-663"><a href="#cb9-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-664"><a href="#cb9-664" aria-hidden="true" tabindex="-1"></a>|Statistic|Standard error|</span>
<span id="cb9-665"><a href="#cb9-665" aria-hidden="true" tabindex="-1"></a>|:--------|:-------------|</span>
<span id="cb9-666"><a href="#cb9-666" aria-hidden="true" tabindex="-1"></a>|Mean|$SE(\overline{x})=\frac{\sigma(x)}{\sqrt{N}}$|</span>
<span id="cb9-667"><a href="#cb9-667" aria-hidden="true" tabindex="-1"></a>|Standard deviation|$SE(\sigma(x))=\frac{\sigma(x)}{\sqrt{2(N-1)}}$|</span>
<span id="cb9-668"><a href="#cb9-668" aria-hidden="true" tabindex="-1"></a>|Median|$SE(\widetilde{x})=\sqrt{\frac{\pi}{2}}\frac{\sigma(x)}{\sqrt{N}}$|</span>
<span id="cb9-669"><a href="#cb9-669" aria-hidden="true" tabindex="-1"></a>|Difference between two means|$SE(\overline{x_1}-\overline{x_2})=\sqrt{\frac{\sigma(x_1)^2}{N_1}+\frac{\sigma(x_2)^2}{N_2}}$|</span>
<span id="cb9-670"><a href="#cb9-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-671"><a href="#cb9-671" aria-hidden="true" tabindex="-1"></a>: Standard errors of typical statistics {#tbl-SE}</span>
<span id="cb9-672"><a href="#cb9-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-673"><a href="#cb9-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-674"><a href="#cb9-674" aria-hidden="true" tabindex="-1"></a>Then, the confidence interval for the statistics $X$ with a confidence level $\alpha$ is computed as:</span>
<span id="cb9-675"><a href="#cb9-675" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-676"><a href="#cb9-676" aria-hidden="true" tabindex="-1"></a>CI(X, \alpha)=X\pm \text{qt}\left(\frac{1+\alpha}{2},\nu\right)\times SE(X)</span>
<span id="cb9-677"><a href="#cb9-677" aria-hidden="true" tabindex="-1"></a>$$ {#eq-CI}</span>
<span id="cb9-678"><a href="#cb9-678" aria-hidden="true" tabindex="-1"></a>where $\text{qt}\left(\frac{1+\alpha}{2},\nu\right)$ is the quantile of the Student distribution with $\nu$ degrees of freedom and a probability of $\frac{1+\alpha}{2}$ (as seen in @sec-tolerence-interval).</span>
<span id="cb9-679"><a href="#cb9-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-680"><a href="#cb9-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-681"><a href="#cb9-681" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-682"><a href="#cb9-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-683"><a href="#cb9-683" aria-hidden="true" tabindex="-1"></a><span class="fu">### Remember</span></span>
<span id="cb9-684"><a href="#cb9-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-685"><a href="#cb9-685" aria-hidden="true" tabindex="-1"></a>The width of a **tolerance interval** is due to both the sampling error and the variance in the population. It is a measurement of the spread of data.</span>
<span id="cb9-686"><a href="#cb9-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-687"><a href="#cb9-687" aria-hidden="true" tabindex="-1"></a>The width of a **confidence interval** is due to the sampling error only. It is a measurement of the precision of the estimate of a statistic.</span>
<span id="cb9-688"><a href="#cb9-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-689"><a href="#cb9-689" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-690"><a href="#cb9-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-691"><a href="#cb9-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-692"><a href="#cb9-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-693"><a href="#cb9-693" aria-hidden="true" tabindex="-1"></a><span class="fu">## Usual statistical tests on distributions</span></span>
<span id="cb9-694"><a href="#cb9-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-695"><a href="#cb9-695" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hypothesis testing and p-values</span></span>
<span id="cb9-696"><a href="#cb9-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-697"><a href="#cb9-697" aria-hidden="true" tabindex="-1"></a>A **hypothesis test** is a statistical test that is used to determine whether a given hypothesis is true or not.</span>
<span id="cb9-698"><a href="#cb9-698" aria-hidden="true" tabindex="-1"></a>It is based on the comparison of the observed data with the expected data, given the hypothesis.</span>
<span id="cb9-699"><a href="#cb9-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-700"><a href="#cb9-700" aria-hidden="true" tabindex="-1"></a>The **null hypothesis** (usually noted $H_0$) is the hypothesis that is tested, and the **alternative hypothesis** (usually noted $H_1$) is the hypothesis that is assumed to be true if the null hypothesis is rejected.</span>
<span id="cb9-701"><a href="#cb9-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-702"><a href="#cb9-702" aria-hidden="true" tabindex="-1"></a>The **p-value** is the probability of obtaining a fluctuation in data under the null hypothesis that is as, or more, extreme than that observed by a given experiment. </span>
<span id="cb9-703"><a href="#cb9-703" aria-hidden="true" tabindex="-1"></a>If the p-value is smaller than a predifined tolerance (usually set to 0.05), then one might consider rejecting the null hypothesis as the probability of observing such a fluctuation under the null hypothesis is extremely small.</span>
<span id="cb9-704"><a href="#cb9-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-705"><a href="#cb9-705" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-706"><a href="#cb9-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-707"><a href="#cb9-707" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-708"><a href="#cb9-708" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $\ge\alpha$ (typically 0.05), the null hypothesis is accepted.</span>
<span id="cb9-709"><a href="#cb9-709" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** is below a certain threshold $\alpha$, the null hypothesis is rejected.</span>
<span id="cb9-710"><a href="#cb9-710" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-711"><a href="#cb9-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-712"><a href="#cb9-712" aria-hidden="true" tabindex="-1"></a>In R, most tests will automatically return a p-value, which will help you decide whether the test is conclusive or not – we will not delve into the details of computing these p-values.</span>
<span id="cb9-713"><a href="#cb9-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-714"><a href="#cb9-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-715"><a href="#cb9-715" aria-hidden="true" tabindex="-1"></a><span class="fu">### Asserting the Gaussian nature of a distribution: the Shapiro–Wilk test</span></span>
<span id="cb9-716"><a href="#cb9-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-717"><a href="#cb9-717" aria-hidden="true" tabindex="-1"></a>The Shapiro-Wilk test is a statistical test that can be used to determine whether a distribution of data is Gaussian or not. </span>
<span id="cb9-718"><a href="#cb9-718" aria-hidden="true" tabindex="-1"></a>It is based on the comparison of the observed distribution with the expected distribution of a Gaussian distribution with the same mean and standard deviation.</span>
<span id="cb9-719"><a href="#cb9-719" aria-hidden="true" tabindex="-1"></a>Its **null hypothesis** is that the data are normally distributed, thus:</span>
<span id="cb9-720"><a href="#cb9-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-721"><a href="#cb9-721" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $&lt;\alpha$, the null hypothesis is rejected and the data are not normally distributed.</span>
<span id="cb9-722"><a href="#cb9-722" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $\ge\alpha$, the null hypothesis is not rejected and the data are normally distributed.</span>
<span id="cb9-723"><a href="#cb9-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-724"><a href="#cb9-724" aria-hidden="true" tabindex="-1"></a>Let's perform a Shapiro-Wilk test on the distribution of the data in @fig-histogramT:</span>
<span id="cb9-725"><a href="#cb9-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-728"><a href="#cb9-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-729"><a href="#cb9-729" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb9-730"><a href="#cb9-730" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb9-731"><a href="#cb9-731" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb9-732"><a href="#cb9-732" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">38</span>, <span class="fl">38.1</span>, <span class="fl">38.0</span>, <span class="fl">38.0</span>, <span class="fl">38.3</span>, <span class="fl">37.9</span>, <span class="fl">38.1</span>, <span class="fl">38.2</span>, <span class="fl">39.8</span>)</span>
<span id="cb9-733"><a href="#cb9-733" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(temp)</span>
<span id="cb9-734"><a href="#cb9-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-735"><a href="#cb9-735" aria-hidden="true" tabindex="-1"></a>We see here that the p-value is <span class="in">`r sprintf("%.3g",shapiro.test(temp)$p.value)`</span>, which is below the threshold $\alpha$ = 0.05. </span>
<span id="cb9-736"><a href="#cb9-736" aria-hidden="true" tabindex="-1"></a>This means that **it is extremely unlikely that you'd observe such measurements if their distribution were normal**.</span>
<span id="cb9-737"><a href="#cb9-737" aria-hidden="true" tabindex="-1"></a>The null hypothesis that the data are normally distributed is thus rejected, and we can conclude that the data are not normally distributed -- as expected from their representation in @fig-histogramT.</span>
<span id="cb9-738"><a href="#cb9-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-739"><a href="#cb9-739" aria-hidden="true" tabindex="-1"></a>If we were to remove the outlier (39.8) and perform the test again, we would get a p-value of <span class="in">`r sprintf("%.3g",shapiro.test(temp[temp!=39.8])$p.value)`</span>, which means that there is a <span class="in">`r round(100*shapiro.test(temp[temp!=39.8])$p.value,1)`</span>% chance to observe such measurements if their distribution were normal. As p-value &gt; 0.05, the null hypothesis that the data are normally distributed is not rejected, and we can conclude that the data are normally distributed.</span>
<span id="cb9-740"><a href="#cb9-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-741"><a href="#cb9-741" aria-hidden="true" tabindex="-1"></a><span class="fu">### Student's t-test </span></span>
<span id="cb9-742"><a href="#cb9-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-743"><a href="#cb9-743" aria-hidden="true" tabindex="-1"></a>The Student's t-test is a statistical test that can be used to determine whether two sets of data are significantly different from each other.</span>
<span id="cb9-744"><a href="#cb9-744" aria-hidden="true" tabindex="-1"></a>Its **null hypothesis** is that **the two sets of data are drawn from the same distribution**, thus:</span>
<span id="cb9-745"><a href="#cb9-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-746"><a href="#cb9-746" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $&lt;\alpha$, the null hypothesis is rejected and the data are not drawn from the same distribution.</span>
<span id="cb9-747"><a href="#cb9-747" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the **p-value** $\ge\alpha$, the null hypothesis is not rejected and the data are drawn from the same distribution.</span>
<span id="cb9-748"><a href="#cb9-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-749"><a href="#cb9-749" aria-hidden="true" tabindex="-1"></a>Let's work on two sets of temperature measurements performed on two different days on two different person. We want to assert whether the temperature evolution between the two days is significant or not for each patient. For the sake of example, let's say that in both cases, they present the same average temperature on day 1 and on day 2 but with a different spread in data.</span>
<span id="cb9-750"><a href="#cb9-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-753"><a href="#cb9-753" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-754"><a href="#cb9-754" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-755"><a href="#cb9-755" aria-hidden="true" tabindex="-1"></a>temps1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Day1 =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="fl">38.2</span>, .<span class="dv">2</span>),</span>
<span id="cb9-756"><a href="#cb9-756" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Day2 =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="fl">37.7</span>, .<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-757"><a href="#cb9-757" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), </span>
<span id="cb9-758"><a href="#cb9-758" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to =</span> <span class="st">"Day"</span>, </span>
<span id="cb9-759"><a href="#cb9-759" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to =</span> <span class="st">"Temperature"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-760"><a href="#cb9-760" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">Patient=</span><span class="st">"A"</span>)</span>
<span id="cb9-761"><a href="#cb9-761" aria-hidden="true" tabindex="-1"></a>temps2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Day1 =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="fl">38.2</span>, <span class="dv">3</span>),</span>
<span id="cb9-762"><a href="#cb9-762" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Day2 =</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="fl">37.7</span>, <span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-763"><a href="#cb9-763" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), </span>
<span id="cb9-764"><a href="#cb9-764" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to =</span> <span class="st">"Day"</span>, </span>
<span id="cb9-765"><a href="#cb9-765" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to =</span> <span class="st">"Temperature"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb9-766"><a href="#cb9-766" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">Patient=</span><span class="st">"B"</span>)</span>
<span id="cb9-767"><a href="#cb9-767" aria-hidden="true" tabindex="-1"></a>temperatures <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(temps1, temps2)</span>
<span id="cb9-768"><a href="#cb9-768" aria-hidden="true" tabindex="-1"></a>temperatures <span class="sc">%&gt;%</span> </span>
<span id="cb9-769"><a href="#cb9-769" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Day, <span class="at">y =</span> Temperature, <span class="at">color =</span> Patient)) <span class="sc">+</span></span>
<span id="cb9-770"><a href="#cb9-770" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">04</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb9-771"><a href="#cb9-771" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> <span class="cn">TRUE</span>, <span class="at">position =</span> <span class="st">"identity"</span>, </span>
<span id="cb9-772"><a href="#cb9-772" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">width =</span> .<span class="dv">2</span>, </span>
<span id="cb9-773"><a href="#cb9-773" aria-hidden="true" tabindex="-1"></a>                     <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb9-774"><a href="#cb9-774" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="st">"identity"</span>, </span>
<span id="cb9-775"><a href="#cb9-775" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb9-776"><a href="#cb9-776" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"royalblue"</span>))<span class="sc">+</span></span>
<span id="cb9-777"><a href="#cb9-777" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"royalblue"</span>))<span class="sc">+</span></span>
<span id="cb9-778"><a href="#cb9-778" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">"mean"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">geom =</span> <span class="st">"point"</span>)<span class="sc">+</span></span>
<span id="cb9-779"><a href="#cb9-779" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Day"</span>,</span>
<span id="cb9-780"><a href="#cb9-780" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="st">"Temperature [°C]"</span>)</span>
<span id="cb9-781"><a href="#cb9-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-782"><a href="#cb9-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-785"><a href="#cb9-785" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-786"><a href="#cb9-786" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: false</span></span>
<span id="cb9-787"><a href="#cb9-787" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-788"><a href="#cb9-788" aria-hidden="true" tabindex="-1"></a>TA <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">data =</span> temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"A"</span>),</span>
<span id="cb9-789"><a href="#cb9-789" aria-hidden="true" tabindex="-1"></a>       Temperature <span class="sc">~</span> Day)</span>
<span id="cb9-790"><a href="#cb9-790" aria-hidden="true" tabindex="-1"></a>TB <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">data =</span> temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"B"</span>),</span>
<span id="cb9-791"><a href="#cb9-791" aria-hidden="true" tabindex="-1"></a>       Temperature <span class="sc">~</span> Day)</span>
<span id="cb9-792"><a href="#cb9-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-793"><a href="#cb9-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-796"><a href="#cb9-796" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-797"><a href="#cb9-797" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-798"><a href="#cb9-798" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: Data means and standard deviations</span></span>
<span id="cb9-799"><a href="#cb9-799" aria-hidden="true" tabindex="-1"></a>temperatures <span class="sc">%&gt;%</span> </span>
<span id="cb9-800"><a href="#cb9-800" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">.by =</span> <span class="fu">c</span>(Day, Patient),</span>
<span id="cb9-801"><a href="#cb9-801" aria-hidden="true" tabindex="-1"></a>              <span class="at">mean =</span> <span class="fu">mean</span>(Temperature),</span>
<span id="cb9-802"><a href="#cb9-802" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd =</span> <span class="fu">sd</span>(Temperature)) <span class="sc">%&gt;%</span></span>
<span id="cb9-803"><a href="#cb9-803" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span>
<span id="cb9-804"><a href="#cb9-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-805"><a href="#cb9-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-806"><a href="#cb9-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-807"><a href="#cb9-807" aria-hidden="true" tabindex="-1"></a>We want to determine whether the temperature evolution between the two days is significant or not for each patient.</span>
<span id="cb9-808"><a href="#cb9-808" aria-hidden="true" tabindex="-1"></a>We can perform a Student's t-test to assert whether the two sets of data are significantly different from each other. </span>
<span id="cb9-809"><a href="#cb9-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-810"><a href="#cb9-810" aria-hidden="true" tabindex="-1"></a>First, **to apply a t-test, we need to make sure that the data are normally distributed**, which we can do by performing a Shapiro-Wilk test on each set of data:</span>
<span id="cb9-813"><a href="#cb9-813" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-814"><a href="#cb9-814" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb9-815"><a href="#cb9-815" aria-hidden="true" tabindex="-1"></a>temperatures <span class="sc">%&gt;%</span> </span>
<span id="cb9-816"><a href="#cb9-816" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nest</span>(<span class="at">data =</span> Temperature) <span class="sc">%&gt;%</span> </span>
<span id="cb9-817"><a href="#cb9-817" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">shapiro =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">as_tibble</span>(</span>
<span id="cb9-818"><a href="#cb9-818" aria-hidden="true" tabindex="-1"></a>        <span class="fu">shapiro.test</span>(.<span class="sc">$</span>Temperature)[<span class="fu">c</span>(<span class="st">'statistic'</span>,<span class="st">'p.value'</span>)]))) <span class="sc">%&gt;%</span> </span>
<span id="cb9-819"><a href="#cb9-819" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(shapiro) <span class="sc">%&gt;%</span> </span>
<span id="cb9-820"><a href="#cb9-820" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>data) <span class="sc">%&gt;%</span> </span>
<span id="cb9-821"><a href="#cb9-821" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">"markdown"</span>)</span>
<span id="cb9-822"><a href="#cb9-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-823"><a href="#cb9-823" aria-hidden="true" tabindex="-1"></a>In all cases the p-value is above 0.05, which means that the null hypothesis that the data are normally distributed is not rejected, and **we can conclude that the data are normally distributed**. The application of the t-test is thus valid.</span>
<span id="cb9-824"><a href="#cb9-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-825"><a href="#cb9-825" aria-hidden="true" tabindex="-1"></a>Let's start now with patient A:</span>
<span id="cb9-828"><a href="#cb9-828" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-829"><a href="#cb9-829" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">data =</span> temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"A"</span>),</span>
<span id="cb9-830"><a href="#cb9-830" aria-hidden="true" tabindex="-1"></a>       Temperature <span class="sc">~</span> Day)</span>
<span id="cb9-831"><a href="#cb9-831" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-832"><a href="#cb9-832" aria-hidden="true" tabindex="-1"></a>As could be intuited by the graphical representation, the t-test on patient A shows that their temperature decreased significantly between day 1 and day 2, with a p-value of <span class="in">`r sprintf("%.3g",TA$p.value)`</span>, which is largely below the threshold $\alpha$ = 0.05.</span>
<span id="cb9-833"><a href="#cb9-833" aria-hidden="true" tabindex="-1"></a>To report it properly, we can say that "the temperature of patient A on day 1 (<span class="in">`r round(TA$estimate[1],2)`</span>°C, 95% CI = <span class="co">[</span><span class="ot">`r sort(round(Rmisc::CI(temperatures %&gt;% filter(Patient == "A", Day=="Day1") %&gt;% pull(Temperature))[c(1,3)],2))`</span><span class="co">]</span>°C), was statistically significantly higher than on day 2 (<span class="in">`r round(TA$estimate[2],2)`</span>°C, 95% CI = <span class="co">[</span><span class="ot">`r sort(round(Rmisc::CI(temperatures %&gt;% filter(Patient == "A", Day=="Day2") %&gt;% pull(Temperature))[c(1,3)],2))`</span><span class="co">]</span>°C), t(<span class="in">`r round(TA$parameter,2)`</span>) = <span class="in">`r round(TA$statistic,2)`</span>, p = <span class="in">`r sprintf("%.3g",TA$p.value)`</span>."</span>
<span id="cb9-834"><a href="#cb9-834" aria-hidden="true" tabindex="-1"></a>Here , <span class="in">`r round(TA$parameter,2)`</span> is the degrees of freedom associated with the t test-statistic.</span>
<span id="cb9-835"><a href="#cb9-835" aria-hidden="true" tabindex="-1"></a>The 95% confidence interval for the difference between the means is <span class="in">`r round(TA$conf.int[1],2)`</span>°C to <span class="in">`r round(TA$conf.int[2],2)`</span>°C.</span>
<span id="cb9-836"><a href="#cb9-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-837"><a href="#cb9-837" aria-hidden="true" tabindex="-1"></a>For patient B however, even though the average temperature decreased between the two days, the spread in data is so large that the t-test does not allow concluding concerning any significant temperature difference between the two days:</span>
<span id="cb9-840"><a href="#cb9-840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-841"><a href="#cb9-841" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">data =</span> temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"B"</span>),</span>
<span id="cb9-842"><a href="#cb9-842" aria-hidden="true" tabindex="-1"></a>       Temperature <span class="sc">~</span> Day)</span>
<span id="cb9-843"><a href="#cb9-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-844"><a href="#cb9-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-845"><a href="#cb9-845" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-846"><a href="#cb9-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-847"><a href="#cb9-847" aria-hidden="true" tabindex="-1"></a>Performing a t-test on a single distribution will test whether the distribution's mean is equal to 0:</span>
<span id="cb9-848"><a href="#cb9-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-851"><a href="#cb9-851" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-852"><a href="#cb9-852" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(temperatures <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Patient <span class="sc">==</span> <span class="st">"B"</span>, Day<span class="sc">==</span><span class="st">"Day1"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Temperature))</span>
<span id="cb9-853"><a href="#cb9-853" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb9-854"><a href="#cb9-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-855"><a href="#cb9-855" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb9-856"><a href="#cb9-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-857"><a href="#cb9-857" aria-hidden="true" tabindex="-1"></a><span class="fu">## Uncertainty and errors</span></span>
<span id="cb9-858"><a href="#cb9-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-859"><a href="#cb9-859" aria-hidden="true" tabindex="-1"></a><span class="fu">### Central limit theorem: on the Gaussian nature of statistical uncertainty</span></span>
<span id="cb9-860"><a href="#cb9-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-861"><a href="#cb9-861" aria-hidden="true" tabindex="-1"></a>The **central limit theorem** states that if one takes $N$ random independent samples of a distribution of data that describes some variable $x$, then as $N$ tends to infinity, the distribution of the sum of the samples tends to a Gaussian distribution. </span>
<span id="cb9-862"><a href="#cb9-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-863"><a href="#cb9-863" aria-hidden="true" tabindex="-1"></a>In other terms: the mean value of a large number $N$ of independent random variables (that can be distributed following any distribution with finite variance), obeying the same distribution with variance $\sigma_0^2$, approaches a normal distribution with variance $\sigma^2 = \sigma _0^2/N$.</span>
<span id="cb9-864"><a href="#cb9-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-865"><a href="#cb9-865" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-866"><a href="#cb9-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-867"><a href="#cb9-867" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-868"><a href="#cb9-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-869"><a href="#cb9-869" aria-hidden="true" tabindex="-1"></a>**This result is fundamental** as it implies that **independent measurements of any observable will show values that will be spread following a Gaussian distribution**, and thus statistical uncertainties that are Gaussian in nature.</span>
<span id="cb9-870"><a href="#cb9-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-871"><a href="#cb9-871" aria-hidden="true" tabindex="-1"></a>Moreover, we see here the typical property of statistical errors, which is that **the relative error is proportional to** $1/\sqrt{N}$. Increasing the number of observations thus decreases the error, *i.e.* increases the precision.</span>
<span id="cb9-872"><a href="#cb9-872" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-873"><a href="#cb9-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-874"><a href="#cb9-874" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combination of errors</span></span>
<span id="cb9-875"><a href="#cb9-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-876"><a href="#cb9-876" aria-hidden="true" tabindex="-1"></a>Let us consider a function of $n$ variables, $f(u_1, u_2, ..., u_n)$. We can Taylor expand this function about the various mean values $u_i=\overline{u_i}$, so that, at the first order:</span>
<span id="cb9-877"><a href="#cb9-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-878"><a href="#cb9-878" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-879"><a href="#cb9-879" aria-hidden="true" tabindex="-1"></a>f(u_1, ..., u_n) = f(\overline{u_1}, ..., \overline{u_n}) + \sum_{i=1}^n (u_i-\overline{u_i})\frac{\partial f}{\partial u_i}</span>
<span id="cb9-880"><a href="#cb9-880" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-881"><a href="#cb9-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-882"><a href="#cb9-882" aria-hidden="true" tabindex="-1"></a>Considering that the variance of a quantity $f$ is given by $\sigma^2(f) = (f - \overline{f} )^2$, it follows that the variance of our multivariable function is given by:</span>
<span id="cb9-883"><a href="#cb9-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-884"><a href="#cb9-884" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-885"><a href="#cb9-885" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-886"><a href="#cb9-886" aria-hidden="true" tabindex="-1"></a>\sigma^2(f) &amp;= \left(\sum_{i=1}^n (u_i-\overline{u_i})\frac{\partial f}{\partial u_i}\right)^2<span class="sc">\\</span></span>
<span id="cb9-887"><a href="#cb9-887" aria-hidden="true" tabindex="-1"></a>         &amp;= \sum_{i=1}^n \left(\frac{\partial f}{\partial u_i}\right)^2\sigma_{u_i}^2 + 2\sum_{i\ne j}\frac{\partial f}{\partial u_i}\frac{\partial f}{\partial u_j}\sigma_{u_iu_j}<span class="sc">\\</span></span>
<span id="cb9-888"><a href="#cb9-888" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-889"><a href="#cb9-889" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-890"><a href="#cb9-890" aria-hidden="true" tabindex="-1"></a>where we have replaced $(u_i-\overline{u_i})^2$ by the variance $\sigma_{u_i}^2$ and $(u_i-\overline{u_i})(u_j-\overline{u_j})$ by the covariance $\sigma_{u_iu_j}$.</span>
<span id="cb9-891"><a href="#cb9-891" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb9-892"><a href="#cb9-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-893"><a href="#cb9-893" aria-hidden="true" tabindex="-1"></a>If the variables $u_i$ are independent then the covariance $\sigma_{u_iu_j}$ is null, and it follows the general expression of the standard error that can be applied to **any function of independent variables**:</span>
<span id="cb9-894"><a href="#cb9-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-895"><a href="#cb9-895" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="minimal"}</span>
<span id="cb9-896"><a href="#cb9-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-897"><a href="#cb9-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-898"><a href="#cb9-898" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-899"><a href="#cb9-899" aria-hidden="true" tabindex="-1"></a>\sigma(f) = \sqrt{\sum_{i=1}^n \left(\frac{\partial f}{\partial u_i}\right)^2\sigma_{u_i}^2}</span>
<span id="cb9-900"><a href="#cb9-900" aria-hidden="true" tabindex="-1"></a>$$ {#eq-uncertainty}</span>
<span id="cb9-901"><a href="#cb9-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-902"><a href="#cb9-902" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-903"><a href="#cb9-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-904"><a href="#cb9-904" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Functions of one variable</span></span>
<span id="cb9-905"><a href="#cb9-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-906"><a href="#cb9-906" aria-hidden="true" tabindex="-1"></a>Let us consider a function $f$ having a form that depends only on one observable $x$, for example:</span>
<span id="cb9-907"><a href="#cb9-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-908"><a href="#cb9-908" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-909"><a href="#cb9-909" aria-hidden="true" tabindex="-1"></a>f = Ax + B</span>
<span id="cb9-910"><a href="#cb9-910" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-911"><a href="#cb9-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-912"><a href="#cb9-912" aria-hidden="true" tabindex="-1"></a>Then, following @eq-uncertainty, the standard error on that function is given by:</span>
<span id="cb9-913"><a href="#cb9-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-914"><a href="#cb9-914" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-915"><a href="#cb9-915" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-916"><a href="#cb9-916" aria-hidden="true" tabindex="-1"></a>\sigma_f &amp;= \sqrt{\left(\frac{\partial f}{\partial x}\right)^2\sigma_x^2}<span class="sc">\\</span></span>
<span id="cb9-917"><a href="#cb9-917" aria-hidden="true" tabindex="-1"></a>         &amp;= A\sigma_x</span>
<span id="cb9-918"><a href="#cb9-918" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-919"><a href="#cb9-919" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-920"><a href="#cb9-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-921"><a href="#cb9-921" aria-hidden="true" tabindex="-1"></a>So, **independently of any offset of the measured observable**, the resulting error must be corrected by the same factor as the intensity.</span>
<span id="cb9-922"><a href="#cb9-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-923"><a href="#cb9-923" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-924"><a href="#cb9-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-925"><a href="#cb9-925" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-926"><a href="#cb9-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-927"><a href="#cb9-927" aria-hidden="true" tabindex="-1"></a>**In practice**, let's say we measure a Raman spectrum. As we saw above, the error on each intensity count is given by the square root of this intensity count. </span>
<span id="cb9-928"><a href="#cb9-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-929"><a href="#cb9-929" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>It is possible to shift vertically this spectrum without having to recompute the error bars.</span>
<span id="cb9-930"><a href="#cb9-930" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>But if you want to normalize (say, to 1) this spectrum, you have to multiply all the errors by the renormalization constant.</span>
<span id="cb9-931"><a href="#cb9-931" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-932"><a href="#cb9-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-933"><a href="#cb9-933" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Functions of two variables</span></span>
<span id="cb9-934"><a href="#cb9-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-935"><a href="#cb9-935" aria-hidden="true" tabindex="-1"></a>Now consider the function $f = Ax + By$, where we have measured the mean and standard deviation of both $x$ and $y$, and want to compute the standard deviation on their sum/subtraction. We can use the general formula of @eq-uncertainty to determine how to do this, hence:</span>
<span id="cb9-936"><a href="#cb9-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-937"><a href="#cb9-937" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-938"><a href="#cb9-938" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb9-939"><a href="#cb9-939" aria-hidden="true" tabindex="-1"></a>\sigma_f &amp;= \sqrt{\left(\frac{\partial f}{\partial x}\right)^2\sigma_x^2 + \left(\frac{\partial f}{\partial y}\right)^2\sigma_y^2}<span class="sc">\\</span></span>
<span id="cb9-940"><a href="#cb9-940" aria-hidden="true" tabindex="-1"></a>         &amp;= \sqrt{A^2\sigma_x^2 + B^2\sigma_y^2}</span>
<span id="cb9-941"><a href="#cb9-941" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb9-942"><a href="#cb9-942" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb9-943"><a href="#cb9-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-944"><a href="#cb9-944" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb9-945"><a href="#cb9-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-946"><a href="#cb9-946" aria-hidden="true" tabindex="-1"></a><span class="fu">## Important</span></span>
<span id="cb9-947"><a href="#cb9-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-948"><a href="#cb9-948" aria-hidden="true" tabindex="-1"></a>**In practice**, let's say we measure an UV spectrum of a solution (a molecule in a solvent), and a reference spectrum of this solvent. As we saw above, the error on each intensity count is given by the square root of this intensity count. We want to subtract the signal of the solvent to get only the signal of the molecule.</span>
<span id="cb9-949"><a href="#cb9-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-950"><a href="#cb9-950" aria-hidden="true" tabindex="-1"></a>We thus have to perform the above operation on the errors, $\sigma_{result}=\sqrt{\sigma^2_{solution}+\sigma^2_{reference}}$. It means that in order to have a statistically sound resulting spectrum, the reference needs to be measured with a very good statistics in order to not dominate the resulting error.</span>
<span id="cb9-951"><a href="#cb9-951" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb9-952"><a href="#cb9-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-953"><a href="#cb9-953" aria-hidden="true" tabindex="-1"></a>It is a good thing to think about error propagation and where it comes from... but you don't have to bother computing it by hand, as <span class="co">[</span><span class="ot">packages are here to do it for you</span><span class="co">](https://colinbousige.github.io/rclass/17-units.html#working-with-experimental-errors)</span>, as we will see later in the class.</span>
<span id="cb9-954"><a href="#cb9-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-955"><a href="#cb9-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-956"><a href="#cb9-956" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further reading</span></span>
<span id="cb9-957"><a href="#cb9-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-958"><a href="#cb9-958" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A. Bevan, *[Statistical Data Analysis for the Physical Sciences](https://www.cambridge.org/core/books/statistical-data-analysis-for-the-physical-sciences/2E3D132870E72277EE5FB96FE616B9F1)*, Cambridge University Press (2013)</span>
<span id="cb9-959"><a href="#cb9-959" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>G. Bohm, *[Introduction to Statistics and Data Analysis for Physicists](http://www-library.desy.de/preparch/books/vstatmp_engl.pdf)*, Hamburg: Verl. Dt. Elektronen-Synchrotron (2010).</span>
<span id="cb9-960"><a href="#cb9-960" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>J. Watkins, *[An Introduction to the Science of Statistics](https://www.math.arizona.edu/~jwatkins/statbook.pdf)*</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/colinbousige/rclass/blob/main/02-stats.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/colinbousige/rclass/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>