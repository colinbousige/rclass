<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>6&nbsp; Data frames – Reproducible data treatment with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-reading_files.html" rel="next">
<link href="./06-vectors.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-152051691-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><link rel="stylesheet" href="style.css">
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-dataframes.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data frames</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Reproducible data treatment with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/colinbousige/rclass" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About the class</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A little reminder on Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-getting_ready.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting ready</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variables, booleans and strings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-dataframes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data frames</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-reading_files.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reading/writing all kinds of files</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-lists.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lists</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-conditions_loops.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Conditional actions and loops</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Plotting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-3d_plots.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">3D color plots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-fitting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fitting</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing documents with Quarto</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Graphical interfaces with Shiny</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-units.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Working with units and experimental errors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">List of exercises</span></span></a>
  </div>
</li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code_bits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Code bits</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#defining-a-data.frame" id="toc-defining-a-data.frame" class="nav-link active" data-scroll-target="#defining-a-data.frame"><span class="header-section-number">6.1</span> Defining a data.frame</a>
  <ul class="collapse">
<li><a href="#defining-a-data.frame-from-vectors" id="toc-defining-a-data.frame-from-vectors" class="nav-link" data-scroll-target="#defining-a-data.frame-from-vectors"><span class="header-section-number">6.1.1</span> Defining a data.frame from vectors</a></li>
  <li><a href="#defining-a-data.frame-from-a-file" id="toc-defining-a-data.frame-from-a-file" class="nav-link" data-scroll-target="#defining-a-data.frame-from-a-file"><span class="header-section-number">6.1.2</span> Defining a data.frame from a file</a></li>
  </ul>
</li>
  <li><a href="#accessing-values" id="toc-accessing-values" class="nav-link" data-scroll-target="#accessing-values"><span class="header-section-number">6.2</span> Accessing values</a></li>
  <li>
<a href="#adding-columns-or-rows" id="toc-adding-columns-or-rows" class="nav-link" data-scroll-target="#adding-columns-or-rows"><span class="header-section-number">6.3</span> Adding columns or rows</a>
  <ul class="collapse">
<li><a href="#adding-columns" id="toc-adding-columns" class="nav-link" data-scroll-target="#adding-columns"><span class="header-section-number">6.3.1</span> Adding columns</a></li>
  <li><a href="#adding-rows" id="toc-adding-rows" class="nav-link" data-scroll-target="#adding-rows"><span class="header-section-number">6.3.2</span> Adding rows</a></li>
  <li><a href="#deleting-rowscolumns" id="toc-deleting-rowscolumns" class="nav-link" data-scroll-target="#deleting-rowscolumns"><span class="header-section-number">6.3.3</span> Deleting rows/columns</a></li>
  </ul>
</li>
  <li>
<a href="#tidy-up" id="toc-tidy-up" class="nav-link" data-scroll-target="#tidy-up"><span class="header-section-number">6.4</span> Tidy up!</a>
  <ul class="collapse">
<li><a href="#what-is-tidy-data" id="toc-what-is-tidy-data" class="nav-link" data-scroll-target="#what-is-tidy-data"><span class="header-section-number">6.4.1</span> What is tidy data?</a></li>
  <li><a href="#tibbles" id="toc-tibbles" class="nav-link" data-scroll-target="#tibbles"><span class="header-section-number">6.4.2</span> Tibbles</a></li>
  </ul>
</li>
  <li>
<a href="#operations-in-the-tidyverse" id="toc-operations-in-the-tidyverse" class="nav-link" data-scroll-target="#operations-in-the-tidyverse"><span class="header-section-number">6.5</span> Operations in the tidyverse</a>
  <ul class="collapse">
<li><a href="#the-pipe-operator" id="toc-the-pipe-operator" class="nav-link" data-scroll-target="#the-pipe-operator"><span class="header-section-number">6.5.1</span> The pipe operator</a></li>
  <li><a href="#sampling-data" id="toc-sampling-data" class="nav-link" data-scroll-target="#sampling-data"><span class="header-section-number">6.5.2</span> Sampling data</a></li>
  <li><a href="#operations-on-groups-of-a-variable" id="toc-operations-on-groups-of-a-variable" class="nav-link" data-scroll-target="#operations-on-groups-of-a-variable"><span class="header-section-number">6.5.3</span> Operations on groups of a variable</a></li>
  <li><a href="#summary-by-groups-of-a-variable" id="toc-summary-by-groups-of-a-variable" class="nav-link" data-scroll-target="#summary-by-groups-of-a-variable"><span class="header-section-number">6.5.4</span> Summary by groups of a variable</a></li>
  <li><a href="#sorting" id="toc-sorting" class="nav-link" data-scroll-target="#sorting"><span class="header-section-number">6.5.5</span> Sorting</a></li>
  <li><a href="#merge-tables-column-wise" id="toc-merge-tables-column-wise" class="nav-link" data-scroll-target="#merge-tables-column-wise"><span class="header-section-number">6.5.6</span> Merge tables column-wise</a></li>
  <li><a href="#merge-tables-row-wise" id="toc-merge-tables-row-wise" class="nav-link" data-scroll-target="#merge-tables-row-wise"><span class="header-section-number">6.5.7</span> Merge tables row-wise</a></li>
  <li><a href="#addmodify-a-column" id="toc-addmodify-a-column" class="nav-link" data-scroll-target="#addmodify-a-column"><span class="header-section-number">6.5.8</span> Add/modify a column</a></li>
  <li><a href="#selecting-columns" id="toc-selecting-columns" class="nav-link" data-scroll-target="#selecting-columns"><span class="header-section-number">6.5.9</span> Selecting columns</a></li>
  <li><a href="#filtering-columns" id="toc-filtering-columns" class="nav-link" data-scroll-target="#filtering-columns"><span class="header-section-number">6.5.10</span> Filtering columns</a></li>
  <li><a href="#reorder-columns" id="toc-reorder-columns" class="nav-link" data-scroll-target="#reorder-columns"><span class="header-section-number">6.5.11</span> Reorder columns</a></li>
  <li><a href="#separate-columns" id="toc-separate-columns" class="nav-link" data-scroll-target="#separate-columns"><span class="header-section-number">6.5.12</span> Separate columns</a></li>
  <li><a href="#apply-a-function-recursively-on-each-element-of-a-column" id="toc-apply-a-function-recursively-on-each-element-of-a-column" class="nav-link" data-scroll-target="#apply-a-function-recursively-on-each-element-of-a-column"><span class="header-section-number">6.5.13</span> Apply a function recursively on each element of a column</a></li>
  <li><a href="#nesting-and-un-nesting-data" id="toc-nesting-and-un-nesting-data" class="nav-link" data-scroll-target="#nesting-and-un-nesting-data"><span class="header-section-number">6.5.14</span> Nesting and un-nesting data</a></li>
  <li><a href="#providing-data-to-ggplot" id="toc-providing-data-to-ggplot" class="nav-link" data-scroll-target="#providing-data-to-ggplot"><span class="header-section-number">6.5.15</span> Providing data to ggplot</a></li>
  </ul>
</li>
  <li><a href="#exo-df" id="toc-exo-df" class="nav-link" data-scroll-target="#exo-df"><span class="header-section-number">6.6</span> Exercises</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/colinbousige/rclass/blob/main/07-dataframes.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/colinbousige/rclass/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data frames</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header><section id="defining-a-data.frame" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="defining-a-data.frame">
<span class="header-section-number">6.1</span> Defining a data.frame</h2>
<section id="defining-a-data.frame-from-vectors" class="level3" data-number="6.1.1"><h3 data-number="6.1.1" class="anchored" data-anchor-id="defining-a-data.frame-from-vectors">
<span class="header-section-number">6.1.1</span> Defining a data.frame from vectors</h3>
<p>In R, the principal object is <em>the data</em>. Hence the <code class="sourceCode r">data.frame</code> object, which is basically a table of vectors. A <code class="sourceCode r">data.frame</code> is a list presented under the form of a table – <em>i.e.</em> a spreadsheet. On a day-to-day basis, you will either define <code class="sourceCode r">data.frame</code> from existing vectors or other <code class="sourceCode r">data.frame</code>, or define a <code class="sourceCode r">data.frame</code> from a file (text, Excel…). In this example, we use <a href="Data/test.dat" download="" target="_blank">test.dat</a> and <a href="Data/test.xlsx" download="" target="_blank">test.xlsx</a>.</p>
<p>To define a <code>data.frame</code> from known vectors, we just have to do:</p>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span>, length <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> </span>
<span><span class="va">y</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="co"># df is a data.frame (a table)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            x             y
#&gt; 1 -3.1415927 -1.224647e-16
#&gt; 2 -1.8849556 -9.510565e-01
#&gt; 3 -0.6283185 -5.877853e-01
#&gt; 4  0.6283185  5.877853e-01
#&gt; 5  1.8849556  9.510565e-01
#&gt; 6  3.1415927  1.224647e-16</code></pre>
</div>
</div>
<p>Then some information about our table are readily accessible, like:</p>
<ul>
<li>The dimension, the number of rows and columns:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 6 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 2</code></pre>
</div>
</div>
<ul>
<li>Print the first and last 3 values</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            x             y
#&gt; 1 -3.1415927 -1.224647e-16
#&gt; 2 -1.8849556 -9.510565e-01
#&gt; 3 -0.6283185 -5.877853e-01</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           x            y
#&gt; 4 0.6283185 5.877853e-01
#&gt; 5 1.8849556 9.510565e-01
#&gt; 6 3.1415927 1.224647e-16</code></pre>
</div>
</div>
<ul>
<li>Print some information on <code>df</code>
</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 'data.frame':    6 obs. of  2 variables:
#&gt;  $ x: num  -3.142 -1.885 -0.628 0.628 1.885 ...
#&gt;  $ y: num  -1.22e-16 -9.51e-01 -5.88e-01 5.88e-01 9.51e-01 ...</code></pre>
</div>
</div>
<ul>
<li>Print some statistics on <code>df</code>
</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;        x                y          
#&gt;  Min.   :-3.142   Min.   :-0.9511  
#&gt;  1st Qu.:-1.571   1st Qu.:-0.4408  
#&gt;  Median : 0.000   Median : 0.0000  
#&gt;  Mean   : 0.000   Mean   : 0.0000  
#&gt;  3rd Qu.: 1.571   3rd Qu.: 0.4408  
#&gt;  Max.   : 3.142   Max.   : 0.9511</code></pre>
</div>
</div>
<p>If not defined when creating the <code>data.frame</code>, the column names will be by default the vector names. To specify your own column names, do it when creating the <code>data.frame</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>xxx <span class="op">=</span> <span class="va">x</span>, yyy <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;         xxx           yyy
#&gt; 1 -3.141593 -1.224647e-16
#&gt; 2 -1.884956 -9.510565e-01</code></pre>
</div>
</div>
<p>Or, once it’s created, do it using <code class="sourceCode r"><span class="fu">names</span>()</code></p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "xxx" "yyy"</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;           X             Y
#&gt; 1 -3.141593 -1.224647e-16
#&gt; 2 -1.884956 -9.510565e-01</code></pre>
</div>
</div>
</section><section id="defining-a-data.frame-from-a-file" class="level3" data-number="6.1.2"><h3 data-number="6.1.2" class="anchored" data-anchor-id="defining-a-data.frame-from-a-file">
<span class="header-section-number">6.1.2</span> Defining a data.frame from a file</h3>
<section id="a-text-file" class="level4" data-number="6.1.2.1"><h4 data-number="6.1.2.1" class="anchored" data-anchor-id="a-text-file">
<span class="header-section-number">6.1.2.1</span> A text file</h4>
<p>Let’s say we have <code>test.dat</code> that looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode bash codeoutput code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bash code:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> Data/test.dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; x   y
#&gt; 1   2
#&gt; 2   3</code></pre>
</div>
</div>
<ul>
<li>Then, to read this file into a <code>data.frame</code>, we will use <code class="sourceCode r"><span class="fu">read.table</span>()</code>. If you don’t specify that the file contains a header, <code class="sourceCode r"><span class="fu">read.table</span>()</code> will default to attributing column names that will be V1, V2, V3, etc:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   V1 V2
#&gt; 1  x  y
#&gt; 2  1  2
#&gt; 3  2  3</code></pre>
</div>
</div>
<ul>
<li>If your file contains column names, you can use the first line as column names, like so:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   x y
#&gt; 1 1 2
#&gt; 2 2 3</code></pre>
</div>
</div>
<ul>
<li>If you want to skip some lines before starting the reading, use <code>skip</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, skip<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   V1 V2
#&gt; 1  1  2
#&gt; 2  2  3</code></pre>
</div>
</div>
<ul>
<li>You can specify your own column names using <code>col.names</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, skip<span class="op">=</span><span class="fl">1</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   A B
#&gt; 1 1 2
#&gt; 2 2 3</code></pre>
</div>
</div>
<ul>
<li>You can type <code><a href="https://rdrr.io/r/utils/read.table.html">?read.table</a></code> for more options.</li>
</ul></section><section id="an-excel-file" class="level4" data-number="6.1.2.2"><h4 data-number="6.1.2.2" class="anchored" data-anchor-id="an-excel-file">
<span class="header-section-number">6.1.2.2</span> An Excel file</h4>
<p>Now, to read an Excel file, use the <code>readxl</code> library:</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span> <span class="co"># load readxl from tidyverse to read Excel files</span></span>
<span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 2
#&gt;        x      y
#&gt;    &lt;dbl&gt;  &lt;dbl&gt;
#&gt;  1     1  5.21 
#&gt;  2     2  6.55 
#&gt;  3     3  3.71 
#&gt;  4     4  0.216
#&gt;  5     5  0.205
#&gt;  6     6  4.60 
#&gt;  7     7 10.3  
#&gt;  8     8 12.9  
#&gt;  9     9 11.1  
#&gt; 10    10  7.28</code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 2
#&gt;   hello  world   
#&gt;   &lt;chr&gt;  &lt;chr&gt;   
#&gt; 1 ac     th      
#&gt; 2 asc    thh     
#&gt; 3 ascsa  dthdh   
#&gt; 4 ascacs dthtdhdh</code></pre>
</div>
</div>
<hr></section></section></section><section id="accessing-values" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="accessing-values">
<span class="header-section-number">6.2</span> Accessing values</h2>
<ul>
<li>Like with vectors, accessing values is done using the <code>[]</code> notation, except that here there are two indexes: <code>df[row, column]</code>:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] -0.6283185</code></pre>
</div>
</div>
<ul>
<li>In general however, what you want is to access a given column, by its index:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="co"># this is a vector too</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
</div>
</div>
<ul>
<li>Or, <strong>preferably</strong>, by its name using the <code>$</code> notation:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">X</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
</div>
</div>
<ul>
<li>Finally, you may want to apply filters on your table:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">X</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            X             Y
#&gt; 1 -3.1415927 -1.224647e-16
#&gt; 2 -1.8849556 -9.510565e-01
#&gt; 3 -0.6283185 -5.877853e-01</code></pre>
</div>
</div>
<ul>
<li>Using the function <code class="sourceCode r"><span class="fu">subset</span>()</code>, the conditions are applied on column names (no need for <code>df$col_name</code> here, while you need it in the above expression):</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">X</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          X            Y
#&gt; 5 1.884956 9.510565e-01
#&gt; 6 3.141593 1.224647e-16</code></pre>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">X</span><span class="op">&gt;</span><span class="fl">1</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          X
#&gt; 5 1.884956
#&gt; 6 3.141593</code></pre>
</div>
</div>
<hr></section><section id="adding-columns-or-rows" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="adding-columns-or-rows">
<span class="header-section-number">6.3</span> Adding columns or rows</h2>
<section id="adding-columns" class="level3" data-number="6.3.1"><h3 data-number="6.3.1" class="anchored" data-anchor-id="adding-columns">
<span class="header-section-number">6.3.1</span> Adding columns</h3>
<ul>
<li>To add a column, just attribute a value to an column that do not exist yet, it will be created:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Adding columns</span></span>
<span><span class="va">df</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            x             y         z
#&gt; 1 -3.1415927 -1.224647e-16 9.8696044
#&gt; 2 -1.8849556 -9.510565e-01 3.5530576
#&gt; 3 -0.6283185 -5.877853e-01 0.3947842
#&gt; 4  0.6283185  5.877853e-01 0.3947842
#&gt; 5  1.8849556  9.510565e-01 3.5530576
#&gt; 6  3.1415927  1.224647e-16 9.8696044</code></pre>
</div>
</div>
<ul>
<li>You can also create a <code>data.frame</code> of a <code>data.frame</code>:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">df</span>, z<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span>, u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            x             y         z       z.1         u
#&gt; 1 -3.1415927 -1.224647e-16 9.8696044 9.8696044 -1.000000
#&gt; 2 -1.8849556 -9.510565e-01 3.5530576 3.5530576 -0.309017
#&gt; 3 -0.6283185 -5.877853e-01 0.3947842 0.3947842  0.809017
#&gt; 4  0.6283185  5.877853e-01 0.3947842 0.3947842  0.809017
#&gt; 5  1.8849556  9.510565e-01 3.5530576 3.5530576 -0.309017
#&gt; 6  3.1415927  1.224647e-16 9.8696044 9.8696044 -1.000000</code></pre>
</div>
</div>
<ul>
<li>Finally, you can use the <code class="sourceCode r"><span class="fu">cbind</span>()</code> function to bind two <code>data.frame</code> column-wise:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            x             y         z a b
#&gt; 1 -3.1415927 -1.224647e-16 9.8696044 1 1
#&gt; 2 -1.8849556 -9.510565e-01 3.5530576 2 2
#&gt; 3 -0.6283185 -5.877853e-01 0.3947842 3 3
#&gt; 4  0.6283185  5.877853e-01 0.3947842 4 4
#&gt; 5  1.8849556  9.510565e-01 3.5530576 5 5
#&gt; 6  3.1415927  1.224647e-16 9.8696044 6 6</code></pre>
</div>
</div>
</section><section id="adding-rows" class="level3" data-number="6.3.2"><h3 data-number="6.3.2" class="anchored" data-anchor-id="adding-rows">
<span class="header-section-number">6.3.2</span> Adding rows</h3>
<p>For this, use the <code class="sourceCode r"><span class="fu">rbind</span>()</code> function.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attention
</div>
</div>
<div class="callout-body-container callout-body">
<p>The two <code>data.frame</code> must have the same number of columns <em><strong>and</strong></em> the same column names.</p>
</div>
</div>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;             x             y         z
#&gt; 1  -3.1415927 -1.224647e-16 9.8696044
#&gt; 2  -1.8849556 -9.510565e-01 3.5530576
#&gt; 3  -0.6283185 -5.877853e-01 0.3947842
#&gt; 4   0.6283185  5.877853e-01 0.3947842
#&gt; 5   1.8849556  9.510565e-01 3.5530576
#&gt; 6   3.1415927  1.224647e-16 9.8696044
#&gt; 7  -3.1415927 -1.224647e-16 9.8696044
#&gt; 8  -1.8849556 -9.510565e-01 3.5530576
#&gt; 9  -0.6283185 -5.877853e-01 0.3947842
#&gt; 10  0.6283185  5.877853e-01 0.3947842
#&gt; 11  1.8849556  9.510565e-01 3.5530576
#&gt; 12  3.1415927  1.224647e-16 9.8696044</code></pre>
</div>
</div>
</section><section id="deleting-rowscolumns" class="level3" data-number="6.3.3"><h3 data-number="6.3.3" class="anchored" data-anchor-id="deleting-rowscolumns">
<span class="header-section-number">6.3.3</span> Deleting rows/columns</h3>
<p>This works like with vectors:</p>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            x             y         z
#&gt; 2 -1.8849556 -9.510565e-01 3.5530576
#&gt; 3 -0.6283185 -5.877853e-01 0.3947842
#&gt; 4  0.6283185  5.877853e-01 0.3947842
#&gt; 5  1.8849556  9.510565e-01 3.5530576
#&gt; 6  3.1415927  1.224647e-16 9.8696044</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;               y         z
#&gt; 1 -1.224647e-16 9.8696044
#&gt; 2 -9.510565e-01 3.5530576
#&gt; 3 -5.877853e-01 0.3947842
#&gt; 4  5.877853e-01 0.3947842
#&gt; 5  9.510565e-01 3.5530576
#&gt; 6  1.224647e-16 9.8696044</code></pre>
</div>
</div>
<hr></section></section><section id="tidy-up" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="tidy-up">
<span class="header-section-number">6.4</span> Tidy up!</h2>
<section id="what-is-tidy-data" class="level3" data-number="6.4.1"><h3 data-number="6.4.1" class="anchored" data-anchor-id="what-is-tidy-data">
<span class="header-section-number">6.4.1</span> What is tidy data?</h3>
<p><strong>A good practice in R is to <em>tidy</em> your data.</strong> R follows a set of conventions that makes one layout of tabular data much easier to work with than others. Your data will be easier to work with in R if it follows three rules:</p>
<ul>
<li>Each variable in the data set is placed in its own column</li>
<li>Each observation is placed in its own row</li>
<li>Each value is placed in its own cell</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./Plots/tidy.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption>Illustration of tidy data.</figcaption></figure>
</div>
</div>
</div>
<p>Data that satisfies these rules is known as tidy data: you see that thanks to this representation, a 2D table can handle an arbitrary number of variables – this avoids using multi-dimensional arrays or multi-tab Excel documents. Note that it does’t matter if a value is repeated in a column.</p>
<p>Here is an example:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="co"># is not tidy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details><summary>
Show output
</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
#&gt; 1 1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
#&gt; 2 1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
#&gt; 3 1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
#&gt; 4 1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
#&gt; 5 1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
#&gt; 6 1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
#&gt; 7 2007 151108   235178 142722 151543   156793  179751 144164 225789 472330
#&gt; 8 2012 149017   241287 139676 152071   158346  173142 143599 228652 496343
#&gt;   Marseille Montpellier Nantes   Nice   Paris  Reims Rennes Saint.Etienne
#&gt; 1    778071      118864 240048 292958 2790091 134856 151948        210311
#&gt; 2    889029      161910 260244 322442 2590771 154534 180943        223223
#&gt; 3    908600      191354 256693 344481 2299830 178381 198305        220181
#&gt; 4    874436      197231 240539 337085 2176243 177234 194656        204955
#&gt; 5    800550      207996 244995 342439 2152423 180620 197536        199396
#&gt; 6    798430      225392 270251 342738 2125246 187206 206229        180210
#&gt; 7    852395      253712 283025 348721 2193030 183500 207922        175318
#&gt; 8    852516      268456 291604 343629 2240621 181893 209860        171483
#&gt;   Strasbourg Toulon Toulouse
#&gt; 1     228971 161797   323724
#&gt; 2     249396 174746   370796
#&gt; 3     253384 181801   373796
#&gt; 4     248712 179423   347995
#&gt; 5     252338 167619   358688
#&gt; 6     264115 160639   390350
#&gt; 7     272123 166537   439453
#&gt; 8     274394 164899   453317</code></pre>
</div>
</div>
</details><p><br></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">df</span>, cols<span class="op">=</span><span class="op">-</span><span class="va">year</span>, names_to<span class="op">=</span><span class="st">"city"</span>, values_to<span class="op">=</span><span class="st">"pop"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="co">#is tidy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details><summary>
Show output
</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 160 × 3
#&gt;     year city         pop
#&gt;    &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
#&gt;  1  1962 Angers    115273
#&gt;  2  1962 Bordeaux  278403
#&gt;  3  1962 Brest     136104
#&gt;  4  1962 Dijon     135694
#&gt;  5  1962 Grenoble  156707
#&gt;  6  1962 LeHavre   187845
#&gt;  7  1962 LeMans    132181
#&gt;  8  1962 Lille     239955
#&gt;  9  1962 Lyon      535746
#&gt; 10  1962 Marseille 778071
#&gt; # ℹ 150 more rows</code></pre>
</div>
</div>
</details><p><br></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># is not tidy</span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span><span class="va">df</span>, names_from<span class="op">=</span><span class="st">"city"</span>, values_from<span class="op">=</span><span class="st">"pop"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details><summary>
Show output
</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 8 × 21
#&gt;    year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
#&gt;   &lt;int&gt;  &lt;int&gt;    &lt;int&gt;  &lt;int&gt;  &lt;int&gt;    &lt;int&gt;   &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
#&gt; 1  1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
#&gt; 2  1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
#&gt; 3  1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
#&gt; 4  1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
#&gt; 5  1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
#&gt; 6  1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
#&gt; 7  2007 151108   235178 142722 151543   156793  179751 144164 225789 472330
#&gt; 8  2012 149017   241287 139676 152071   158346  173142 143599 228652 496343
#&gt; # ℹ 11 more variables: Marseille &lt;int&gt;, Montpellier &lt;int&gt;, Nantes &lt;int&gt;,
#&gt; #   Nice &lt;int&gt;, Paris &lt;int&gt;, Reims &lt;int&gt;, Rennes &lt;int&gt;, Saint.Etienne &lt;int&gt;,
#&gt; #   Strasbourg &lt;int&gt;, Toulon &lt;int&gt;, Toulouse &lt;int&gt;</code></pre>
</div>
</div>
</details><p><br></p>
<p>You can find more information on data import and <a href="https://garrettgman.github.io/tidying/">tidyness</a> on the <a href="https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf">data-import cheatsheet</a> and on the <a href="http://www.sthda.com/english/wiki/tidyr-crucial-step-reshaping-data-with-r-for-easier-analyses">tidyr</a> package.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./Plots/tidyr-pivoting.gif" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Understanding long and wide data with an animation. Source: <a href="https://github.com/gadenbuie/tidyexplain">tidyexplain</a></figcaption></figure>
</div>
</div>
</div>
</section><section id="tibbles" class="level3" data-number="6.4.2"><h3 data-number="6.4.2" class="anchored" data-anchor-id="tibbles">
<span class="header-section-number">6.4.2</span> Tibbles</h3>
<p>A <code class="sourceCode r">tibble</code> is an enhanced version of the <code class="sourceCode r">data.frame</code> provided by the <code>tibble</code> package (which is part of the <code>tidyverse</code>). The main advantage of <code class="sourceCode r">tibble</code> is that it has easier initialization and nicer printing than <code class="sourceCode r">data.frame</code>.</p>
<p>Moreover, the performance are also enhanced for the reading from files with <code class="sourceCode r"><span class="fu">read_csv</span>()</code>, <code class="sourceCode r"><span class="fu">read_tsv</span>()</code>, <code class="sourceCode r"><span class="fu">read_table</span>()</code> and <code class="sourceCode r"><span class="fu">read_delim</span>()</code> that do the same things as their <code>read.xx()</code> counterparts and return a <code>tibble</code>. Otherwise, the handling is basically the same.</p>
<p>More on tibbles <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">here</a>.</p>
<ul>
<li>Note that when initializing <code>tibble</code>s, the construction is iterative. It means that when creating a second column, one can refer to the first one that was created. This does’t work with <code>data.frame</code>s.</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># won't work unless a `x` vector was created before</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1e3</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>#&gt; Error: object 'x' not found</code></pre>
</div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1e3</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tib</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,000 × 2
#&gt;        x     y
#&gt;    &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 0.269 0.269
#&gt;  2 0.150 0.419
#&gt;  3 0.244 0.663
#&gt;  4 0.595 1.26 
#&gt;  5 0.730 1.99 
#&gt;  6 0.982 2.97 
#&gt;  7 0.924 3.89 
#&gt;  8 0.794 4.69 
#&gt;  9 0.518 5.21 
#&gt; 10 0.643 5.85 
#&gt; # ℹ 990 more rows</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Attention
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><code>Tibble</code>s are quite strict about subsetting. <code>[</code> always returns another <code>tibble</code>. Contrast this with a data frame: sometimes <code>[</code> returns a data frame and sometimes it just returns a vector:</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tib</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># is a vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.2693462 0.1499513 0.2435210 0.5948143 0.7297334 0.9815284</code></pre>
</div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tib</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="co"># is a tibble</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 1
#&gt;       x
#&gt;   &lt;dbl&gt;
#&gt; 1 0.269
#&gt; 2 0.150
#&gt; 3 0.244
#&gt; 4 0.595
#&gt; 5 0.730
#&gt; 6 0.982</code></pre>
</div>
</div>
<p>Unless you want to get a <code>tibble</code>, I recommend always using the <code>$</code> notation when you want to get a column as a vector to avoid problems.</p>
<ul>
<li>Another interesting feature of <code>tibble</code>s is that their columns can contain vectors, like usual, but also lists of any R objects like other tibbles, <code class="sourceCode r"><span class="fu">nls</span>()</code> objects, etc. This is called “nesting”, and you can nest and un-nest <code>tibble</code>s using these explicit functions:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tib2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">tib</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>number<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">tib1</span>, <span class="va">tib2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tib</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 2
#&gt;   number data            
#&gt;    &lt;int&gt; &lt;list&gt;          
#&gt; 1      1 &lt;tibble [3 × 2]&gt;
#&gt; 2      2 &lt;tibble [5 × 2]&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-excel-nested" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-excel-nested-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./Plots/excel-nested.png" class="img-fluid figure-img" style="width:50.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-excel-nested-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: Excel equivalent to a nested <code>tibble</code>.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib_unnested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">tib</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">tib_unnested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 8 × 3
#&gt;   number     x     y
#&gt;    &lt;int&gt; &lt;int&gt; &lt;int&gt;
#&gt; 1      1     1     1
#&gt; 2      1     2     2
#&gt; 3      1     3     3
#&gt; 4      2     1     1
#&gt; 5      2     2     2
#&gt; 6      2     3     3
#&gt; 7      2     4     4
#&gt; 8      2     5     5</code></pre>
</div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib_unnested_renested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span><span class="va">tib_unnested</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">number</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tib_unnested_renested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 5 × 2
#&gt;       x data            
#&gt;   &lt;int&gt; &lt;list&gt;          
#&gt; 1     1 &lt;tibble [2 × 2]&gt;
#&gt; 2     2 &lt;tibble [2 × 2]&gt;
#&gt; 3     3 &lt;tibble [2 × 2]&gt;
#&gt; 4     4 &lt;tibble [1 × 2]&gt;
#&gt; 5     5 &lt;tibble [1 × 2]&gt;</code></pre>
</div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib_unnested_renested</span><span class="op">$</span><span class="va">data</span> <span class="co"># The `data` column is a list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [[1]]
#&gt; # A tibble: 2 × 2
#&gt;   number     y
#&gt;    &lt;int&gt; &lt;int&gt;
#&gt; 1      1     1
#&gt; 2      2     1
#&gt; 
#&gt; [[2]]
#&gt; # A tibble: 2 × 2
#&gt;   number     y
#&gt;    &lt;int&gt; &lt;int&gt;
#&gt; 1      1     2
#&gt; 2      2     2
#&gt; 
#&gt; [[3]]
#&gt; # A tibble: 2 × 2
#&gt;   number     y
#&gt;    &lt;int&gt; &lt;int&gt;
#&gt; 1      1     3
#&gt; 2      2     3
#&gt; 
#&gt; [[4]]
#&gt; # A tibble: 1 × 2
#&gt;   number     y
#&gt;    &lt;int&gt; &lt;int&gt;
#&gt; 1      2     4
#&gt; 
#&gt; [[5]]
#&gt; # A tibble: 1 × 2
#&gt;   number     y
#&gt;    &lt;int&gt; &lt;int&gt;
#&gt; 1      2     5</code></pre>
</div>
</div>
<hr></section></section><section id="operations-in-the-tidyverse" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="operations-in-the-tidyverse">
<span class="header-section-number">6.5</span> Operations in the tidyverse</h2>
<p>In the end, base R and the <code>tidyverse</code> package provide many efficient functions to perform most of the tasks you would want to perform recursively, thus allowing avoiding explicit for loops (that are slow).</p>
<p>Here are some examples, and you will find much more <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">here</a>. Take a look at the cheatsheets on <a href="https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf">tidyr</a> and on <a href="https://github.com/rstudio/cheatsheets/blob/main/data-transformation.pdf">dplyr</a>, it’s really helpful.</p>
<p>Let’s work on this <code>tibble</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Let's create a random tibble</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>             y     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>             signx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">0</span>, <span class="st">"positive"</span>, <span class="st">"negative"</span><span class="op">)</span>,</span>
<span>             signy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">&gt;</span><span class="fl">0</span>, <span class="st">"positive"</span>, <span class="st">"negative"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 4
#&gt;          x      y signx    signy   
#&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 -0.0716  0.242 negative positive
#&gt;  2 -0.508   0.420 negative positive
#&gt;  3  0.933   0.264 positive positive
#&gt;  4 -0.844  -0.229 negative negative
#&gt;  5  0.0115 -0.860 positive negative
#&gt;  6 -0.283  -0.460 negative negative
#&gt;  7  0.445  -0.232 positive negative
#&gt;  8  0.572   0.701 positive positive
#&gt;  9 -0.458  -0.229 negative negative
#&gt; 10  0.302   0.306 positive positive
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
</div>
<section id="the-pipe-operator" class="level3" data-number="6.5.1"><h3 data-number="6.5.1" class="anchored" data-anchor-id="the-pipe-operator">
<span class="header-section-number">6.5.1</span> The pipe operator</h3>
<p>In the following, we will introduce the pipe operator <code class="sourceCode r"><span class="sc">|&gt;</span></code>, that was introduced in the version 4.1 of R. This operator allows a clear syntax for successive operations, as “what is on the left of the operator is given as first argument of what is on the right”. It is thus a good habit to write each operation on a separate line to facilitate the reading. This is particularly helpful when performing multiple nested operations. For example, <code class="sourceCode r"><span class="fu">summary</span>(<span class="fu">head</span>(<span class="fu">tail</span>(dt),<span class="dv">2</span>))</code>, which is hard to read, would translate to:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that before the 4.1 version of R, the pipe operator was only present thanks to the <code>magrittr</code> package, and was written <code class="sourceCode r"><span class="sc">%&gt;%</span></code>. In <code>magrittr</code>’s pipe, retrieving the piped object is done with the operator <code>.</code>, while it is done with the operator <code>_</code> in base R’s.</p>
<p>Silly example:</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"Hello"</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"e"</span><span class="op">)</span> <span class="co"># replace the substring "Hello" by "o" in string "e"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "e"</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"Hello"</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"e"</span>, x<span class="op">=</span><span class="va">_</span><span class="op">)</span> <span class="co"># replace the substring "o" by "e" in string "Hello"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "Helle"</code></pre>
</div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"Hello"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"e"</span><span class="op">)</span> <span class="co"># replace the substring "Hello" by "o" in string "e"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "e"</code></pre>
</div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># /!\ In base R pipe, the '_' needs to  be for a named argument, </span></span>
<span><span class="co"># while it is not necessary for the '%&gt;%' pipe</span></span>
<span><span class="st">"Hello"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"e"</span>, <span class="va">.</span><span class="op">)</span> <span class="co"># replace the substring "o" by "e" in string "Hello"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "Helle"</code></pre>
</div>
</div>
</section><section id="sampling-data" class="level3" data-number="6.5.2"><h3 data-number="6.5.2" class="anchored" data-anchor-id="sampling-data">
<span class="header-section-number">6.5.2</span> Sampling data</h3>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>  <span class="co"># by index</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 4
#&gt;         x     y signx    signy   
#&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt; 1 -0.0716 0.242 negative positive
#&gt; 2 -0.508  0.420 negative positive
#&gt; 3  0.933  0.264 positive positive</code></pre>
</div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co"># randomly</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 4
#&gt;        x      y signx    signy   
#&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt; 1 -0.458 -0.877 negative negative
#&gt; 2  0.585  0.409 positive positive
#&gt; 3  0.880  0.967 positive positive</code></pre>
</div>
</div>
</section><section id="operations-on-groups-of-a-variable" class="level3" data-number="6.5.3"><h3 data-number="6.5.3" class="anchored" data-anchor-id="operations-on-groups-of-a-variable">
<span class="header-section-number">6.5.3</span> Operations on groups of a variable</h3>
<p><code class="sourceCode r"><span class="fu">group_by</span>(column)</code> groups by similar values of the wanted column(s) and performs the next operations on each element of the group successively.</p>
<p>Alternatively, you can use the parameter <code class="sourceCode r">by<span class="ot">=</span>column</code> or <code class="sourceCode r">.by<span class="ot">=</span>column</code> in the functions you want to use on groups. The difference between <code class="sourceCode r"><span class="fu">group_by</span>(column)</code> and <code class="sourceCode r">.by<span class="ot">=</span>column</code> is that after <code class="sourceCode r"><span class="fu">group_by</span>(column)</code>, the tibble stays grouped – so an <code class="sourceCode r"><span class="fu">ungroup</span>()</code> is needed to remove the grouping.</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 4
#&gt; # Groups:   signx [2]
#&gt;          x      y signx    signy   
#&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 -0.0716  0.242 negative positive
#&gt;  2 -0.508   0.420 negative positive
#&gt;  3  0.933   0.264 positive positive
#&gt;  4 -0.844  -0.229 negative negative
#&gt;  5  0.0115 -0.860 positive negative
#&gt;  6 -0.283  -0.460 negative negative
#&gt;  7  0.445  -0.232 positive negative
#&gt;  8  0.572   0.701 positive positive
#&gt;  9 -0.458  -0.229 negative negative
#&gt; 10  0.302   0.306 positive positive
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 4
#&gt; # Groups:   signx [2]
#&gt;        x      y signx    signy   
#&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt; 1 -0.990  0.529 negative positive
#&gt; 2 -0.229 -0.972 negative negative
#&gt; 3 -0.753 -0.219 negative negative
#&gt; 4  0.649 -0.437 positive negative
#&gt; 5  0.782 -0.880 positive negative
#&gt; 6  0.293  0.147 positive positive</code></pre>
</div>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span>, <span class="va">signy</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 12 × 4
#&gt; # Groups:   signx, signy [4]
#&gt;         x        y signx    signy   
#&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 -0.804 -0.865   negative negative
#&gt;  2 -0.799 -0.880   negative negative
#&gt;  3 -0.211 -0.520   negative negative
#&gt;  4 -0.391  0.298   negative positive
#&gt;  5 -0.558  0.556   negative positive
#&gt;  6 -0.519  0.0968  negative positive
#&gt;  7  0.480 -0.557   positive negative
#&gt;  8  0.160 -0.299   positive negative
#&gt;  9  0.779 -0.00121 positive negative
#&gt; 10  0.624  0.975   positive positive
#&gt; 11  0.354  0.0756  positive positive
#&gt; 12  0.882  0.993   positive positive</code></pre>
</div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">signx</span>, <span class="va">signy</span><span class="op">)</span>, </span>
<span>                 n  <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 12 × 4
#&gt;         x       y signx    signy   
#&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 -0.234  0.908  negative positive
#&gt;  2 -0.246  0.514  negative positive
#&gt;  3 -0.391  0.375  negative positive
#&gt;  4  0.891  0.612  positive positive
#&gt;  5  0.771  0.0456 positive positive
#&gt;  6  0.919  0.776  positive positive
#&gt;  7 -0.586 -0.0899 negative negative
#&gt;  8 -0.305 -0.564  negative negative
#&gt;  9 -0.391 -0.366  negative negative
#&gt; 10  0.453 -0.893  positive negative
#&gt; 11  0.186 -0.265  positive negative
#&gt; 12  0.585 -0.347  positive negative</code></pre>
</div>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span>, <span class="va">signy</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 12 × 4
#&gt;         x       y signx    signy   
#&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 -0.289 -0.985  negative negative
#&gt;  2 -0.245 -0.915  negative negative
#&gt;  3 -0.211 -0.520  negative negative
#&gt;  4 -0.834  0.758  negative positive
#&gt;  5 -0.516  0.386  negative positive
#&gt;  6 -0.246  0.366  negative positive
#&gt;  7  0.635 -0.809  positive negative
#&gt;  8  0.524 -0.485  positive negative
#&gt;  9  0.134 -0.205  positive negative
#&gt; 10  0.276  0.542  positive positive
#&gt; 11  0.482  0.0470 positive positive
#&gt; 12  0.648  0.781  positive positive</code></pre>
</div>
</div>
</section><section id="summary-by-groups-of-a-variable" class="level3" data-number="6.5.4"><h3 data-number="6.5.4" class="anchored" data-anchor-id="summary-by-groups-of-a-variable">
<span class="header-section-number">6.5.4</span> Summary by groups of a variable</h3>
<p><code class="sourceCode r"><span class="fu">summarise</span>()</code> returns a <strong>single value</strong> for each element of the groups.</p>
<div class="cell">
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>              sd_x   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 4
#&gt;   signx    count mean_x  sd_x
#&gt;   &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 negative   753 -0.485 0.294
#&gt; 2 positive   747  0.504 0.287</code></pre>
</div>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span>, <span class="va">signy</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>              mean_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 5
#&gt; # Groups:   signx [2]
#&gt;   signx    signy    count mean_x mean_y
#&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1 negative negative   386 -0.502 -0.492
#&gt; 2 negative positive   367 -0.467  0.504
#&gt; 3 positive negative   401  0.495 -0.503
#&gt; 4 positive positive   346  0.513  0.501</code></pre>
</div>
</div>
</section><section id="sorting" class="level3" data-number="6.5.5"><h3 data-number="6.5.5" class="anchored" data-anchor-id="sorting">
<span class="header-section-number">6.5.5</span> Sorting</h3>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 4
#&gt;         x      y signx    signy   
#&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 -0.997 -0.137 negative negative
#&gt;  2 -0.997  0.256 negative positive
#&gt;  3 -0.997 -0.839 negative negative
#&gt;  4 -0.996 -0.452 negative negative
#&gt;  5 -0.996  0.124 negative positive
#&gt;  6 -0.996 -0.408 negative negative
#&gt;  7 -0.994  0.473 negative positive
#&gt;  8 -0.994  0.520 negative positive
#&gt;  9 -0.994 -0.708 negative negative
#&gt; 10 -0.993 -0.161 negative negative
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 4
#&gt;         x      y signx    signy   
#&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 -0.997  0.256 negative positive
#&gt;  2 -0.997 -0.137 negative negative
#&gt;  3 -0.997 -0.839 negative negative
#&gt;  4 -0.996  0.124 negative positive
#&gt;  5 -0.996 -0.408 negative negative
#&gt;  6 -0.996 -0.452 negative negative
#&gt;  7 -0.994  0.520 negative positive
#&gt;  8 -0.994  0.473 negative positive
#&gt;  9 -0.994 -0.708 negative negative
#&gt; 10 -0.993  0.536 negative positive
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
</div>
</section><section id="merge-tables-column-wise" class="level3" data-number="6.5.6"><h3 data-number="6.5.6" class="anchored" data-anchor-id="merge-tables-column-wise">
<span class="header-section-number">6.5.6</span> Merge tables column-wise</h3>
<p>At least one column with the <strong>exact</strong> same name must be present in each table to use the <code class="sourceCode r"><span class="fu">xx_join</span>()</code> functions. There are more possibilities than <code class="sourceCode r"><span class="fu">inner_join</span>()</code> that I show here, see the help for more information.</p>
<div class="cell">
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>signx<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"positive"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"negative"</span><span class="op">)</span>, </span>
<span>              signy<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span><span class="op">)</span>, </span>
<span>              value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 3
#&gt;   signx    signy    value
#&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;lgl&gt;
#&gt; 1 positive positive TRUE 
#&gt; 2 positive negative FALSE
#&gt; 3 negative positive FALSE
#&gt; 4 negative negative TRUE</code></pre>
</div>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">dt</span>, <span class="va">dt2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 5
#&gt;          x      y signx    signy    value
#&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;lgl&gt;
#&gt;  1 -0.0716  0.242 negative positive FALSE
#&gt;  2 -0.508   0.420 negative positive FALSE
#&gt;  3  0.933   0.264 positive positive TRUE 
#&gt;  4 -0.844  -0.229 negative negative TRUE 
#&gt;  5  0.0115 -0.860 positive negative FALSE
#&gt;  6 -0.283  -0.460 negative negative TRUE 
#&gt;  7  0.445  -0.232 positive negative FALSE
#&gt;  8  0.572   0.701 positive positive TRUE 
#&gt;  9 -0.458  -0.229 negative negative TRUE 
#&gt; 10  0.302   0.306 positive positive TRUE 
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
</div>
</section><section id="merge-tables-row-wise" class="level3" data-number="6.5.7"><h3 data-number="6.5.7" class="anchored" data-anchor-id="merge-tables-row-wise">
<span class="header-section-number">6.5.7</span> Merge tables row-wise</h3>
<p>This works even if there are missing rows.</p>
<div class="cell">
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, b<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, c<span class="op">=</span><span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">dt4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, c<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">dt3</span>, <span class="va">dt4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 3
#&gt;       a     b     c
#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;
#&gt; 1     1     3     6
#&gt; 2     2     4     7
#&gt; 3     3     5     8
#&gt; 4     3    NA     3
#&gt; 5     2    NA     4
#&gt; 6     1    NA     5</code></pre>
</div>
</div>
</section><section id="addmodify-a-column" class="level3" data-number="6.5.8"><h3 data-number="6.5.8" class="anchored" data-anchor-id="addmodify-a-column">
<span class="header-section-number">6.5.8</span> Add/modify a column</h3>
<p><code class="sourceCode r"><span class="fu">mutate</span>()</code>, like <code class="sourceCode r"><span class="sc">$</span></code>, adds a column if it doesn’t exist, and modifies it if it does.</p>
<div class="cell">
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 6
#&gt;          x      y signx    signy        w       z
#&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;   &lt;dbl&gt;
#&gt;  1 -0.0716  0.242 negative positive     1 -0.0716
#&gt;  2 -0.508   0.420 negative positive     2 -0.486 
#&gt;  3  0.933   0.264 positive positive     3  0.803 
#&gt;  4 -0.844  -0.229 negative negative     4 -0.747 
#&gt;  5  0.0115 -0.860 positive negative     5  0.0115
#&gt;  6 -0.283  -0.460 negative negative     6 -0.279 
#&gt;  7  0.445  -0.232 positive negative     7  0.430 
#&gt;  8  0.572   0.701 positive positive     8  0.542 
#&gt;  9 -0.458  -0.229 negative negative     9 -0.442 
#&gt; 10  0.302   0.306 positive positive    10  0.297 
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 4
#&gt;        x      y signx    signy   
#&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1     1  0.242 negative positive
#&gt;  2     2  0.420 negative positive
#&gt;  3     3  0.264 positive positive
#&gt;  4     4 -0.229 negative negative
#&gt;  5     5 -0.860 positive negative
#&gt;  6     6 -0.460 negative negative
#&gt;  7     7 -0.232 positive negative
#&gt;  8     8  0.701 positive positive
#&gt;  9     9 -0.229 negative negative
#&gt; 10    10  0.306 positive positive
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
</div>
</section><section id="selecting-columns" class="level3" data-number="6.5.9"><h3 data-number="6.5.9" class="anchored" data-anchor-id="selecting-columns">
<span class="header-section-number">6.5.9</span> Selecting columns</h3>
<div class="cell">
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="co"># only x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 1
#&gt;          x
#&gt;      &lt;dbl&gt;
#&gt;  1 -0.0716
#&gt;  2 -0.508 
#&gt;  3  0.933 
#&gt;  4 -0.844 
#&gt;  5  0.0115
#&gt;  6 -0.283 
#&gt;  7  0.445 
#&gt;  8  0.572 
#&gt;  9 -0.458 
#&gt; 10  0.302 
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="co"># all but x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 3
#&gt;         y signx    signy   
#&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1  0.242 negative positive
#&gt;  2  0.420 negative positive
#&gt;  3  0.264 positive positive
#&gt;  4 -0.229 negative negative
#&gt;  5 -0.860 positive negative
#&gt;  6 -0.460 negative negative
#&gt;  7 -0.232 positive negative
#&gt;  8  0.701 positive positive
#&gt;  9 -0.229 negative negative
#&gt; 10  0.306 positive positive
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"sign"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 2
#&gt;    signx    signy   
#&gt;    &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 negative positive
#&gt;  2 negative positive
#&gt;  3 positive positive
#&gt;  4 negative negative
#&gt;  5 positive negative
#&gt;  6 negative negative
#&gt;  7 positive negative
#&gt;  8 positive positive
#&gt;  9 negative negative
#&gt; 10 positive positive
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 2
#&gt;          x signx   
#&gt;      &lt;dbl&gt; &lt;chr&gt;   
#&gt;  1 -0.0716 negative
#&gt;  2 -0.508  negative
#&gt;  3  0.933  positive
#&gt;  4 -0.844  negative
#&gt;  5  0.0115 positive
#&gt;  6 -0.283  negative
#&gt;  7  0.445  positive
#&gt;  8  0.572  positive
#&gt;  9 -0.458  negative
#&gt; 10  0.302  positive
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
</div>
</section><section id="filtering-columns" class="level3" data-number="6.5.10"><h3 data-number="6.5.10" class="anchored" data-anchor-id="filtering-columns">
<span class="header-section-number">6.5.10</span> Filtering columns</h3>
<div class="cell">
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">signx</span><span class="op">==</span><span class="st">"positive"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 747 × 4
#&gt;         x       y signx    signy   
#&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 0.933   0.264  positive positive
#&gt;  2 0.0115 -0.860  positive negative
#&gt;  3 0.445  -0.232  positive negative
#&gt;  4 0.572   0.701  positive positive
#&gt;  5 0.302   0.306  positive positive
#&gt;  6 0.146  -0.747  positive negative
#&gt;  7 0.635   0.457  positive positive
#&gt;  8 0.0584 -0.0593 positive negative
#&gt;  9 0.356  -0.997  positive negative
#&gt; 10 0.0323 -0.739  positive negative
#&gt; # ℹ 737 more rows</code></pre>
</div>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">0</span>, <span class="va">y</span><span class="op">&gt;</span><span class="fl">.1</span><span class="op">)</span> <span class="co"># multiple filters can be applied at once</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 327 × 4
#&gt;          x     y signx    signy   
#&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
#&gt;  1 -0.0716 0.242 negative positive
#&gt;  2 -0.508  0.420 negative positive
#&gt;  3 -0.254  0.349 negative positive
#&gt;  4 -0.234  0.908 negative positive
#&gt;  5 -0.815  0.795 negative positive
#&gt;  6 -0.558  0.556 negative positive
#&gt;  7 -0.370  0.966 negative positive
#&gt;  8 -0.0784 0.442 negative positive
#&gt;  9 -0.213  0.376 negative positive
#&gt; 10 -0.472  0.729 negative positive
#&gt; # ℹ 317 more rows</code></pre>
</div>
</div>
</section><section id="reorder-columns" class="level3" data-number="6.5.11"><h3 data-number="6.5.11" class="anchored" data-anchor-id="reorder-columns">
<span class="header-section-number">6.5.11</span> Reorder columns</h3>
<div class="cell">
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="va">signy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 1,500 × 4
#&gt;          x signx    signy         y
#&gt;      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;dbl&gt;
#&gt;  1 -0.0716 negative positive  0.242
#&gt;  2 -0.508  negative positive  0.420
#&gt;  3  0.933  positive positive  0.264
#&gt;  4 -0.844  negative negative -0.229
#&gt;  5  0.0115 positive negative -0.860
#&gt;  6 -0.283  negative negative -0.460
#&gt;  7  0.445  positive negative -0.232
#&gt;  8  0.572  positive positive  0.701
#&gt;  9 -0.458  negative negative -0.229
#&gt; 10  0.302  positive positive  0.306
#&gt; # ℹ 1,490 more rows</code></pre>
</div>
</div>
</section><section id="separate-columns" class="level3" data-number="6.5.12"><h3 data-number="6.5.12" class="anchored" data-anchor-id="separate-columns">
<span class="header-section-number">6.5.12</span> Separate columns</h3>
<p>The separation is based on standard separators such as “-”, “_”, “.”, ” “, etc. A single separator can be specified with the argument <code>sep</code>, otherwise all separators are used. One must provide the resulting vector of new column names: if one value is <code class="sourceCode r"><span class="cn">NA</span></code>, this column will be discarded. Examples:</p>
<div class="cell">
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/FTIR/Data/"</span>, pattern<span class="op">=</span><span class="st">".xls"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 1
#&gt;    file             
#&gt;    &lt;chr&gt;            
#&gt;  1 sample_0_25C.xls 
#&gt;  2 sample_0_300C.xls
#&gt;  3 sample_1_25C.xls 
#&gt;  4 sample_1_300C.xls
#&gt;  5 sample_2_25C.xls 
#&gt;  6 sample_2_300C.xls
#&gt;  7 sample_3_25C.xls 
#&gt;  8 sample_3_300C.xls
#&gt;  9 sample_4_25C.xls 
#&gt; 10 sample_4_300C.xls</code></pre>
</div>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt5</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">file</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"sample"</span>, <span class="st">"temperature"</span>, <span class="cn">NA</span><span class="op">)</span>, convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 2
#&gt;    sample temperature
#&gt;     &lt;int&gt; &lt;chr&gt;      
#&gt;  1      0 25C        
#&gt;  2      0 300C       
#&gt;  3      1 25C        
#&gt;  4      1 300C       
#&gt;  5      2 25C        
#&gt;  6      2 300C       
#&gt;  7      3 25C        
#&gt;  8      3 300C       
#&gt;  9      4 25C        
#&gt; 10      4 300C</code></pre>
</div>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt5</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">file</span>, </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"extension"</span><span class="op">)</span>, </span>
<span>                sep <span class="op">=</span> <span class="st">"\\."</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 2
#&gt;    name          extension
#&gt;    &lt;chr&gt;         &lt;chr&gt;    
#&gt;  1 sample_0_25C  xls      
#&gt;  2 sample_0_300C xls      
#&gt;  3 sample_1_25C  xls      
#&gt;  4 sample_1_300C xls      
#&gt;  5 sample_2_25C  xls      
#&gt;  6 sample_2_300C xls      
#&gt;  7 sample_3_25C  xls      
#&gt;  8 sample_3_300C xls      
#&gt;  9 sample_4_25C  xls      
#&gt; 10 sample_4_300C xls</code></pre>
</div>
</div>
</section><section id="apply-a-function-recursively-on-each-element-of-a-column" class="level3" data-number="6.5.13"><h3 data-number="6.5.13" class="anchored" data-anchor-id="apply-a-function-recursively-on-each-element-of-a-column">
<span class="header-section-number">6.5.13</span> Apply a function recursively on each element of a column</h3>
<p>Take a look at the <a href="https://github.com/rstudio/cheatsheets/blob/main/purrr.pdf">cheatsheet on the <code>purrr</code> package</a> for more options and a visual help on the <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code> family. I show here a use of <code class="sourceCode r">purrr<span class="sc">::</span><span class="fu">map</span>(vector, <span class="cf">function</span>)</code> that returns a list. <code class="sourceCode r"><span class="fu">map</span>(x, f)</code> applies the function <code>f()</code> to each element of the vector <code>x</code>, putting the result in a separate element of a list: <code class="sourceCode r"><span class="fu">map</span>(x, f) <span class="ot">-&gt;</span> <span class="fu">list</span>(<span class="fu">f</span>(x1), <span class="fu">f</span>(x2), ... <span class="fu">f</span>(xn))</code>. In case <code>f(xi)</code> returns a single value, you might want to use <code><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl()</a></code> or <code><a href="https://purrr.tidyverse.org/reference/map.html">map_chr()</a></code>, for example, that will return a vector of doubles or of characters, respectively.</p>
<div class="cell">
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">/</span><span class="fl">3</span>, <span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sin</span><span class="op">)</span>     <span class="co"># returns a list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [[1]]
#&gt; [1] 1.224647e-16
#&gt; 
#&gt; [[2]]
#&gt; [1] 0.8660254
#&gt; 
#&gt; [[3]]
#&gt; [1] 1</code></pre>
</div>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">sin</span><span class="op">)</span> <span class="co"># returns a vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.224647e-16 8.660254e-01 1.000000e+00</code></pre>
</div>
</div>
<p>Of course, in the above case, it’s a stupid use of the power of <code class="sourceCode r"><span class="fu">map</span>()</code>. A typical use case is when you want to read multiple files, for example:</p>
<div class="cell">
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/spectro2/Data"</span>, </span>
<span>                              pattern <span class="op">=</span> <span class="st">".txt"</span>, </span>
<span>                              full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file</span>, <span class="va">read_table</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"Int"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 5 × 2
#&gt;   file         data                  
#&gt;   &lt;chr&gt;        &lt;list&gt;                
#&gt; 1 rubis_01.txt &lt;spc_tbl_ [1,015 × 2]&gt;
#&gt; 2 rubis_02.txt &lt;spc_tbl_ [1,015 × 2]&gt;
#&gt; 3 rubis_03.txt &lt;spc_tbl_ [1,015 × 2]&gt;
#&gt; 4 rubis_04.txt &lt;spc_tbl_ [1,015 × 2]&gt;
#&gt; 5 rubis_05.txt &lt;spc_tbl_ [1,015 × 2]&gt;</code></pre>
</div>
</div>
<p>This is (almost) equivalent to:</p>
<div class="cell">
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/spectro2/Data"</span>, </span>
<span>                              pattern <span class="op">=</span> <span class="st">".txt"</span>, </span>
<span>                              full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file</span>, <span class="op">~</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="va">.</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"Int"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You see that you can create the function directly within the call to map using the shortcut <code class="sourceCode r"><span class="fu">map</span>(vector, <span class="sc">~</span> <span class="cf">function</span>(.))</code>. This is useful to provide more arguments to the function – another solution is to write your own function before the call to <code class="sourceCode r"><span class="fu">map</span>()</code> and then call this function in <code class="sourceCode r"><span class="fu">map</span>()</code>.</p>
<p>Note that in case you need more parameters, you can use <code class="sourceCode r">purrr<span class="sc">::</span><span class="fu">map2</span>(vector1, vector2, <span class="sc">~</span><span class="cf">function</span>(.x, .y))</code>, where <code>.x</code> and <code>.y</code> refer to <code>vector1</code> and <code>vector2</code>, respectively (it’s always <code>.x</code> and <code>.y</code> whatever the name of <code>vector1</code> and <code>vector2</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sum <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 3
#&gt;       x     y   sum
#&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
#&gt; 1     1     5     6
#&gt; 2     2     6     8
#&gt; 3     3     7    10</code></pre>
</div>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">10</span><span class="op">:</span><span class="fl">13</span>, y<span class="op">=</span><span class="fl">15</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,  y<span class="op">=</span><span class="op">-</span><span class="fl">14</span><span class="op">:</span><span class="op">-</span><span class="fl">17</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sumx <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">x</span>, <span class="va">.y</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           sumy <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">y</span>, <span class="va">.y</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 4
#&gt;   a                b                 sumx  sumy
#&gt;   &lt;list&gt;           &lt;list&gt;           &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 &lt;tibble [3 × 2]&gt; &lt;tibble [4 × 2]&gt;    52    84
#&gt; 2 &lt;tibble [4 × 2]&gt; &lt;tibble [4 × 2]&gt;     8   -40</code></pre>
</div>
</div>
</section><section id="nesting-and-un-nesting-data" class="level3" data-number="6.5.14"><h3 data-number="6.5.14" class="anchored" data-anchor-id="nesting-and-un-nesting-data">
<span class="header-section-number">6.5.14</span> Nesting and un-nesting data</h3>
<div class="cell">
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt7</span> <span class="op">&lt;-</span> <span class="va">dt6</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">dt7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 5,075 × 3
#&gt;    file             w   Int
#&gt;    &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 rubis_01.txt 3064.  43.9
#&gt;  2 rubis_01.txt 3064.  47.9
#&gt;  3 rubis_01.txt 3064.  44.5
#&gt;  4 rubis_01.txt 3065.  50.5
#&gt;  5 rubis_01.txt 3065.  50.5
#&gt;  6 rubis_01.txt 3065.  44.5
#&gt;  7 rubis_01.txt 3065.  44.9
#&gt;  8 rubis_01.txt 3066.  39.9
#&gt;  9 rubis_01.txt 3066.  49.5
#&gt; 10 rubis_01.txt 3066.  48.9
#&gt; # ℹ 5,065 more rows</code></pre>
</div>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Nesting data per repeated values in a column (~equivalent to grouping)</span></span>
<span><span class="va">dt7</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data<span class="op">=</span><span class="op">-</span><span class="va">file</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 5 × 2
#&gt;   file         data                
#&gt;   &lt;chr&gt;        &lt;list&gt;              
#&gt; 1 rubis_01.txt &lt;tibble [1,015 × 2]&gt;
#&gt; 2 rubis_02.txt &lt;tibble [1,015 × 2]&gt;
#&gt; 3 rubis_03.txt &lt;tibble [1,015 × 2]&gt;
#&gt; 4 rubis_04.txt &lt;tibble [1,015 × 2]&gt;
#&gt; 5 rubis_05.txt &lt;tibble [1,015 × 2]&gt;</code></pre>
</div>
</div>
</section><section id="providing-data-to-ggplot" class="level3" data-number="6.5.15"><h3 data-number="6.5.15" class="anchored" data-anchor-id="providing-data-to-ggplot">
<span class="header-section-number">6.5.15</span> Providing data to ggplot</h3>
<div class="cell">
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">signy</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="07-dataframes_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="exo-df" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="exo-df">
<span class="header-section-number">6.6</span> Exercises</h2>
<p>Download the exercises and solutions from the following repositories, then create a Rstudio project from the unzipped folder:</p>
<ul>
<li><a href="https://github.com/colinbousige/R1-beginner">Beginner exercises</a></li>
<li><a href="https://github.com/colinbousige/R2-advanced">Advanced exercises</a></li>
</ul>
<hr>
<details><summary><strong>Exercise 1</strong>
</summary><ul>
<li>Create a 3 column <code class="sourceCode r">data.frame</code> containing 10 random values, their sinus, and the sum of the two first columns.</li>
<li>Print the 4 first lines of the table</li>
<li>Print the second column</li>
<li>Print the average of the third column</li>
<li>Using <code class="sourceCode r"><span class="fu">plot</span>(x,y)</code> where <code>x</code> and <code>y</code> are vectors, plot the 2nd column as a function of the first</li>
<li>Look into the function <code class="sourceCode r"><span class="fu">write.table</span>()</code> to write a text file containing this <code class="sourceCode r">data.frame</code>
</li>
<li>Do the all the same things with a <code class="sourceCode r">tibble</code>
</li>
</ul>
<details><summary>
Solution
</summary><div class="cell" data-warnings="false">
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a 3 column `data.frame`{.R} containing 10 random values, their sinus, </span></span>
<span><span class="co"># and the sum of the two first columns.</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, z<span class="op">=</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co"># Print the 4 first lines of the table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            x          y         z
#&gt; 1 0.99948650 0.84119343 1.8406799
#&gt; 2 0.32774180 0.32190585 0.6496477
#&gt; 3 0.97326605 0.82672761 1.7999937
#&gt; 4 0.07354862 0.07348233 0.1470310</code></pre>
</div>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print the second column</span></span>
<span><span class="va">df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 0.84119343 0.32190585 0.82672761 0.07348233 0.48621517 0.68841104
#&gt;  [7] 0.81271383 0.17913552 0.75627195 0.77948303</code></pre>
</div>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print the average of the third column</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">z</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.228697</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1.228697</code></pre>
</div>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using `plot(x,y)`{.R} where `x` and `y` are vectors, </span></span>
<span><span class="co"># plot the 2nd column as a function of the first</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="07-dataframes_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, <span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="07-dataframes_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Look into the function `write.table()`{.R} to write a text file </span></span>
<span><span class="co"># containing this `data.frame`{.R}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Data/some_data.dat"</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># # # # # # # # # # # # # # # # # </span></span>
<span><span class="co"># Tibble version</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">df_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, c <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_tib</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 3
#&gt;       a     b     c
#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 0.138 0.138 0.276
#&gt; 2 0.616 0.578 1.19 
#&gt; 3 0.988 0.835 1.82 
#&gt; 4 0.244 0.241 0.485</code></pre>
</div>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_tib</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>; <span class="va">df_tib</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 1
#&gt;        b
#&gt;    &lt;dbl&gt;
#&gt;  1 0.138
#&gt;  2 0.578
#&gt;  3 0.835
#&gt;  4 0.241
#&gt;  5 0.229
#&gt;  6 0.664
#&gt;  7 0.480
#&gt;  8 0.484
#&gt;  9 0.327
#&gt; 10 0.385</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] 0.1375984 0.5780987 0.8350272 0.2413177 0.2291233 0.6641828 0.4804249
#&gt;  [8] 0.4835713 0.3269463 0.3852043</code></pre>
</div>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">$</span><span class="va">c</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.903978</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.903978</code></pre>
</div>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">df_tib</span>, <span class="st">"Data/some_data.dat"</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">$</span><span class="va">a</span>, <span class="va">df_tib</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="07-dataframes_files/figure-html/unnamed-chunk-52-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</details></details><details><summary><strong>Exercise 2</strong>
</summary><ul>
<li>Download the files:
<ul>
<li><a href="Data/rubis_01.txt" download="" target="_blank">rubis_01.txt</a></li>
<li><a href="Data/population.csv" download="" target="_blank">population.csv</a></li>
<li><a href="Data/FTIR_rocks.xlsx" download="" target="_blank">FTIR_rocks.xlsx</a></li>
</ul>
</li>
<li>Load them into separate <code class="sourceCode r">data.frames</code>. Look into the options of <code class="sourceCode r"><span class="fu">read.table</span>()</code>, <code class="sourceCode r"><span class="fu">read.csv</span>()</code>, <code class="sourceCode r">readxl<span class="sc">::</span><span class="fu">read_excel</span>()</code>, to get the proper data fields.</li>
<li>Add column names to the data.frame containing <code>rubis_01.txt</code>.</li>
<li>Print their dimensions.</li>
<li>Do the same things with tibbles.</li>
</ul>
<details><summary>
Solution
</summary><div class="cell" data-warnings="false">
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rubis_01</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/rubis_01.txt"</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"intensity"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></span>
<span><span class="va">FTIR_rocks</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/FTIR_rocks.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">rubis_01</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">rubis_01</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 1015    2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "w"         "intensity"</code></pre>
</div>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1]  8 21</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] "year"          "Angers"        "Bordeaux"      "Brest"        
#&gt;  [5] "Dijon"         "Grenoble"      "LeHavre"       "LeMans"       
#&gt;  [9] "Lille"         "Lyon"          "Marseille"     "Montpellier"  
#&gt; [13] "Nantes"        "Nice"          "Paris"         "Reims"        
#&gt; [17] "Rennes"        "Saint.Etienne" "Strasbourg"    "Toulon"       
#&gt; [21] "Toulouse"</code></pre>
</div>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">FTIR_rocks</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">FTIR_rocks</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 4718    4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] "wavenumber, cm-1" "rock 1"           "rock 2"           "rock 3"</code></pre>
</div>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">rubis_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"Data/rubis_01.txt"</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"intensity"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details></details><details><summary><strong>Exercise 3</strong>
</summary><ul>
<li>Download the TGA data file <a href="Data/ATG.txt" download="" target="_blank">ATG.txt</a>
</li>
<li>Load it into a <code class="sourceCode r">data.frame</code>. Look into the options of <code class="sourceCode r"><span class="fu">read.table</span>()</code> to get the proper data fields.</li>
<li>Do the same with a tibble</li>
</ul>
<details><summary>
Solution
</summary><div class="cell">
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, </span>
<span>                skip<span class="op">=</span><span class="fl">12</span>,</span>
<span>                header<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                nrows<span class="op">=</span><span class="fl">4088</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Index"</span>, <span class="st">"t"</span>, <span class="st">"Ts"</span>, <span class="st">"Tr"</span>, <span class="st">"Value"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   Index  t      Ts Tr   Value
#&gt; 1     0  0 32.3769 25 32.9680
#&gt; 2     3  3 32.4051 25 32.9655
#&gt; 3     6  6 32.4332 25 32.9619
#&gt; 4     9  9 32.4726 25 32.9582
#&gt; 5    12 12 32.5066 25 32.9544
#&gt; 6    15 15 32.5221 25 32.9504</code></pre>
</div>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, </span>
<span>                skip<span class="op">=</span><span class="fl">10</span>,</span>
<span>                comment.char<span class="op">=</span><span class="st">"["</span>,</span>
<span>                header<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                nrows<span class="op">=</span><span class="fl">4088</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   Index  t      Ts Tr   Value
#&gt; 1     0  0 32.3769 25 32.9680
#&gt; 2     3  3 32.4051 25 32.9655
#&gt; 3     6  6 32.4332 25 32.9619
#&gt; 4     9  9 32.4726 25 32.9582
#&gt; 5    12 12 32.5066 25 32.9544
#&gt; 6    15 15 32.5221 25 32.9504</code></pre>
</div>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, </span>
<span>                skip    <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                comment <span class="op">=</span> <span class="st">"["</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4,088 × 5
#&gt;    Index     t    Ts    Tr Value
#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1     0     0  32.4    25  33.0
#&gt;  2     3     3  32.4    25  33.0
#&gt;  3     6     6  32.4    25  33.0
#&gt;  4     9     9  32.5    25  33.0
#&gt;  5    12    12  32.5    25  33.0
#&gt;  6    15    15  32.5    25  33.0
#&gt;  7    18    18  32.6    25  32.9
#&gt;  8    21    21  32.6    25  32.9
#&gt;  9    24    24  32.6    25  32.9
#&gt; 10    27    27  32.7    25  32.9
#&gt; # ℹ 4,078 more rows</code></pre>
</div>
</div>
</details></details><details><summary><strong>Exercise 4</strong>
</summary><p>Download <a href="Data/population.csv" download="" target="_blank">population.csv</a> and load it into a <code class="sourceCode r">tibble</code>.</p>
<ul>
<li>What are the names of the columns?</li>
<li>Are the data tidy? make the table tidy if needed</li>
<li>Create a subset containing the data for Montpellier
<ul>
<li>What is the max and min of population in this city?</li>
<li>The average population over time?</li>
</ul>
</li>
<li>What is the total population in 2012?</li>
<li>What is the total population per year?</li>
<li>What is the average population per city over the years?</li>
</ul>
<details><summary>
Solution
</summary><div class="cell">
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Download population.txt and load it into a `data.frame`{.R}.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">popul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></span>
<span><span class="co"># What are the names of the columns and the dimension of the table?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  [1] "year"          "Angers"        "Bordeaux"      "Brest"        
#&gt;  [5] "Dijon"         "Grenoble"      "LeHavre"       "LeMans"       
#&gt;  [9] "Lille"         "Lyon"          "Marseille"     "Montpellier"  
#&gt; [13] "Nantes"        "Nice"          "Paris"         "Reims"        
#&gt; [17] "Rennes"        "Saint-Etienne" "Strasbourg"    "Toulon"       
#&gt; [21] "Toulouse"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1]  8 21</code></pre>
</div>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Are the data tidy?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span> <span class="co"># no</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 21
#&gt;    year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
#&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
#&gt; 1  1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
#&gt; 2  1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
#&gt; 3  1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
#&gt; 4  1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
#&gt; 5  1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
#&gt; 6  1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
#&gt; # ℹ 11 more variables: Marseille &lt;dbl&gt;, Montpellier &lt;dbl&gt;, Nantes &lt;dbl&gt;,
#&gt; #   Nice &lt;dbl&gt;, Paris &lt;dbl&gt;, Reims &lt;dbl&gt;, Rennes &lt;dbl&gt;, `Saint-Etienne` &lt;dbl&gt;,
#&gt; #   Strasbourg &lt;dbl&gt;, Toulon &lt;dbl&gt;, Toulouse &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">popul.tidy</span> <span class="op">&lt;-</span> <span class="va">popul</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="op">-</span><span class="va">year</span>,</span>
<span>                 names_to <span class="op">=</span> <span class="st">"city"</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"pop"</span></span>
<span>                <span class="op">)</span></span>
<span><span class="va">popul.tidy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 160 × 3
#&gt;     year city         pop
#&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
#&gt;  1  1962 Angers    115273
#&gt;  2  1962 Bordeaux  278403
#&gt;  3  1962 Brest     136104
#&gt;  4  1962 Dijon     135694
#&gt;  5  1962 Grenoble  156707
#&gt;  6  1962 LeHavre   187845
#&gt;  7  1962 LeMans    132181
#&gt;  8  1962 Lille     239955
#&gt;  9  1962 Lyon      535746
#&gt; 10  1962 Marseille 778071
#&gt; # ℹ 150 more rows</code></pre>
</div>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a subset containing the data for Montpellier</span></span>
<span><span class="va">mtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">popul.tidy</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Montpellier"</span><span class="op">)</span></span>
<span><span class="co"># I prefer the tidyverse version</span></span>
<span><span class="va">mtp</span> <span class="op">&lt;-</span> <span class="va">popul.tidy</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">city</span> <span class="op">==</span> <span class="st">"Montpellier"</span><span class="op">)</span></span>
<span><span class="co"># What is the max and min of population in this city?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 268456</code></pre>
</div>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 118864</code></pre>
</div>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 118864 268456</code></pre>
</div>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># The average population over time?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 203114.4</code></pre>
</div>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># What is the total population in 2012?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">popul.tidy</span><span class="op">[</span><span class="va">popul.tidy</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2012</span>, <span class="st">"pop"</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 7334805</code></pre>
</div>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">popul.tidy</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="fl">2012</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 7334805</code></pre>
</div>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># What is the total population per year?</span></span>
<span><span class="va">popul.tidy</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>pop_tot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 8 × 2
#&gt;    year pop_tot
#&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1  1962 7349547
#&gt; 2  1968 7550999
#&gt; 3  1975 7298183
#&gt; 4  1982 6933230
#&gt; 5  1990 6857291
#&gt; 6  1999 6965325
#&gt; 7  2007 7235114
#&gt; 8  2012 7334805</code></pre>
</div>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># What is the average population per city over the years?</span></span>
<span><span class="va">popul.tidy</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>pop_ave<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 20 × 2
#&gt;    city           pop_ave
#&gt;    &lt;chr&gt;            &lt;dbl&gt;
#&gt;  1 Angers         138783.
#&gt;  2 Bordeaux       234815.
#&gt;  3 Brest          149125.
#&gt;  4 Dijon          146735.
#&gt;  5 Grenoble       157526.
#&gt;  6 LeHavre        193990.
#&gt;  7 LeMans         144347.
#&gt;  8 Lille          220018.
#&gt;  9 Lyon           470371.
#&gt; 10 Marseille      844253.
#&gt; 11 Montpellier    203114.
#&gt; 12 Nantes         260925.
#&gt; 13 Nice           334312.
#&gt; 14 Paris         2321032.
#&gt; 15 Reims          172278 
#&gt; 16 Rennes         193425.
#&gt; 17 Saint-Etienne  198135.
#&gt; 18 Strasbourg     255429.
#&gt; 19 Toulon         169683.
#&gt; 20 Toulouse       382265.</code></pre>
</div>
</div>
</details></details><details><summary><strong>Exercise 5</strong>
</summary><ul>
<li>First, load the <code>tidyverse</code> and <code>lubridate</code> package</li>
<li>Load <a href="Data/people1.csv" download="" target="_blank">people1.csv</a> and <a href="Data/people2.csv" download="" target="_blank">people2.csv</a> into <code>pp1</code> and <code>pp2</code>
</li>
<li>Create a new tibble <code>pp</code> by using the pipe operator (<code class="sourceCode r"><span class="sc">%&gt;%</span></code>) and successively:
<ul>
<li>joining the two tibbles into one using <code class="sourceCode r"><span class="fu">inner_join</span>()</code>
</li>
<li>adding a column <code>age</code> containing the age in years (use <code class="sourceCode r">lubridate<span class="sc">::</span><span class="fu">time_length</span>(x, <span class="st">'years'</span>)</code> with x a time difference in days) by using <code class="sourceCode r"><span class="fu">mutate</span>()</code>
</li>
</ul>
</li>
<li>Display a summary of the table using <code class="sourceCode r"><span class="fu">str</span>()</code>
</li>
<li>Using <code class="sourceCode r"><span class="fu">groupe_by</span>()</code> and <code class="sourceCode r"><span class="fu">summarize</span>()</code>:
<ul>
<li>Show the number of males and females in the table (use the counter <code class="sourceCode r"><span class="fu">n</span>()</code>)</li>
<li>Show the average age per gender</li>
<li>Show the average size per gender and institution</li>
<li>Show the number of people from each country, sorted by descending population (<code class="sourceCode r"><span class="fu">arrange</span>()</code>)</li>
</ul>
</li>
<li>Using <code class="sourceCode r"><span class="fu">select</span>()</code>, display:
<ul>
<li>only the name and age columns</li>
<li>all but the name column</li>
</ul>
</li>
<li>Using <code class="sourceCode r"><span class="fu">filter</span>()</code>, show data only for
<ul>
<li>Chinese people</li>
<li>From institution ECL and UCBL</li>
<li>People older than 22</li>
<li>People with a <code>e</code> in their name</li>
</ul>
</li>
</ul>
<details><summary>
Solution
</summary><div class="cell" data-warnings="false">
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># First, load the `tidyverse` package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co"># Load people1.csv and people2.csv</span></span>
<span><span class="va">pp1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/people1.csv"</span><span class="op">)</span></span>
<span><span class="va">pp2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/people2.csv"</span><span class="op">)</span></span>
<span><span class="co"># Create a new tibble `pp` by using the pipe operator (`%&gt;%`)</span></span>
<span><span class="co"># and successively:</span></span>
<span><span class="co"># - joining the two tibbles into one using `inner_join()`</span></span>
<span><span class="co"># - adding a column `age` containing the age in years </span></span>
<span><span class="co">#   (use lubridate's `time_length(x, 'years')` with x a time</span></span>
<span><span class="co">#   difference in days) by using `mutate()`</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="va">pp1</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">pp2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/time_length.html">time_length</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="va">dateofbirth</span>,<span class="st">'years'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Display a summary of the table using `str()`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; tibble [20 × 7] (S3: tbl_df/tbl/data.frame)
#&gt;  $ name       : chr [1:20] "Salem" "Dilruwan-Shanaka-Perera" "Hanna" "Sabin" ...
#&gt;  $ gender     : chr [1:20] "Male" "Male" "Female" "Male" ...
#&gt;  $ origin     : chr [1:20] "Yemen" "Sri Lanka" "Ukraine" "India" ...
#&gt;  $ institution: chr [1:20] "UCBL" "INSA" "ECL" "INSA" ...
#&gt;  $ dateofbirth: Date[1:20], format: "1997-12-26" "1997-03-28" ...
#&gt;  $ size       : num [1:20] 161 172 165 186 176 ...
#&gt;  $ age        : num [1:20] 26.9 27.6 26.9 29.3 29.5 ...</code></pre>
</div>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using `groupe_by()` and `summarize()`:</span></span>
<span><span class="co"># - Show the number of males and females in the table </span></span>
<span><span class="co">#   (use the counter `n()`)</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 2
#&gt;   gender count
#&gt;   &lt;chr&gt;  &lt;int&gt;
#&gt; 1 Female     4
#&gt; 2 Male      16</code></pre>
</div>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Show the average age per gender</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 2
#&gt;   gender   age
#&gt;   &lt;chr&gt;  &lt;dbl&gt;
#&gt; 1 Female  28.9
#&gt; 2 Male    28.6</code></pre>
</div>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Show the average size per gender and institution</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">institution</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 3
#&gt; # Groups:   gender [2]
#&gt;   gender institution  size
#&gt;   &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;
#&gt; 1 Female ECL          178.
#&gt; 2 Male   ECL          168.
#&gt; 3 Male   INSA         174.
#&gt; 4 Male   UCBL         174.</code></pre>
</div>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Show the number of people from each country, </span></span>
<span><span class="co">#   sorted by descending population</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 13 × 2
#&gt;    origin      count
#&gt;    &lt;chr&gt;       &lt;int&gt;
#&gt;  1 China           4
#&gt;  2 Ukraine         4
#&gt;  3 USA             2
#&gt;  4 Afghanistan     1
#&gt;  5 Austria         1
#&gt;  6 Brazil          1
#&gt;  7 Colombia        1
#&gt;  8 Cyprus          1
#&gt;  9 India           1
#&gt; 10 Iran            1
#&gt; 11 Sri Lanka       1
#&gt; 12 Tunisia         1
#&gt; 13 Yemen           1</code></pre>
</div>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using `select()`, display:</span></span>
<span><span class="co"># - only the name and age columns</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">age</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 20 × 2
#&gt;    name                      age
#&gt;    &lt;chr&gt;                   &lt;dbl&gt;
#&gt;  1 Salem                    26.9
#&gt;  2 Dilruwan-Shanaka-Perera  27.6
#&gt;  3 Hanna                    26.9
#&gt;  4 Sabin                    29.3
#&gt;  5 Benedikt                 29.5
#&gt;  6 Jordyn                   27.7
#&gt;  7 Jennifer                 29.4
#&gt;  8 Yiran                    29.8
#&gt;  9 Leran                    31.8
#&gt; 10 Aymen                    34.7
#&gt; 11 Pavlo                    27.6
#&gt; 12 Saulo                    30.1
#&gt; 13 Nicolas-Estevan          30.9
#&gt; 14 Farzad                   27.9
#&gt; 15 Roein                    25.3
#&gt; 16 Paraskevas               25.4
#&gt; 17 Ihor                     25.1
#&gt; 18 Iryna                    31.7
#&gt; 19 Peng                     27.9
#&gt; 20 Mingyuan                 27.2</code></pre>
</div>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - all but the name column</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 20 × 6
#&gt;    gender origin      institution dateofbirth  size   age
#&gt;    &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 Male   Yemen       UCBL        1997-12-26   161.  26.9
#&gt;  2 Male   Sri Lanka   INSA        1997-03-28   172.  27.6
#&gt;  3 Female Ukraine     ECL         1997-12-30   165.  26.9
#&gt;  4 Male   India       INSA        1995-08-04   186.  29.3
#&gt;  5 Male   Austria     UCBL        1995-04-25   176.  29.5
#&gt;  6 Female USA         ECL         1997-02-19   176.  27.7
#&gt;  7 Female USA         ECL         1995-05-28   179   29.4
#&gt;  8 Male   China       UCBL        1995-02-04   188.  29.8
#&gt;  9 Male   China       UCBL        1992-12-30   186   31.8
#&gt; 10 Male   Tunisia     INSA        1990-03-03   160.  34.7
#&gt; 11 Male   Ukraine     ECL         1997-04-12   151.  27.6
#&gt; 12 Male   Brazil      ECL         1994-09-24   184.  30.1
#&gt; 13 Male   Colombia    INSA        1993-11-25   184.  30.9
#&gt; 14 Male   Iran        INSA        1996-12-27   183   27.9
#&gt; 15 Male   Afghanistan INSA        1999-07-11   155.  25.3
#&gt; 16 Male   Cyprus      INSA        1999-06-25   176.  25.4
#&gt; 17 Male   Ukraine     ECL         1999-10-03   170.  25.1
#&gt; 18 Female Ukraine     ECL         1993-02-27   192   31.7
#&gt; 19 Male   China       UCBL        1996-12-14   171   27.9
#&gt; 20 Male   China       UCBL        1997-08-21   164.  27.2</code></pre>
</div>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using `filter()`, show data only for</span></span>
<span><span class="co"># - Chinese people</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">origin</span><span class="op">==</span><span class="st">'China'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 7
#&gt;   name     gender origin institution dateofbirth  size   age
#&gt;   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 Yiran    Male   China  UCBL        1995-02-04   188.  29.8
#&gt; 2 Leran    Male   China  UCBL        1992-12-30   186   31.8
#&gt; 3 Peng     Male   China  UCBL        1996-12-14   171   27.9
#&gt; 4 Mingyuan Male   China  UCBL        1997-08-21   164.  27.2</code></pre>
</div>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - From institution ECL and UCBL</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">institution</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ECL'</span>, <span class="st">'UCBL'</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 13 × 7
#&gt;    name     gender origin  institution dateofbirth  size   age
#&gt;    &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 Salem    Male   Yemen   UCBL        1997-12-26   161.  26.9
#&gt;  2 Hanna    Female Ukraine ECL         1997-12-30   165.  26.9
#&gt;  3 Benedikt Male   Austria UCBL        1995-04-25   176.  29.5
#&gt;  4 Jordyn   Female USA     ECL         1997-02-19   176.  27.7
#&gt;  5 Jennifer Female USA     ECL         1995-05-28   179   29.4
#&gt;  6 Yiran    Male   China   UCBL        1995-02-04   188.  29.8
#&gt;  7 Leran    Male   China   UCBL        1992-12-30   186   31.8
#&gt;  8 Pavlo    Male   Ukraine ECL         1997-04-12   151.  27.6
#&gt;  9 Saulo    Male   Brazil  ECL         1994-09-24   184.  30.1
#&gt; 10 Ihor     Male   Ukraine ECL         1999-10-03   170.  25.1
#&gt; 11 Iryna    Female Ukraine ECL         1993-02-27   192   31.7
#&gt; 12 Peng     Male   China   UCBL        1996-12-14   171   27.9
#&gt; 13 Mingyuan Male   China   UCBL        1997-08-21   164.  27.2</code></pre>
</div>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - People older than 22 </span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span><span class="op">&gt;</span><span class="fl">22</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 20 × 7
#&gt;    name                    gender origin     institution dateofbirth  size   age
#&gt;    &lt;chr&gt;                   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 Salem                   Male   Yemen      UCBL        1997-12-26   161.  26.9
#&gt;  2 Dilruwan-Shanaka-Perera Male   Sri Lanka  INSA        1997-03-28   172.  27.6
#&gt;  3 Hanna                   Female Ukraine    ECL         1997-12-30   165.  26.9
#&gt;  4 Sabin                   Male   India      INSA        1995-08-04   186.  29.3
#&gt;  5 Benedikt                Male   Austria    UCBL        1995-04-25   176.  29.5
#&gt;  6 Jordyn                  Female USA        ECL         1997-02-19   176.  27.7
#&gt;  7 Jennifer                Female USA        ECL         1995-05-28   179   29.4
#&gt;  8 Yiran                   Male   China      UCBL        1995-02-04   188.  29.8
#&gt;  9 Leran                   Male   China      UCBL        1992-12-30   186   31.8
#&gt; 10 Aymen                   Male   Tunisia    INSA        1990-03-03   160.  34.7
#&gt; 11 Pavlo                   Male   Ukraine    ECL         1997-04-12   151.  27.6
#&gt; 12 Saulo                   Male   Brazil     ECL         1994-09-24   184.  30.1
#&gt; 13 Nicolas-Estevan         Male   Colombia   INSA        1993-11-25   184.  30.9
#&gt; 14 Farzad                  Male   Iran       INSA        1996-12-27   183   27.9
#&gt; 15 Roein                   Male   Afghanist… INSA        1999-07-11   155.  25.3
#&gt; 16 Paraskevas              Male   Cyprus     INSA        1999-06-25   176.  25.4
#&gt; 17 Ihor                    Male   Ukraine    ECL         1999-10-03   170.  25.1
#&gt; 18 Iryna                   Female Ukraine    ECL         1993-02-27   192   31.7
#&gt; 19 Peng                    Male   China      UCBL        1996-12-14   171   27.9
#&gt; 20 Mingyuan                Male   China      UCBL        1997-08-21   164.  27.2</code></pre>
</div>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - People with a `e` in their name</span></span>
<span><span class="va">pp</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">'e'</span>,<span class="va">name</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 10 × 7
#&gt;    name                    gender origin     institution dateofbirth  size   age
#&gt;    &lt;chr&gt;                   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
#&gt;  1 Salem                   Male   Yemen      UCBL        1997-12-26   161.  26.9
#&gt;  2 Dilruwan-Shanaka-Perera Male   Sri Lanka  INSA        1997-03-28   172.  27.6
#&gt;  3 Benedikt                Male   Austria    UCBL        1995-04-25   176.  29.5
#&gt;  4 Jennifer                Female USA        ECL         1995-05-28   179   29.4
#&gt;  5 Leran                   Male   China      UCBL        1992-12-30   186   31.8
#&gt;  6 Aymen                   Male   Tunisia    INSA        1990-03-03   160.  34.7
#&gt;  7 Nicolas-Estevan         Male   Colombia   INSA        1993-11-25   184.  30.9
#&gt;  8 Roein                   Male   Afghanist… INSA        1999-07-11   155.  25.3
#&gt;  9 Paraskevas              Male   Cyprus     INSA        1999-06-25   176.  25.4
#&gt; 10 Peng                    Male   China      UCBL        1996-12-14   171   27.9</code></pre>
</div>
</div>
</details><hr>
<p>For more interesting exercises in the tidyverse, look at:</p>
<ul>
<li><a href="Exo/co2/exercise.html">CO2 emissions: data wrangling and ggplot2</a></li>
<li><a href="Exo/religion_babies/exercise.html">Religion and babies: data handling, ggplot2 and plotly</a></li>
<li><a href="Exo/covid/exercise.html">COVID-19: data wrangling, ggplot2</a></li>
<li><a href="Exo/SEM_particles/exercise.html">Nanoparticles statistics from SEM images: data wrangling, ggplot2 and fitting</a></li>
</ul>
<p><br><br><br><br><br></p>
<p><br><br><br><br><br></p>


<!-- -->

</details></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./06-vectors.html" class="pagination-link" aria-label="Vectors">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-reading_files.html" class="pagination-link" aria-label="Reading/writing all kinds of files">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reading/writing all kinds of files</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb243" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data frames</span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Defining a data.frame</span></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="fu">### Defining a data.frame from vectors</span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>In R, the principal object is *the data*. Hence the `data.frame`{.R} object, which is basically a table of vectors. A `data.frame`{.R} is a list presented under the form of a table – *i.e.* a spreadsheet. On a day-to-day basis, you will either define <span class="in">`data.frame`</span>{.R} from existing vectors or other <span class="in">`data.frame`</span>{.R}, or define a <span class="in">`data.frame`</span>{.R} from a file (text, Excel...). In this example, we use &lt;a href="Data/test.dat" download target="_blank"&gt;test.dat&lt;/a&gt; and &lt;a href="Data/test.xlsx" download target="_blank"&gt;test.xlsx&lt;/a&gt;.</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>To define a <span class="in">`data.frame`</span> from known vectors, we just have to do:</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE, message=FALSE}</span></span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a><span class="in">x  &lt;- seq(-pi, pi, length = 6) </span></span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a><span class="in">y  &lt;- sin(x)</span></span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- data.frame(x, y) # df is a data.frame (a table)</span></span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a><span class="in">df</span></span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-17"><a href="#cb243-17" aria-hidden="true" tabindex="-1"></a>Then some information about our table are readily accessible, like:</span>
<span id="cb243-18"><a href="#cb243-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-19"><a href="#cb243-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The dimension, the number of rows and columns:</span>
<span id="cb243-20"><a href="#cb243-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE, message=FALSE}</span></span>
<span id="cb243-21"><a href="#cb243-21" aria-hidden="true" tabindex="-1"></a><span class="in">dim(df); nrow(df); ncol(df)</span></span>
<span id="cb243-22"><a href="#cb243-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-23"><a href="#cb243-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Print the first and last 3 values</span>
<span id="cb243-24"><a href="#cb243-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE, message=FALSE}</span></span>
<span id="cb243-25"><a href="#cb243-25" aria-hidden="true" tabindex="-1"></a><span class="in">head(df, 3); tail(df, 3)</span></span>
<span id="cb243-26"><a href="#cb243-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-27"><a href="#cb243-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Print some information on <span class="in">`df`</span></span>
<span id="cb243-28"><a href="#cb243-28" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE, message=FALSE}</span></span>
<span id="cb243-29"><a href="#cb243-29" aria-hidden="true" tabindex="-1"></a><span class="in">str(df)</span></span>
<span id="cb243-30"><a href="#cb243-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-31"><a href="#cb243-31" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Print some statistics on <span class="in">`df`</span></span>
<span id="cb243-32"><a href="#cb243-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE, message=FALSE}</span></span>
<span id="cb243-33"><a href="#cb243-33" aria-hidden="true" tabindex="-1"></a><span class="in">summary(df)</span></span>
<span id="cb243-34"><a href="#cb243-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-35"><a href="#cb243-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-36"><a href="#cb243-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-37"><a href="#cb243-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-38"><a href="#cb243-38" aria-hidden="true" tabindex="-1"></a>If not defined when creating the <span class="in">`data.frame`</span>, the column names will be by default the vector names. To specify your own column names, do it when creating the <span class="in">`data.frame`</span>:</span>
<span id="cb243-41"><a href="#cb243-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-42"><a href="#cb243-42" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">xxx =</span> x, <span class="at">yyy =</span> y)</span>
<span id="cb243-43"><a href="#cb243-43" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">2</span>)</span>
<span id="cb243-44"><a href="#cb243-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-45"><a href="#cb243-45" aria-hidden="true" tabindex="-1"></a>Or, once it's created, do it using <span class="in">`names()`</span>{.R}</span>
<span id="cb243-48"><a href="#cb243-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-49"><a href="#cb243-49" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span>
<span id="cb243-50"><a href="#cb243-50" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"X"</span>, <span class="st">"Y"</span>)</span>
<span id="cb243-51"><a href="#cb243-51" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df, <span class="dv">2</span>)</span>
<span id="cb243-52"><a href="#cb243-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-53"><a href="#cb243-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-54"><a href="#cb243-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-55"><a href="#cb243-55" aria-hidden="true" tabindex="-1"></a><span class="fu">### Defining a data.frame from a file</span></span>
<span id="cb243-56"><a href="#cb243-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-57"><a href="#cb243-57" aria-hidden="true" tabindex="-1"></a><span class="fu">#### A text file</span></span>
<span id="cb243-58"><a href="#cb243-58" aria-hidden="true" tabindex="-1"></a>Let's say we have <span class="in">`test.dat`</span> that looks like this:</span>
<span id="cb243-61"><a href="#cb243-61" aria-hidden="true" tabindex="-1"></a><span class="in">```{bash}</span></span>
<span id="cb243-62"><a href="#cb243-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Bash code:</span></span>
<span id="cb243-63"><a href="#cb243-63" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> Data/test.dat</span>
<span id="cb243-64"><a href="#cb243-64" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-65"><a href="#cb243-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-66"><a href="#cb243-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Then, to read this file into a <span class="in">`data.frame`</span>, we will use <span class="in">`read.table()`</span>{.R}. If you don't specify that the file contains a header, <span class="in">`read.table()`</span>{.R} will default to attributing column names that will be V1, V2, V3, etc:</span>
<span id="cb243-69"><a href="#cb243-69" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-70"><a href="#cb243-70" aria-hidden="true" tabindex="-1"></a><span class="fu">read.table</span>(<span class="st">"Data/test.dat"</span>)</span>
<span id="cb243-71"><a href="#cb243-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-72"><a href="#cb243-72" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If your file contains column names, you can use the first line as column names, like so:</span>
<span id="cb243-75"><a href="#cb243-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-76"><a href="#cb243-76" aria-hidden="true" tabindex="-1"></a><span class="fu">read.table</span>(<span class="st">"Data/test.dat"</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb243-77"><a href="#cb243-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-78"><a href="#cb243-78" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If you want to skip some lines before starting the reading, use <span class="in">`skip`</span>:</span>
<span id="cb243-81"><a href="#cb243-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-82"><a href="#cb243-82" aria-hidden="true" tabindex="-1"></a><span class="fu">read.table</span>(<span class="st">"Data/test.dat"</span>, <span class="at">skip=</span><span class="dv">1</span>)</span>
<span id="cb243-83"><a href="#cb243-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-84"><a href="#cb243-84" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You can specify your own column names using <span class="in">`col.names`</span>:</span>
<span id="cb243-87"><a href="#cb243-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-88"><a href="#cb243-88" aria-hidden="true" tabindex="-1"></a><span class="fu">read.table</span>(<span class="st">"Data/test.dat"</span>, <span class="at">skip=</span><span class="dv">1</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>))</span>
<span id="cb243-89"><a href="#cb243-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-90"><a href="#cb243-90" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You can type <span class="in">`?read.table`</span> for more options.</span>
<span id="cb243-91"><a href="#cb243-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-92"><a href="#cb243-92" aria-hidden="true" tabindex="-1"></a><span class="fu">#### An Excel file</span></span>
<span id="cb243-93"><a href="#cb243-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-94"><a href="#cb243-94" aria-hidden="true" tabindex="-1"></a>Now, to read an Excel file, use the <span class="in">`readxl`</span> library:</span>
<span id="cb243-97"><a href="#cb243-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-98"><a href="#cb243-98" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># load readxl from tidyverse to read Excel files</span></span>
<span id="cb243-99"><a href="#cb243-99" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">"Data/test.xlsx"</span>, <span class="at">sheet=</span><span class="dv">1</span>)</span>
<span id="cb243-100"><a href="#cb243-100" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">"Data/test.xlsx"</span>, <span class="at">sheet=</span><span class="dv">2</span>)</span>
<span id="cb243-101"><a href="#cb243-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-102"><a href="#cb243-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-103"><a href="#cb243-103" aria-hidden="true" tabindex="-1"></a>--- </span>
<span id="cb243-104"><a href="#cb243-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-105"><a href="#cb243-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## Accessing values </span></span>
<span id="cb243-106"><a href="#cb243-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-107"><a href="#cb243-107" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Like with vectors, accessing values is done using the <span class="in">`[]`</span> notation, except that here there are two indexes: <span class="in">`df[row, column]`</span>:</span>
<span id="cb243-108"><a href="#cb243-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-109"><a href="#cb243-109" aria-hidden="true" tabindex="-1"></a><span class="in">df[3,1]</span></span>
<span id="cb243-110"><a href="#cb243-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-111"><a href="#cb243-111" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In general however, what you want is to access a given column, by its index:</span>
<span id="cb243-112"><a href="#cb243-112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-113"><a href="#cb243-113" aria-hidden="true" tabindex="-1"></a><span class="in">df[,1]</span></span>
<span id="cb243-114"><a href="#cb243-114" aria-hidden="true" tabindex="-1"></a><span class="in">df[[1]]# this is a vector too</span></span>
<span id="cb243-115"><a href="#cb243-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-116"><a href="#cb243-116" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Or, **preferably**, by its name using the <span class="in">`$`</span> notation:</span>
<span id="cb243-117"><a href="#cb243-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-118"><a href="#cb243-118" aria-hidden="true" tabindex="-1"></a><span class="in">df$X</span></span>
<span id="cb243-119"><a href="#cb243-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-120"><a href="#cb243-120" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Finally, you may want to apply filters on your table:</span>
<span id="cb243-121"><a href="#cb243-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-122"><a href="#cb243-122" aria-hidden="true" tabindex="-1"></a><span class="in">df[df$X &lt; 0, ]</span></span>
<span id="cb243-123"><a href="#cb243-123" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-124"><a href="#cb243-124" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using the function <span class="in">`subset()`</span>{.R}, the conditions are applied on column names (no need for <span class="in">`df$col_name`</span> here, while you need it in the above expression):</span>
<span id="cb243-125"><a href="#cb243-125" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-126"><a href="#cb243-126" aria-hidden="true" tabindex="-1"></a><span class="in">subset(df, X&gt;1)</span></span>
<span id="cb243-127"><a href="#cb243-127" aria-hidden="true" tabindex="-1"></a><span class="in">subset(df, X&gt;1, select = c(X))</span></span>
<span id="cb243-128"><a href="#cb243-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-129"><a href="#cb243-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-130"><a href="#cb243-130" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb243-131"><a href="#cb243-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-132"><a href="#cb243-132" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adding columns or rows</span></span>
<span id="cb243-133"><a href="#cb243-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-134"><a href="#cb243-134" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding columns</span></span>
<span id="cb243-135"><a href="#cb243-135" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>To add a column, just attribute a value to an column that do not exist yet, it will be created:</span>
<span id="cb243-136"><a href="#cb243-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-137"><a href="#cb243-137" aria-hidden="true" tabindex="-1"></a><span class="in"># Adding columns</span></span>
<span id="cb243-138"><a href="#cb243-138" aria-hidden="true" tabindex="-1"></a><span class="in">df   &lt;- data.frame(x,y)</span></span>
<span id="cb243-139"><a href="#cb243-139" aria-hidden="true" tabindex="-1"></a><span class="in">df$z &lt;- df$x^2</span></span>
<span id="cb243-140"><a href="#cb243-140" aria-hidden="true" tabindex="-1"></a><span class="in">df</span></span>
<span id="cb243-141"><a href="#cb243-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-142"><a href="#cb243-142" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You can also create a <span class="in">`data.frame`</span> of a <span class="in">`data.frame`</span>:</span>
<span id="cb243-143"><a href="#cb243-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-144"><a href="#cb243-144" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(df, z=df$x^2, u=cos(df$x))</span></span>
<span id="cb243-145"><a href="#cb243-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-146"><a href="#cb243-146" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Finally, you can use the <span class="in">`cbind()`</span>{.R} function to bind two <span class="in">`data.frame`</span> column-wise:</span>
<span id="cb243-147"><a href="#cb243-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-148"><a href="#cb243-148" aria-hidden="true" tabindex="-1"></a><span class="in">df2 &lt;- data.frame(a = 1:length(x), b = 1:length(x))</span></span>
<span id="cb243-149"><a href="#cb243-149" aria-hidden="true" tabindex="-1"></a><span class="in">cbind(df, df2)</span></span>
<span id="cb243-150"><a href="#cb243-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-151"><a href="#cb243-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-152"><a href="#cb243-152" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding rows</span></span>
<span id="cb243-153"><a href="#cb243-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-154"><a href="#cb243-154" aria-hidden="true" tabindex="-1"></a>For this, use the <span class="in">`rbind()`</span>{.R} function.</span>
<span id="cb243-155"><a href="#cb243-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-156"><a href="#cb243-156" aria-hidden="true" tabindex="-1"></a>:::{.callout-warning}</span>
<span id="cb243-157"><a href="#cb243-157" aria-hidden="true" tabindex="-1"></a><span class="fu">## Attention</span></span>
<span id="cb243-158"><a href="#cb243-158" aria-hidden="true" tabindex="-1"></a>The two <span class="in">`data.frame`</span> must have the same number of columns _**and**_ the same column names.</span>
<span id="cb243-159"><a href="#cb243-159" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb243-160"><a href="#cb243-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-161"><a href="#cb243-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-162"><a href="#cb243-162" aria-hidden="true" tabindex="-1"></a><span class="in">rbind(df, df)</span></span>
<span id="cb243-163"><a href="#cb243-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-164"><a href="#cb243-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-165"><a href="#cb243-165" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deleting rows/columns</span></span>
<span id="cb243-166"><a href="#cb243-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-167"><a href="#cb243-167" aria-hidden="true" tabindex="-1"></a>This works like with vectors:</span>
<span id="cb243-168"><a href="#cb243-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-169"><a href="#cb243-169" aria-hidden="true" tabindex="-1"></a><span class="in">df[-1,]</span></span>
<span id="cb243-170"><a href="#cb243-170" aria-hidden="true" tabindex="-1"></a><span class="in">df[,-1]</span></span>
<span id="cb243-171"><a href="#cb243-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-172"><a href="#cb243-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-173"><a href="#cb243-173" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb243-174"><a href="#cb243-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-175"><a href="#cb243-175" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tidy up!</span></span>
<span id="cb243-176"><a href="#cb243-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-177"><a href="#cb243-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-178"><a href="#cb243-178" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is tidy data?</span></span>
<span id="cb243-179"><a href="#cb243-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-180"><a href="#cb243-180" aria-hidden="true" tabindex="-1"></a>**A good practice in R is to *tidy* your data.** R follows a set of conventions that makes one layout of tabular data much easier to work with than others. Your data will be easier to work with in R if it follows three rules:</span>
<span id="cb243-181"><a href="#cb243-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-182"><a href="#cb243-182" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each variable in the data set is placed in its own column</span>
<span id="cb243-183"><a href="#cb243-183" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each observation is placed in its own row</span>
<span id="cb243-184"><a href="#cb243-184" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each value is placed in its own cell</span>
<span id="cb243-185"><a href="#cb243-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-186"><a href="#cb243-186" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tidy, echo=FALSE, fig.cap="Illustration of tidy data.", fig.align="center", out.width="100%"}</span></span>
<span id="cb243-187"><a href="#cb243-187" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("./Plots/tidy.png")</span></span>
<span id="cb243-188"><a href="#cb243-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-189"><a href="#cb243-189" aria-hidden="true" tabindex="-1"></a>Data that satisfies these rules is known as tidy data: you see that thanks to this representation, a 2D table can handle an arbitrary number of variables – this avoids using multi-dimensional arrays or multi-tab Excel documents. Note that it does't matter if a value is repeated in a column. </span>
<span id="cb243-190"><a href="#cb243-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-191"><a href="#cb243-191" aria-hidden="true" tabindex="-1"></a>Here is an example:</span>
<span id="cb243-192"><a href="#cb243-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-193"><a href="#cb243-193" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb243-194"><a href="#cb243-194" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data/population.csv"</span>)</span>
<span id="cb243-195"><a href="#cb243-195" aria-hidden="true" tabindex="-1"></a>df <span class="co"># is not tidy</span></span>
<span id="cb243-196"><a href="#cb243-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-197"><a href="#cb243-197" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-198"><a href="#cb243-198" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;Show output&lt;/summary&gt;</span>
<span id="cb243-199"><a href="#cb243-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-200"><a href="#cb243-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb243-201"><a href="#cb243-201" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- read.csv("Data/population.csv")</span></span>
<span id="cb243-202"><a href="#cb243-202" aria-hidden="true" tabindex="-1"></a><span class="in">df # is not tidy</span></span>
<span id="cb243-203"><a href="#cb243-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-204"><a href="#cb243-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-205"><a href="#cb243-205" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-206"><a href="#cb243-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-207"><a href="#cb243-207" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-208"><a href="#cb243-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-209"><a href="#cb243-209" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb243-210"><a href="#cb243-210" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb243-211"><a href="#cb243-211" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(df, <span class="at">cols=</span><span class="sc">-</span>year, <span class="at">names_to=</span><span class="st">"city"</span>, <span class="at">values_to=</span><span class="st">"pop"</span>)</span>
<span id="cb243-212"><a href="#cb243-212" aria-hidden="true" tabindex="-1"></a>df <span class="co">#is tidy</span></span>
<span id="cb243-213"><a href="#cb243-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-214"><a href="#cb243-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-215"><a href="#cb243-215" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-216"><a href="#cb243-216" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;Show output&lt;/summary&gt;</span>
<span id="cb243-217"><a href="#cb243-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-218"><a href="#cb243-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE}</span></span>
<span id="cb243-219"><a href="#cb243-219" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb243-220"><a href="#cb243-220" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- pivot_longer(df, cols=-year, names_to="city", values_to="pop")</span></span>
<span id="cb243-221"><a href="#cb243-221" aria-hidden="true" tabindex="-1"></a><span class="in">df #is tidy</span></span>
<span id="cb243-222"><a href="#cb243-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-223"><a href="#cb243-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-224"><a href="#cb243-224" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-225"><a href="#cb243-225" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-226"><a href="#cb243-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-227"><a href="#cb243-227" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb243-228"><a href="#cb243-228" aria-hidden="true" tabindex="-1"></a><span class="co"># is not tidy</span></span>
<span id="cb243-229"><a href="#cb243-229" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(df, <span class="at">names_from=</span><span class="st">"city"</span>, <span class="at">values_from=</span><span class="st">"pop"</span>)</span>
<span id="cb243-230"><a href="#cb243-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-231"><a href="#cb243-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-232"><a href="#cb243-232" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-233"><a href="#cb243-233" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;Show output&lt;/summary&gt;</span>
<span id="cb243-234"><a href="#cb243-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-235"><a href="#cb243-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE}</span></span>
<span id="cb243-236"><a href="#cb243-236" aria-hidden="true" tabindex="-1"></a><span class="in"># is not tidy</span></span>
<span id="cb243-237"><a href="#cb243-237" aria-hidden="true" tabindex="-1"></a><span class="in">pivot_wider(df, names_from="city", values_from="pop")</span></span>
<span id="cb243-238"><a href="#cb243-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-239"><a href="#cb243-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-240"><a href="#cb243-240" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-241"><a href="#cb243-241" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-242"><a href="#cb243-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-243"><a href="#cb243-243" aria-hidden="true" tabindex="-1"></a>You can find more information on data import and <span class="co">[</span><span class="ot">tidyness</span><span class="co">](https://garrettgman.github.io/tidying/)</span> on the <span class="co">[</span><span class="ot">data-import cheatsheet</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf)</span> and on the <span class="co">[</span><span class="ot">tidyr</span><span class="co">](http://www.sthda.com/english/wiki/tidyr-crucial-step-reshaping-data-with-r-for-easier-analyses)</span> package.</span>
<span id="cb243-244"><a href="#cb243-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-245"><a href="#cb243-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-246"><a href="#cb243-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r pivotgif, echo = FALSE, fig.cap = "Understanding long and wide data with an animation. Source: [tidyexplain](https://github.com/gadenbuie/tidyexplain)", fig.align="center", out.width="70%"}</span></span>
<span id="cb243-247"><a href="#cb243-247" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics('./Plots/tidyr-pivoting.gif')</span></span>
<span id="cb243-248"><a href="#cb243-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-249"><a href="#cb243-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-250"><a href="#cb243-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-251"><a href="#cb243-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-252"><a href="#cb243-252" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tibbles</span></span>
<span id="cb243-253"><a href="#cb243-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-254"><a href="#cb243-254" aria-hidden="true" tabindex="-1"></a>A <span class="in">`tibble`</span>{.R} is an enhanced version of the <span class="in">`data.frame`</span>{.R} provided by the <span class="in">`tibble`</span> package (which is part of the <span class="in">`tidyverse`</span>). The main advantage of <span class="in">`tibble`</span>{.R} is that it has easier initialization and nicer printing than <span class="in">`data.frame`</span>{.R}. </span>
<span id="cb243-255"><a href="#cb243-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-256"><a href="#cb243-256" aria-hidden="true" tabindex="-1"></a>Moreover, the performance are also enhanced for the reading from files with <span class="in">`read_csv()`</span>{.R}, <span class="in">`read_tsv()`</span>{.R}, <span class="in">`read_table()`</span>{.R} and <span class="in">`read_delim()`</span>{.R} that do the same things as their <span class="in">`read.xx()`</span> counterparts and return a <span class="in">`tibble`</span>. Otherwise, the handling is basically the same.</span>
<span id="cb243-257"><a href="#cb243-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-258"><a href="#cb243-258" aria-hidden="true" tabindex="-1"></a>More on tibbles <span class="co">[</span><span class="ot">here</span><span class="co">](https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html)</span>.</span>
<span id="cb243-259"><a href="#cb243-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-260"><a href="#cb243-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE}</span></span>
<span id="cb243-261"><a href="#cb243-261" aria-hidden="true" tabindex="-1"></a><span class="in">rm(x)</span></span>
<span id="cb243-262"><a href="#cb243-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-263"><a href="#cb243-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-264"><a href="#cb243-264" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Note that when initializing <span class="in">`tibble`</span>s, the construction is iterative. It means that when creating a second column, one can refer to the first one that was created. This does't work with <span class="in">`data.frame`</span>s.</span>
<span id="cb243-265"><a href="#cb243-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-266"><a href="#cb243-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE, warnings=FALSE, message=FALSE}</span></span>
<span id="cb243-267"><a href="#cb243-267" aria-hidden="true" tabindex="-1"></a><span class="in"># won't work unless a `x` vector was created before</span></span>
<span id="cb243-268"><a href="#cb243-268" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(x=runif(1e3), y=cumsum(x)) </span></span>
<span id="cb243-269"><a href="#cb243-269" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb243-270"><a href="#cb243-270" aria-hidden="true" tabindex="-1"></a><span class="in">tib &lt;- tibble(x=runif(1e3), y=cumsum(x))</span></span>
<span id="cb243-271"><a href="#cb243-271" aria-hidden="true" tabindex="-1"></a><span class="in">tib</span></span>
<span id="cb243-272"><a href="#cb243-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-273"><a href="#cb243-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-274"><a href="#cb243-274" aria-hidden="true" tabindex="-1"></a>:::{.callout-warning}</span>
<span id="cb243-275"><a href="#cb243-275" aria-hidden="true" tabindex="-1"></a><span class="fu">## Attention</span></span>
<span id="cb243-276"><a href="#cb243-276" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb243-277"><a href="#cb243-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-278"><a href="#cb243-278" aria-hidden="true" tabindex="-1"></a><span class="in">`Tibble`</span>s are quite strict about subsetting. <span class="in">`[`</span> always returns another <span class="in">`tibble`</span>. Contrast this with a data frame: sometimes <span class="in">`[`</span> returns a data frame and sometimes it just returns a vector:</span>
<span id="cb243-281"><a href="#cb243-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-282"><a href="#cb243-282" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tib[[<span class="dv">1</span>]]) <span class="co"># is a vector</span></span>
<span id="cb243-283"><a href="#cb243-283" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tib[,<span class="dv">1</span>])  <span class="co"># is a tibble</span></span>
<span id="cb243-284"><a href="#cb243-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-285"><a href="#cb243-285" aria-hidden="true" tabindex="-1"></a>Unless you want to get a <span class="in">`tibble`</span>, I recommend always using the <span class="in">`$`</span> notation when you want to get a column as a vector to avoid problems.</span>
<span id="cb243-286"><a href="#cb243-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-287"><a href="#cb243-287" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Another interesting feature of <span class="in">`tibble`</span>s is that their columns can contain vectors, like usual, but also lists of any R objects like other tibbles, <span class="in">`nls()`</span>{.R} objects, etc. This is called "nesting", and you can nest and un-nest <span class="in">`tibble`</span>s using these explicit functions:</span>
<span id="cb243-288"><a href="#cb243-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-289"><a href="#cb243-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb243-290"><a href="#cb243-290" aria-hidden="true" tabindex="-1"></a><span class="in">tib1 &lt;- tibble(x=1:3, y=1:3)</span></span>
<span id="cb243-291"><a href="#cb243-291" aria-hidden="true" tabindex="-1"></a><span class="in">tib2 &lt;- tibble(x=1:5, y=1:5)</span></span>
<span id="cb243-292"><a href="#cb243-292" aria-hidden="true" tabindex="-1"></a><span class="in">tib  &lt;- tibble(number=1:2, data=list(tib1, tib2))</span></span>
<span id="cb243-293"><a href="#cb243-293" aria-hidden="true" tabindex="-1"></a><span class="in">tib</span></span>
<span id="cb243-294"><a href="#cb243-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-295"><a href="#cb243-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-298"><a href="#cb243-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-299"><a href="#cb243-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-excel-nested</span></span>
<span id="cb243-300"><a href="#cb243-300" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb243-301"><a href="#cb243-301" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Excel equivalent to a nested `tibble`."</span></span>
<span id="cb243-302"><a href="#cb243-302" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: 50%</span></span>
<span id="cb243-303"><a href="#cb243-303" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"./Plots/excel-nested.png"</span>)</span>
<span id="cb243-304"><a href="#cb243-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-305"><a href="#cb243-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-306"><a href="#cb243-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb243-307"><a href="#cb243-307" aria-hidden="true" tabindex="-1"></a><span class="in">tib_unnested &lt;- unnest(tib, data)</span></span>
<span id="cb243-308"><a href="#cb243-308" aria-hidden="true" tabindex="-1"></a><span class="in">tib_unnested</span></span>
<span id="cb243-309"><a href="#cb243-309" aria-hidden="true" tabindex="-1"></a><span class="in">tib_unnested_renested &lt;- nest(tib_unnested, data = c(number, y))</span></span>
<span id="cb243-310"><a href="#cb243-310" aria-hidden="true" tabindex="-1"></a><span class="in">tib_unnested_renested</span></span>
<span id="cb243-311"><a href="#cb243-311" aria-hidden="true" tabindex="-1"></a><span class="in">tib_unnested_renested$data # The `data` column is a list</span></span>
<span id="cb243-312"><a href="#cb243-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-313"><a href="#cb243-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-314"><a href="#cb243-314" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb243-315"><a href="#cb243-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-316"><a href="#cb243-316" aria-hidden="true" tabindex="-1"></a><span class="fu">## Operations in the tidyverse</span></span>
<span id="cb243-317"><a href="#cb243-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-318"><a href="#cb243-318" aria-hidden="true" tabindex="-1"></a>In the end, base R and the <span class="in">`tidyverse`</span> package provide many efficient functions to perform most of the tasks you would want to perform recursively, thus allowing avoiding explicit for loops (that are slow).</span>
<span id="cb243-319"><a href="#cb243-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-320"><a href="#cb243-320" aria-hidden="true" tabindex="-1"></a>Here are some examples, and you will find much more <span class="co">[</span><span class="ot">here</span><span class="co">](https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html)</span>. Take a look at the cheatsheets on <span class="co">[</span><span class="ot">tidyr</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf)</span> and on <span class="co">[</span><span class="ot">dplyr</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/data-transformation.pdf)</span>, it's really helpful. </span>
<span id="cb243-321"><a href="#cb243-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-322"><a href="#cb243-322" aria-hidden="true" tabindex="-1"></a>Let's work on this <span class="in">`tibble`</span>:</span>
<span id="cb243-323"><a href="#cb243-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-324"><a href="#cb243-324" aria-hidden="true" tabindex="-1"></a><span class="in"># Let's create a random tibble</span></span>
<span id="cb243-325"><a href="#cb243-325" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb243-326"><a href="#cb243-326" aria-hidden="true" tabindex="-1"></a><span class="in">N &lt;- 500</span></span>
<span id="cb243-327"><a href="#cb243-327" aria-hidden="true" tabindex="-1"></a><span class="in">dt &lt;- tibble(x     = rep(runif(N, -1, 1), 3), </span></span>
<span id="cb243-328"><a href="#cb243-328" aria-hidden="true" tabindex="-1"></a><span class="in">             y     = runif(N*3, -1, 1), </span></span>
<span id="cb243-329"><a href="#cb243-329" aria-hidden="true" tabindex="-1"></a><span class="in">             signx = ifelse(x&gt;0, "positive", "negative"),</span></span>
<span id="cb243-330"><a href="#cb243-330" aria-hidden="true" tabindex="-1"></a><span class="in">             signy = ifelse(y&gt;0, "positive", "negative")</span></span>
<span id="cb243-331"><a href="#cb243-331" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb243-332"><a href="#cb243-332" aria-hidden="true" tabindex="-1"></a><span class="in">dt</span></span>
<span id="cb243-333"><a href="#cb243-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-334"><a href="#cb243-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-335"><a href="#cb243-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-336"><a href="#cb243-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### The pipe operator</span></span>
<span id="cb243-337"><a href="#cb243-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-338"><a href="#cb243-338" aria-hidden="true" tabindex="-1"></a>In the following, we will introduce the pipe operator <span class="in">`|&gt;`</span>{.R}, that was introduced in the version 4.1 of R.</span>
<span id="cb243-339"><a href="#cb243-339" aria-hidden="true" tabindex="-1"></a>This operator allows a clear syntax for successive operations, as "what is on the left of the operator is given as first argument of what is on the right". It is thus a good habit to write each operation on a separate line to facilitate the reading. This is particularly helpful when performing multiple nested operations. For example, <span class="in">`summary(head(tail(dt),2))`</span>{.R}, which is hard to read, would translate to:</span>
<span id="cb243-340"><a href="#cb243-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-341"><a href="#cb243-341" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb243-342"><a href="#cb243-342" aria-hidden="true" tabindex="-1"></a>dt <span class="sc">|&gt;</span> </span>
<span id="cb243-343"><a href="#cb243-343" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tail</span>() <span class="sc">|&gt;</span> </span>
<span id="cb243-344"><a href="#cb243-344" aria-hidden="true" tabindex="-1"></a>    <span class="fu">head</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb243-345"><a href="#cb243-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>()</span>
<span id="cb243-346"><a href="#cb243-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-347"><a href="#cb243-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-348"><a href="#cb243-348" aria-hidden="true" tabindex="-1"></a>Note that before the 4.1 version of R, the pipe operator was only present thanks to the <span class="in">`magrittr`</span> package, and was written <span class="in">`%&gt;%`</span>{.R}. In <span class="in">`magrittr`</span>'s pipe, retrieving the piped object is done with the operator <span class="in">`.`</span>, while it is done with the operator <span class="in">`_`</span> in base R's.</span>
<span id="cb243-349"><a href="#cb243-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-350"><a href="#cb243-350" aria-hidden="true" tabindex="-1"></a>Silly example:</span>
<span id="cb243-351"><a href="#cb243-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-352"><a href="#cb243-352" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE}</span></span>
<span id="cb243-353"><a href="#cb243-353" aria-hidden="true" tabindex="-1"></a><span class="in">"Hello" |&gt; gsub("o", "e") # replace the substring "Hello" by "o" in string "e"</span></span>
<span id="cb243-354"><a href="#cb243-354" aria-hidden="true" tabindex="-1"></a><span class="in">"Hello" |&gt; gsub("o", "e", x=_) # replace the substring "o" by "e" in string "Hello"</span></span>
<span id="cb243-355"><a href="#cb243-355" aria-hidden="true" tabindex="-1"></a><span class="in">"Hello" %&gt;% gsub("o", "e") # replace the substring "Hello" by "o" in string "e"</span></span>
<span id="cb243-356"><a href="#cb243-356" aria-hidden="true" tabindex="-1"></a><span class="in"># /!\ In base R pipe, the '_' needs to  be for a named argument, </span></span>
<span id="cb243-357"><a href="#cb243-357" aria-hidden="true" tabindex="-1"></a><span class="in"># while it is not necessary for the '%&gt;%' pipe</span></span>
<span id="cb243-358"><a href="#cb243-358" aria-hidden="true" tabindex="-1"></a><span class="in">"Hello" %&gt;% gsub("o", "e", .) # replace the substring "o" by "e" in string "Hello"</span></span>
<span id="cb243-359"><a href="#cb243-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-360"><a href="#cb243-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-361"><a href="#cb243-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-362"><a href="#cb243-362" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sampling data</span></span>
<span id="cb243-363"><a href="#cb243-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-364"><a href="#cb243-364" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; slice(1:3)  # by index</span></span>
<span id="cb243-365"><a href="#cb243-365" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; slice_sample(n=3) # randomly</span></span>
<span id="cb243-366"><a href="#cb243-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-367"><a href="#cb243-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-368"><a href="#cb243-368" aria-hidden="true" tabindex="-1"></a><span class="fu">### Operations on groups of a variable</span></span>
<span id="cb243-369"><a href="#cb243-369" aria-hidden="true" tabindex="-1"></a><span class="in">`group_by(column)`</span>{.R} groups by similar values of the wanted column(s) and performs the next operations on each element of the group successively.</span>
<span id="cb243-370"><a href="#cb243-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-371"><a href="#cb243-371" aria-hidden="true" tabindex="-1"></a>Alternatively, you can use the parameter <span class="in">`by=column`</span>{.R} or <span class="in">`.by=column`</span>{.R} in the functions you want to use on groups. The difference between <span class="in">`group_by(column)`</span>{.R} and <span class="in">`.by=column`</span>{.R} is that after <span class="in">`group_by(column)`</span>{.R}, the tibble stays grouped – so an <span class="in">`ungroup()`</span>{.R} is needed to remove the grouping.</span>
<span id="cb243-372"><a href="#cb243-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-373"><a href="#cb243-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-374"><a href="#cb243-374" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; </span></span>
<span id="cb243-375"><a href="#cb243-375" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(signx)</span></span>
<span id="cb243-376"><a href="#cb243-376" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; </span></span>
<span id="cb243-377"><a href="#cb243-377" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(signx) |&gt; </span></span>
<span id="cb243-378"><a href="#cb243-378" aria-hidden="true" tabindex="-1"></a><span class="in">    slice_sample(n=3)</span></span>
<span id="cb243-379"><a href="#cb243-379" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; </span></span>
<span id="cb243-380"><a href="#cb243-380" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(signx, signy) |&gt; </span></span>
<span id="cb243-381"><a href="#cb243-381" aria-hidden="true" tabindex="-1"></a><span class="in">    slice_sample(n=3)</span></span>
<span id="cb243-382"><a href="#cb243-382" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; </span></span>
<span id="cb243-383"><a href="#cb243-383" aria-hidden="true" tabindex="-1"></a><span class="in">    slice_sample(by = c(signx, signy), </span></span>
<span id="cb243-384"><a href="#cb243-384" aria-hidden="true" tabindex="-1"></a><span class="in">                 n  = 3)</span></span>
<span id="cb243-385"><a href="#cb243-385" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; </span></span>
<span id="cb243-386"><a href="#cb243-386" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(signx, signy) |&gt; </span></span>
<span id="cb243-387"><a href="#cb243-387" aria-hidden="true" tabindex="-1"></a><span class="in">    slice_sample(n=3) |&gt; </span></span>
<span id="cb243-388"><a href="#cb243-388" aria-hidden="true" tabindex="-1"></a><span class="in">    ungroup()</span></span>
<span id="cb243-389"><a href="#cb243-389" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-390"><a href="#cb243-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-391"><a href="#cb243-391" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary by groups of a variable</span></span>
<span id="cb243-392"><a href="#cb243-392" aria-hidden="true" tabindex="-1"></a><span class="in">`summarise()`</span>{.R} returns a **single value** for each element of the groups.</span>
<span id="cb243-393"><a href="#cb243-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-394"><a href="#cb243-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-395"><a href="#cb243-395" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; </span></span>
<span id="cb243-396"><a href="#cb243-396" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(signx) |&gt; </span></span>
<span id="cb243-397"><a href="#cb243-397" aria-hidden="true" tabindex="-1"></a><span class="in">    summarise(count  = n(),</span></span>
<span id="cb243-398"><a href="#cb243-398" aria-hidden="true" tabindex="-1"></a><span class="in">              mean_x = mean(x), </span></span>
<span id="cb243-399"><a href="#cb243-399" aria-hidden="true" tabindex="-1"></a><span class="in">              sd_x   = sd(x))</span></span>
<span id="cb243-400"><a href="#cb243-400" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; </span></span>
<span id="cb243-401"><a href="#cb243-401" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(signx, signy) |&gt; </span></span>
<span id="cb243-402"><a href="#cb243-402" aria-hidden="true" tabindex="-1"></a><span class="in">    summarise(count  = n(),</span></span>
<span id="cb243-403"><a href="#cb243-403" aria-hidden="true" tabindex="-1"></a><span class="in">              mean_x = mean(x), </span></span>
<span id="cb243-404"><a href="#cb243-404" aria-hidden="true" tabindex="-1"></a><span class="in">              mean_y = mean(y))</span></span>
<span id="cb243-405"><a href="#cb243-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-406"><a href="#cb243-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-407"><a href="#cb243-407" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sorting</span></span>
<span id="cb243-408"><a href="#cb243-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-409"><a href="#cb243-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-410"><a href="#cb243-410" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; arrange(x)</span></span>
<span id="cb243-411"><a href="#cb243-411" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; arrange(x, desc(y))</span></span>
<span id="cb243-412"><a href="#cb243-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-413"><a href="#cb243-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-414"><a href="#cb243-414" aria-hidden="true" tabindex="-1"></a><span class="fu">### Merge tables column-wise</span></span>
<span id="cb243-415"><a href="#cb243-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-416"><a href="#cb243-416" aria-hidden="true" tabindex="-1"></a>At least one column with the **exact** same name must be present in each table to use the <span class="in">`xx_join()`</span>{.R} functions. There are more possibilities than <span class="in">`inner_join()`</span>{.R} that I show here, see the help for more information.</span>
<span id="cb243-417"><a href="#cb243-417" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-418"><a href="#cb243-418" aria-hidden="true" tabindex="-1"></a><span class="in">dt2 &lt;- tibble(signx=c("positive","positive","negative","negative"), </span></span>
<span id="cb243-419"><a href="#cb243-419" aria-hidden="true" tabindex="-1"></a><span class="in">              signy=c("positive","negative","positive","negative"), </span></span>
<span id="cb243-420"><a href="#cb243-420" aria-hidden="true" tabindex="-1"></a><span class="in">              value=c(TRUE, FALSE, FALSE, TRUE))</span></span>
<span id="cb243-421"><a href="#cb243-421" aria-hidden="true" tabindex="-1"></a><span class="in">dt2</span></span>
<span id="cb243-422"><a href="#cb243-422" aria-hidden="true" tabindex="-1"></a><span class="in">inner_join(dt, dt2)</span></span>
<span id="cb243-423"><a href="#cb243-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-424"><a href="#cb243-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-425"><a href="#cb243-425" aria-hidden="true" tabindex="-1"></a><span class="fu">### Merge tables row-wise</span></span>
<span id="cb243-426"><a href="#cb243-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-427"><a href="#cb243-427" aria-hidden="true" tabindex="-1"></a>This works even if there are missing rows.</span>
<span id="cb243-428"><a href="#cb243-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-429"><a href="#cb243-429" aria-hidden="true" tabindex="-1"></a><span class="in">dt3 &lt;- tibble(a=1:3, b=3:5, c=6:8)</span></span>
<span id="cb243-430"><a href="#cb243-430" aria-hidden="true" tabindex="-1"></a><span class="in">dt4 &lt;- tibble(a=3:1, c=3:5)</span></span>
<span id="cb243-431"><a href="#cb243-431" aria-hidden="true" tabindex="-1"></a><span class="in">bind_rows(dt3, dt4)</span></span>
<span id="cb243-432"><a href="#cb243-432" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-433"><a href="#cb243-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-434"><a href="#cb243-434" aria-hidden="true" tabindex="-1"></a><span class="fu">### Add/modify a column</span></span>
<span id="cb243-435"><a href="#cb243-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-436"><a href="#cb243-436" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span>{.R}, like <span class="in">`$`</span>{.R}, adds a column if it doesn't exist, and modifies it if it does.</span>
<span id="cb243-437"><a href="#cb243-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-438"><a href="#cb243-438" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; mutate(w=seq_along(x), z=sin(x))</span></span>
<span id="cb243-439"><a href="#cb243-439" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; mutate(x=seq_along(x))</span></span>
<span id="cb243-440"><a href="#cb243-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-441"><a href="#cb243-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-442"><a href="#cb243-442" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selecting columns</span></span>
<span id="cb243-443"><a href="#cb243-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-444"><a href="#cb243-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-445"><a href="#cb243-445" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; select(x)  # only x</span></span>
<span id="cb243-446"><a href="#cb243-446" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; select(-x) # all but x</span></span>
<span id="cb243-447"><a href="#cb243-447" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; select(starts_with("sign"))</span></span>
<span id="cb243-448"><a href="#cb243-448" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; select(contains("x"))</span></span>
<span id="cb243-449"><a href="#cb243-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-450"><a href="#cb243-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-451"><a href="#cb243-451" aria-hidden="true" tabindex="-1"></a><span class="fu">### Filtering columns</span></span>
<span id="cb243-452"><a href="#cb243-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-453"><a href="#cb243-453" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-454"><a href="#cb243-454" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; filter(signx=="positive")</span></span>
<span id="cb243-455"><a href="#cb243-455" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; filter(x&lt;0, y&gt;.1) # multiple filters can be applied at once</span></span>
<span id="cb243-456"><a href="#cb243-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-457"><a href="#cb243-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-458"><a href="#cb243-458" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reorder columns</span></span>
<span id="cb243-459"><a href="#cb243-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-460"><a href="#cb243-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-461"><a href="#cb243-461" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; relocate(y, .after = signy)</span></span>
<span id="cb243-462"><a href="#cb243-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-463"><a href="#cb243-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-464"><a href="#cb243-464" aria-hidden="true" tabindex="-1"></a><span class="fu">### Separate columns</span></span>
<span id="cb243-465"><a href="#cb243-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-466"><a href="#cb243-466" aria-hidden="true" tabindex="-1"></a>The separation is based on standard separators such as "-", "<span class="sc">\_</span>", ".", " ", etc. A single separator can be specified with the argument <span class="in">`sep`</span>, otherwise all separators are used. One must provide the resulting vector of new column names: if one value is <span class="in">`NA`</span>{.R}, this column will be discarded. Examples:</span>
<span id="cb243-467"><a href="#cb243-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-468"><a href="#cb243-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-469"><a href="#cb243-469" aria-hidden="true" tabindex="-1"></a><span class="in">dt5 &lt;- tibble(file=list.files(path="Exo/FTIR/Data/", pattern=".xls"))</span></span>
<span id="cb243-470"><a href="#cb243-470" aria-hidden="true" tabindex="-1"></a><span class="in">dt5</span></span>
<span id="cb243-471"><a href="#cb243-471" aria-hidden="true" tabindex="-1"></a><span class="in">dt5 |&gt; separate(file, c(NA, "sample", "temperature", NA), convert = TRUE)</span></span>
<span id="cb243-472"><a href="#cb243-472" aria-hidden="true" tabindex="-1"></a><span class="in">dt5 |&gt; separate(file, </span></span>
<span id="cb243-473"><a href="#cb243-473" aria-hidden="true" tabindex="-1"></a><span class="in">                c("name", "extension"), </span></span>
<span id="cb243-474"><a href="#cb243-474" aria-hidden="true" tabindex="-1"></a><span class="in">                sep = "\\.")</span></span>
<span id="cb243-475"><a href="#cb243-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-476"><a href="#cb243-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-477"><a href="#cb243-477" aria-hidden="true" tabindex="-1"></a><span class="fu">### Apply a function recursively on each element of a column</span></span>
<span id="cb243-478"><a href="#cb243-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-479"><a href="#cb243-479" aria-hidden="true" tabindex="-1"></a>Take a look at the <span class="co">[</span><span class="ot">cheatsheet on the `purrr` package</span><span class="co">](https://github.com/rstudio/cheatsheets/blob/main/purrr.pdf)</span> for more options and a visual help on the <span class="in">`map()`</span> family. I show here a use of <span class="in">`purrr::map(vector, function)`</span>{.R} that returns a list. <span class="in">`map(x, f)`</span>{.R} applies the function <span class="in">`f()`</span> to each element of the vector <span class="in">`x`</span>, putting the result in a separate element of a list: <span class="in">`map(x, f) -&gt; list(f(x1), f(x2), ... f(xn))`</span>{.R}. In case <span class="in">`f(xi)`</span> returns a single value, you might want to use <span class="in">`map_dbl()`</span> or <span class="in">`map_chr()`</span>, for example, that will return a vector of doubles or of characters, respectively.</span>
<span id="cb243-480"><a href="#cb243-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-481"><a href="#cb243-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-482"><a href="#cb243-482" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- c(pi, pi/3, pi/2)</span></span>
<span id="cb243-483"><a href="#cb243-483" aria-hidden="true" tabindex="-1"></a><span class="in">map(x, sin)     # returns a list</span></span>
<span id="cb243-484"><a href="#cb243-484" aria-hidden="true" tabindex="-1"></a><span class="in">x |&gt; map_dbl(sin) # returns a vector</span></span>
<span id="cb243-485"><a href="#cb243-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-486"><a href="#cb243-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-487"><a href="#cb243-487" aria-hidden="true" tabindex="-1"></a>Of course, in the above case, it's a stupid use of the power of <span class="in">`map()`</span>{.R}. A typical use case is when you want to read multiple files, for example:</span>
<span id="cb243-488"><a href="#cb243-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb243-489"><a href="#cb243-489" aria-hidden="true" tabindex="-1"></a><span class="in">dt6 &lt;- tibble(file=list.files(path="Exo/spectro2/Data", </span></span>
<span id="cb243-490"><a href="#cb243-490" aria-hidden="true" tabindex="-1"></a><span class="in">                              pattern = ".txt", </span></span>
<span id="cb243-491"><a href="#cb243-491" aria-hidden="true" tabindex="-1"></a><span class="in">                              full.names = TRUE)) |&gt; </span></span>
<span id="cb243-492"><a href="#cb243-492" aria-hidden="true" tabindex="-1"></a><span class="in">    slice(1:5) |&gt; </span></span>
<span id="cb243-493"><a href="#cb243-493" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(data = map(file, read_table, col_names = c("w", "Int"))) |&gt; </span></span>
<span id="cb243-494"><a href="#cb243-494" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(file = basename(file))</span></span>
<span id="cb243-495"><a href="#cb243-495" aria-hidden="true" tabindex="-1"></a><span class="in">dt6</span></span>
<span id="cb243-496"><a href="#cb243-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-497"><a href="#cb243-497" aria-hidden="true" tabindex="-1"></a>This is (almost) equivalent to:</span>
<span id="cb243-498"><a href="#cb243-498" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb243-499"><a href="#cb243-499" aria-hidden="true" tabindex="-1"></a><span class="in">dt6 &lt;- tibble(file=list.files(path="Exo/spectro2/Data", </span></span>
<span id="cb243-500"><a href="#cb243-500" aria-hidden="true" tabindex="-1"></a><span class="in">                              pattern = ".txt", </span></span>
<span id="cb243-501"><a href="#cb243-501" aria-hidden="true" tabindex="-1"></a><span class="in">                              full.names = TRUE)) |&gt; </span></span>
<span id="cb243-502"><a href="#cb243-502" aria-hidden="true" tabindex="-1"></a><span class="in">    slice(1:5) |&gt; </span></span>
<span id="cb243-503"><a href="#cb243-503" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(data = map(file, ~read_table(., col_names = c("w", "Int")))) |&gt; </span></span>
<span id="cb243-504"><a href="#cb243-504" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(file = basename(file))</span></span>
<span id="cb243-505"><a href="#cb243-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-506"><a href="#cb243-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-507"><a href="#cb243-507" aria-hidden="true" tabindex="-1"></a>You see that you can create the function directly within the call to map using the shortcut <span class="in">`map(vector, ~ function(.))`</span>{.R}. This is useful to provide more arguments to the function -- another solution is to write your own function before the call to <span class="in">`map()`</span>{.R} and then call this function in <span class="in">`map()`</span>{.R}.</span>
<span id="cb243-508"><a href="#cb243-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-509"><a href="#cb243-509" aria-hidden="true" tabindex="-1"></a>Note that in case you need more parameters, you can use <span class="in">`purrr::map2(vector1, vector2, ~function(.x, .y))`</span>{.R}, where <span class="in">`.x`</span> and <span class="in">`.y`</span> refer to <span class="in">`vector1`</span> and <span class="in">`vector2`</span>, respectively (it's always <span class="in">`.x`</span> and <span class="in">`.y`</span> whatever the name of <span class="in">`vector1`</span> and <span class="in">`vector2`</span>).</span>
<span id="cb243-512"><a href="#cb243-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-513"><a href="#cb243-513" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y=</span><span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>) <span class="sc">|&gt;</span> </span>
<span id="cb243-514"><a href="#cb243-514" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sum =</span> <span class="fu">map2_dbl</span>(x, y, sum))</span>
<span id="cb243-515"><a href="#cb243-515" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">a=</span><span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y=</span><span class="dv">5</span><span class="sc">:</span><span class="dv">7</span>), </span>
<span id="cb243-516"><a href="#cb243-516" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tibble</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">y=</span><span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>)), </span>
<span id="cb243-517"><a href="#cb243-517" aria-hidden="true" tabindex="-1"></a>       <span class="at">b=</span><span class="fu">list</span>(<span class="fu">tibble</span>(<span class="at">x=</span><span class="dv">10</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">y=</span><span class="dv">15</span><span class="sc">:</span><span class="dv">18</span>), </span>
<span id="cb243-518"><a href="#cb243-518" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tibble</span>(<span class="at">x=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,  <span class="at">y=</span><span class="sc">-</span><span class="dv">14</span><span class="sc">:-</span><span class="dv">17</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb243-519"><a href="#cb243-519" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">sumx =</span> <span class="fu">map2_dbl</span>(a, b, <span class="sc">~</span><span class="fu">sum</span>(.x<span class="sc">$</span>x, .y<span class="sc">$</span>x)),</span>
<span id="cb243-520"><a href="#cb243-520" aria-hidden="true" tabindex="-1"></a>           <span class="at">sumy =</span> <span class="fu">map2_dbl</span>(a, b, <span class="sc">~</span><span class="fu">sum</span>(.x<span class="sc">$</span>y, .y<span class="sc">$</span>y)))</span>
<span id="cb243-521"><a href="#cb243-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-522"><a href="#cb243-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-523"><a href="#cb243-523" aria-hidden="true" tabindex="-1"></a><span class="fu">### Nesting and un-nesting data</span></span>
<span id="cb243-524"><a href="#cb243-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-525"><a href="#cb243-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-526"><a href="#cb243-526" aria-hidden="true" tabindex="-1"></a><span class="in">dt7 &lt;- dt6 |&gt; </span></span>
<span id="cb243-527"><a href="#cb243-527" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(file = basename(file)) |&gt; </span></span>
<span id="cb243-528"><a href="#cb243-528" aria-hidden="true" tabindex="-1"></a><span class="in">    unnest(data)</span></span>
<span id="cb243-529"><a href="#cb243-529" aria-hidden="true" tabindex="-1"></a><span class="in">dt7</span></span>
<span id="cb243-530"><a href="#cb243-530" aria-hidden="true" tabindex="-1"></a><span class="in"># Nesting data per repeated values in a column (~equivalent to grouping)</span></span>
<span id="cb243-531"><a href="#cb243-531" aria-hidden="true" tabindex="-1"></a><span class="in">dt7 |&gt; nest(data=-file)</span></span>
<span id="cb243-532"><a href="#cb243-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-533"><a href="#cb243-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-534"><a href="#cb243-534" aria-hidden="true" tabindex="-1"></a><span class="fu">### Providing data to ggplot</span></span>
<span id="cb243-535"><a href="#cb243-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-536"><a href="#cb243-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb243-537"><a href="#cb243-537" aria-hidden="true" tabindex="-1"></a><span class="in">dt |&gt; </span></span>
<span id="cb243-538"><a href="#cb243-538" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(abs(y) &gt; 0.1) |&gt; </span></span>
<span id="cb243-539"><a href="#cb243-539" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x=x, y=y, color=signy))+</span></span>
<span id="cb243-540"><a href="#cb243-540" aria-hidden="true" tabindex="-1"></a><span class="in">        geom_point()</span></span>
<span id="cb243-541"><a href="#cb243-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-542"><a href="#cb243-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-543"><a href="#cb243-543" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises {#exo-df}</span></span>
<span id="cb243-544"><a href="#cb243-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-545"><a href="#cb243-545" aria-hidden="true" tabindex="-1"></a>Download the exercises and solutions from the following repositories, then create a Rstudio project from the unzipped folder:</span>
<span id="cb243-546"><a href="#cb243-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-547"><a href="#cb243-547" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Beginner exercises</span><span class="co">](https://github.com/colinbousige/R1-beginner)</span></span>
<span id="cb243-548"><a href="#cb243-548" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Advanced exercises</span><span class="co">](https://github.com/colinbousige/R2-advanced)</span></span>
<span id="cb243-549"><a href="#cb243-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-550"><a href="#cb243-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-551"><a href="#cb243-551" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb243-552"><a href="#cb243-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-553"><a href="#cb243-553" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-554"><a href="#cb243-554" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;**Exercise 1**&lt;/summary&gt;</span>
<span id="cb243-555"><a href="#cb243-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-556"><a href="#cb243-556" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create a 3 column <span class="in">`data.frame`</span>{.R} containing 10 random values, their sinus, and the sum of the two first columns.</span>
<span id="cb243-557"><a href="#cb243-557" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Print the 4 first lines of the table</span>
<span id="cb243-558"><a href="#cb243-558" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Print the second column</span>
<span id="cb243-559"><a href="#cb243-559" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Print the average of the third column</span>
<span id="cb243-560"><a href="#cb243-560" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using <span class="in">`plot(x,y)`</span>{.R} where <span class="in">`x`</span> and <span class="in">`y`</span> are vectors, plot the 2nd column as a function of the first</span>
<span id="cb243-561"><a href="#cb243-561" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Look into the function <span class="in">`write.table()`</span>{.R} to write a text file containing this <span class="in">`data.frame`</span>{.R}</span>
<span id="cb243-562"><a href="#cb243-562" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Do the all the same things with a <span class="in">`tibble`</span>{.R}</span>
<span id="cb243-563"><a href="#cb243-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-564"><a href="#cb243-564" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-565"><a href="#cb243-565" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;Solution&lt;/summary&gt;</span>
<span id="cb243-566"><a href="#cb243-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-567"><a href="#cb243-567" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE}</span></span>
<span id="cb243-568"><a href="#cb243-568" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a 3 column `data.frame`{.R} containing 10 random values, their sinus, </span></span>
<span id="cb243-569"><a href="#cb243-569" aria-hidden="true" tabindex="-1"></a><span class="in"># and the sum of the two first columns.</span></span>
<span id="cb243-570"><a href="#cb243-570" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- runif(10)</span></span>
<span id="cb243-571"><a href="#cb243-571" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- sin(x)</span></span>
<span id="cb243-572"><a href="#cb243-572" aria-hidden="true" tabindex="-1"></a><span class="in">z &lt;- x + y</span></span>
<span id="cb243-573"><a href="#cb243-573" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- data.frame(x=x, y=y, z=z)</span></span>
<span id="cb243-574"><a href="#cb243-574" aria-hidden="true" tabindex="-1"></a><span class="in"># Print the 4 first lines of the table</span></span>
<span id="cb243-575"><a href="#cb243-575" aria-hidden="true" tabindex="-1"></a><span class="in">head(df, 4)</span></span>
<span id="cb243-576"><a href="#cb243-576" aria-hidden="true" tabindex="-1"></a><span class="in"># Print the second column</span></span>
<span id="cb243-577"><a href="#cb243-577" aria-hidden="true" tabindex="-1"></a><span class="in">df[,2]</span></span>
<span id="cb243-578"><a href="#cb243-578" aria-hidden="true" tabindex="-1"></a><span class="in"># Print the average of the third column</span></span>
<span id="cb243-579"><a href="#cb243-579" aria-hidden="true" tabindex="-1"></a><span class="in">mean(df$z); mean(df[3]); mean(df[,3])</span></span>
<span id="cb243-580"><a href="#cb243-580" aria-hidden="true" tabindex="-1"></a><span class="in"># Using `plot(x,y)`{.R} where `x` and `y` are vectors, </span></span>
<span id="cb243-581"><a href="#cb243-581" aria-hidden="true" tabindex="-1"></a><span class="in"># plot the 2nd column as a function of the first</span></span>
<span id="cb243-582"><a href="#cb243-582" aria-hidden="true" tabindex="-1"></a><span class="in">plot(df[,1], df[,2])</span></span>
<span id="cb243-583"><a href="#cb243-583" aria-hidden="true" tabindex="-1"></a><span class="in">plot(df$x, df$y)</span></span>
<span id="cb243-584"><a href="#cb243-584" aria-hidden="true" tabindex="-1"></a><span class="in"># Look into the function `write.table()`{.R} to write a text file </span></span>
<span id="cb243-585"><a href="#cb243-585" aria-hidden="true" tabindex="-1"></a><span class="in"># containing this `data.frame`{.R}</span></span>
<span id="cb243-586"><a href="#cb243-586" aria-hidden="true" tabindex="-1"></a><span class="in">write.table(df, "Data/some_data.dat", quote = FALSE, row.names = FALSE)</span></span>
<span id="cb243-587"><a href="#cb243-587" aria-hidden="true" tabindex="-1"></a><span class="in"># # # # # # # # # # # # # # # # # </span></span>
<span id="cb243-588"><a href="#cb243-588" aria-hidden="true" tabindex="-1"></a><span class="in"># Tibble version</span></span>
<span id="cb243-589"><a href="#cb243-589" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb243-590"><a href="#cb243-590" aria-hidden="true" tabindex="-1"></a><span class="in">df_tib &lt;- tibble(a = runif(10), b = sin(a), c = a + b)</span></span>
<span id="cb243-591"><a href="#cb243-591" aria-hidden="true" tabindex="-1"></a><span class="in">head(df_tib, 4)</span></span>
<span id="cb243-592"><a href="#cb243-592" aria-hidden="true" tabindex="-1"></a><span class="in">df_tib[,2]; df_tib[[2]];</span></span>
<span id="cb243-593"><a href="#cb243-593" aria-hidden="true" tabindex="-1"></a><span class="in">mean(df_tib$c); mean(df_tib[3]); mean(df_tib[,3]); mean(df_tib[[3]])</span></span>
<span id="cb243-594"><a href="#cb243-594" aria-hidden="true" tabindex="-1"></a><span class="in">write.table(df_tib, "Data/some_data.dat", quote = FALSE, row.names = FALSE)</span></span>
<span id="cb243-595"><a href="#cb243-595" aria-hidden="true" tabindex="-1"></a><span class="in">plot(df_tib$a, df_tib$b)</span></span>
<span id="cb243-596"><a href="#cb243-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-597"><a href="#cb243-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-598"><a href="#cb243-598" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-599"><a href="#cb243-599" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-600"><a href="#cb243-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-601"><a href="#cb243-601" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-602"><a href="#cb243-602" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;**Exercise 2**&lt;/summary&gt;</span>
<span id="cb243-603"><a href="#cb243-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-604"><a href="#cb243-604" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Download the files:</span>
<span id="cb243-605"><a href="#cb243-605" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>&lt;a href="Data/rubis_01.txt" download target="_blank"&gt;rubis_01.txt&lt;/a&gt;</span>
<span id="cb243-606"><a href="#cb243-606" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>&lt;a href="Data/population.csv" download target="_blank"&gt;population.csv&lt;/a&gt;</span>
<span id="cb243-607"><a href="#cb243-607" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>&lt;a href="Data/FTIR_rocks.xlsx" download target="_blank"&gt;FTIR_rocks.xlsx&lt;/a&gt;</span>
<span id="cb243-608"><a href="#cb243-608" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load them into separate <span class="in">`data.frames`</span>{.R}. Look into the options of <span class="in">`read.table()`</span>{.R}, <span class="in">`read.csv()`</span>{.R}, <span class="in">`readxl::read_excel()`</span>{.R},  to get the proper data fields.</span>
<span id="cb243-609"><a href="#cb243-609" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Add column names to the data.frame containing <span class="in">`rubis_01.txt`</span>. </span>
<span id="cb243-610"><a href="#cb243-610" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Print their dimensions.</span>
<span id="cb243-611"><a href="#cb243-611" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Do the same things with tibbles.</span>
<span id="cb243-612"><a href="#cb243-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-613"><a href="#cb243-613" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-614"><a href="#cb243-614" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;Solution&lt;/summary&gt;</span>
<span id="cb243-615"><a href="#cb243-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-616"><a href="#cb243-616" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE, message=FALSE}</span></span>
<span id="cb243-617"><a href="#cb243-617" aria-hidden="true" tabindex="-1"></a><span class="in">rubis_01   &lt;- read.table("Data/rubis_01.txt", col.names = c("w", "intensity"))</span></span>
<span id="cb243-618"><a href="#cb243-618" aria-hidden="true" tabindex="-1"></a><span class="in">population &lt;- read.csv("Data/population.csv")</span></span>
<span id="cb243-619"><a href="#cb243-619" aria-hidden="true" tabindex="-1"></a><span class="in">FTIR_rocks &lt;- readxl::read_excel("Data/FTIR_rocks.xlsx")</span></span>
<span id="cb243-620"><a href="#cb243-620" aria-hidden="true" tabindex="-1"></a><span class="in">dim(rubis_01); names(rubis_01)</span></span>
<span id="cb243-621"><a href="#cb243-621" aria-hidden="true" tabindex="-1"></a><span class="in">dim(population); names(population)</span></span>
<span id="cb243-622"><a href="#cb243-622" aria-hidden="true" tabindex="-1"></a><span class="in">dim(FTIR_rocks); names(FTIR_rocks)</span></span>
<span id="cb243-623"><a href="#cb243-623" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb243-624"><a href="#cb243-624" aria-hidden="true" tabindex="-1"></a><span class="in">rubis_01 &lt;- read_table("Data/rubis_01.txt", col_names = c("w", "intensity"))</span></span>
<span id="cb243-625"><a href="#cb243-625" aria-hidden="true" tabindex="-1"></a><span class="in">population &lt;- read_csv("Data/population.csv")</span></span>
<span id="cb243-626"><a href="#cb243-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-627"><a href="#cb243-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-628"><a href="#cb243-628" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-629"><a href="#cb243-629" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-630"><a href="#cb243-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-631"><a href="#cb243-631" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-632"><a href="#cb243-632" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;**Exercise 3**&lt;/summary&gt;</span>
<span id="cb243-633"><a href="#cb243-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-634"><a href="#cb243-634" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Download the TGA data file &lt;a href="Data/ATG.txt" download target="_blank"&gt;ATG.txt&lt;/a&gt;</span>
<span id="cb243-635"><a href="#cb243-635" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load it into a <span class="in">`data.frame`</span>{.R}. Look into the options of <span class="in">`read.table()`</span>{.R} to get the proper data fields.</span>
<span id="cb243-636"><a href="#cb243-636" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Do the same with a tibble</span>
<span id="cb243-637"><a href="#cb243-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-638"><a href="#cb243-638" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-639"><a href="#cb243-639" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;Solution&lt;/summary&gt;</span>
<span id="cb243-640"><a href="#cb243-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-643"><a href="#cb243-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-644"><a href="#cb243-644" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Data/ATG.txt"</span>, </span>
<span id="cb243-645"><a href="#cb243-645" aria-hidden="true" tabindex="-1"></a>                <span class="at">skip=</span><span class="dv">12</span>,</span>
<span id="cb243-646"><a href="#cb243-646" aria-hidden="true" tabindex="-1"></a>                <span class="at">header=</span><span class="cn">FALSE</span>, </span>
<span id="cb243-647"><a href="#cb243-647" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrows=</span><span class="dv">4088</span>)</span>
<span id="cb243-648"><a href="#cb243-648" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Index"</span>, <span class="st">"t"</span>, <span class="st">"Ts"</span>, <span class="st">"Tr"</span>, <span class="st">"Value"</span>)</span>
<span id="cb243-649"><a href="#cb243-649" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb243-650"><a href="#cb243-650" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Data/ATG.txt"</span>, </span>
<span id="cb243-651"><a href="#cb243-651" aria-hidden="true" tabindex="-1"></a>                <span class="at">skip=</span><span class="dv">10</span>,</span>
<span id="cb243-652"><a href="#cb243-652" aria-hidden="true" tabindex="-1"></a>                <span class="at">comment.char=</span><span class="st">"["</span>,</span>
<span id="cb243-653"><a href="#cb243-653" aria-hidden="true" tabindex="-1"></a>                <span class="at">header=</span><span class="cn">TRUE</span>, </span>
<span id="cb243-654"><a href="#cb243-654" aria-hidden="true" tabindex="-1"></a>                <span class="at">nrows=</span><span class="dv">4088</span>)</span>
<span id="cb243-655"><a href="#cb243-655" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span>
<span id="cb243-656"><a href="#cb243-656" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb243-657"><a href="#cb243-657" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_table</span>(<span class="st">"Data/ATG.txt"</span>, </span>
<span id="cb243-658"><a href="#cb243-658" aria-hidden="true" tabindex="-1"></a>                <span class="at">skip    =</span> <span class="dv">10</span>,</span>
<span id="cb243-659"><a href="#cb243-659" aria-hidden="true" tabindex="-1"></a>                <span class="at">comment =</span> <span class="st">"["</span>) <span class="sc">|&gt;</span> </span>
<span id="cb243-660"><a href="#cb243-660" aria-hidden="true" tabindex="-1"></a>        <span class="fu">drop_na</span>()</span>
<span id="cb243-661"><a href="#cb243-661" aria-hidden="true" tabindex="-1"></a>d</span>
<span id="cb243-662"><a href="#cb243-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-663"><a href="#cb243-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-664"><a href="#cb243-664" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-665"><a href="#cb243-665" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-666"><a href="#cb243-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-667"><a href="#cb243-667" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-668"><a href="#cb243-668" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;**Exercise 4**&lt;/summary&gt;</span>
<span id="cb243-669"><a href="#cb243-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-670"><a href="#cb243-670" aria-hidden="true" tabindex="-1"></a>Download &lt;a href="Data/population.csv" download target="_blank"&gt;population.csv&lt;/a&gt; and load it into a <span class="in">`tibble`</span>{.R}.</span>
<span id="cb243-671"><a href="#cb243-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-672"><a href="#cb243-672" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What are the names of the columns?</span>
<span id="cb243-673"><a href="#cb243-673" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Are the data tidy? make the table tidy if needed</span>
<span id="cb243-674"><a href="#cb243-674" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create a subset containing the data for Montpellier</span>
<span id="cb243-675"><a href="#cb243-675" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>What is the max and min of population in this city?</span>
<span id="cb243-676"><a href="#cb243-676" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>The average population over time?</span>
<span id="cb243-677"><a href="#cb243-677" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the total population in 2012?</span>
<span id="cb243-678"><a href="#cb243-678" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the total population per year?</span>
<span id="cb243-679"><a href="#cb243-679" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What is the average population per city over the years?</span>
<span id="cb243-680"><a href="#cb243-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-681"><a href="#cb243-681" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-682"><a href="#cb243-682" aria-hidden="true" tabindex="-1"></a>&lt;summary&gt;Solution&lt;/summary&gt;</span>
<span id="cb243-683"><a href="#cb243-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-686"><a href="#cb243-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb243-687"><a href="#cb243-687" aria-hidden="true" tabindex="-1"></a><span class="co"># Download population.txt and load it into a `data.frame`{.R}.</span></span>
<span id="cb243-688"><a href="#cb243-688" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb243-689"><a href="#cb243-689" aria-hidden="true" tabindex="-1"></a>popul <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/population.csv"</span>)</span>
<span id="cb243-690"><a href="#cb243-690" aria-hidden="true" tabindex="-1"></a><span class="co"># What are the names of the columns and the dimension of the table?</span></span>
<span id="cb243-691"><a href="#cb243-691" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(popul); <span class="fu">dim</span>(popul)</span>
<span id="cb243-692"><a href="#cb243-692" aria-hidden="true" tabindex="-1"></a><span class="co"># Are the data tidy?</span></span>
<span id="cb243-693"><a href="#cb243-693" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(popul) <span class="co"># no</span></span>
<span id="cb243-694"><a href="#cb243-694" aria-hidden="true" tabindex="-1"></a>popul.tidy <span class="ot">&lt;-</span> popul <span class="sc">|&gt;</span> </span>
<span id="cb243-695"><a href="#cb243-695" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>year,</span>
<span id="cb243-696"><a href="#cb243-696" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">"city"</span>,</span>
<span id="cb243-697"><a href="#cb243-697" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"pop"</span></span>
<span id="cb243-698"><a href="#cb243-698" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb243-699"><a href="#cb243-699" aria-hidden="true" tabindex="-1"></a>popul.tidy</span>
<span id="cb243-700"><a href="#cb243-700" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset containing the data for Montpellier</span></span>
<span id="cb243-701"><a href="#cb243-701" aria-hidden="true" tabindex="-1"></a>mtp <span class="ot">&lt;-</span> <span class="fu">subset</span>(popul.tidy, city <span class="sc">==</span> <span class="st">"Montpellier"</span>)</span>
<span id="cb243-702"><a href="#cb243-702" aria-hidden="true" tabindex="-1"></a><span class="co"># I prefer the tidyverse version</span></span>
<span id="cb243-703"><a href="#cb243-703" aria-hidden="true" tabindex="-1"></a>mtp <span class="ot">&lt;-</span> popul.tidy <span class="sc">|&gt;</span> <span class="fu">filter</span>(city <span class="sc">==</span> <span class="st">"Montpellier"</span>)</span>
<span id="cb243-704"><a href="#cb243-704" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the max and min of population in this city?</span></span>
<span id="cb243-705"><a href="#cb243-705" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(mtp<span class="sc">$</span>pop)</span>
<span id="cb243-706"><a href="#cb243-706" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(mtp<span class="sc">$</span>pop)</span>
<span id="cb243-707"><a href="#cb243-707" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(mtp<span class="sc">$</span>pop)</span>
<span id="cb243-708"><a href="#cb243-708" aria-hidden="true" tabindex="-1"></a><span class="co"># The average population over time?</span></span>
<span id="cb243-709"><a href="#cb243-709" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(mtp<span class="sc">$</span>pop)</span>
<span id="cb243-710"><a href="#cb243-710" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the total population in 2012?</span></span>
<span id="cb243-711"><a href="#cb243-711" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(popul.tidy[popul.tidy<span class="sc">$</span>year <span class="sc">==</span> <span class="dv">2012</span>, <span class="st">"pop"</span>])</span>
<span id="cb243-712"><a href="#cb243-712" aria-hidden="true" tabindex="-1"></a>popul.tidy <span class="sc">|&gt;</span> </span>
<span id="cb243-713"><a href="#cb243-713" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year<span class="sc">==</span><span class="dv">2012</span>) <span class="sc">|&gt;</span> </span>
<span id="cb243-714"><a href="#cb243-714" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(pop) <span class="sc">|&gt;</span> </span>
<span id="cb243-715"><a href="#cb243-715" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb243-716"><a href="#cb243-716" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the total population per year?</span></span>
<span id="cb243-717"><a href="#cb243-717" aria-hidden="true" tabindex="-1"></a>popul.tidy <span class="sc">|&gt;</span> </span>
<span id="cb243-718"><a href="#cb243-718" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(year) <span class="sc">|&gt;</span> </span>
<span id="cb243-719"><a href="#cb243-719" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">pop_tot=</span><span class="fu">sum</span>(pop))</span>
<span id="cb243-720"><a href="#cb243-720" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the average population per city over the years?</span></span>
<span id="cb243-721"><a href="#cb243-721" aria-hidden="true" tabindex="-1"></a>popul.tidy <span class="sc">|&gt;</span> </span>
<span id="cb243-722"><a href="#cb243-722" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(city) <span class="sc">|&gt;</span> </span>
<span id="cb243-723"><a href="#cb243-723" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">pop_ave=</span><span class="fu">mean</span>(pop))</span>
<span id="cb243-724"><a href="#cb243-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-725"><a href="#cb243-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-726"><a href="#cb243-726" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-727"><a href="#cb243-727" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-728"><a href="#cb243-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-729"><a href="#cb243-729" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-730"><a href="#cb243-730" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;**Exercise 5**&lt;/summary&gt;</span>
<span id="cb243-731"><a href="#cb243-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-732"><a href="#cb243-732" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>First, load the <span class="in">`tidyverse`</span> and <span class="in">`lubridate`</span> package</span>
<span id="cb243-733"><a href="#cb243-733" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Load &lt;a href="Data/people1.csv" download target="_blank"&gt;people1.csv&lt;/a&gt; and &lt;a href="Data/people2.csv" download target="_blank"&gt;people2.csv&lt;/a&gt; into <span class="in">`pp1`</span> and <span class="in">`pp2`</span></span>
<span id="cb243-734"><a href="#cb243-734" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Create a new tibble <span class="in">`pp`</span> by using the pipe operator (<span class="in">`%&gt;%`</span>{.R}) and successively:</span>
<span id="cb243-735"><a href="#cb243-735" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>joining the two tibbles into one using <span class="in">`inner_join()`</span>{.R}</span>
<span id="cb243-736"><a href="#cb243-736" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>adding a column <span class="in">`age`</span> containing the age in years (use <span class="in">`lubridate::time_length(x, 'years')`</span>{.R} with x a time difference in days) by using <span class="in">`mutate()`</span>{.R}</span>
<span id="cb243-737"><a href="#cb243-737" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Display a summary of the table using <span class="in">`str()`</span>{.R}</span>
<span id="cb243-738"><a href="#cb243-738" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using <span class="in">`groupe_by()`</span>{.R} and <span class="in">`summarize()`</span>{.R}:</span>
<span id="cb243-739"><a href="#cb243-739" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Show the number of males and females in the table (use the counter <span class="in">`n()`</span>{.R})</span>
<span id="cb243-740"><a href="#cb243-740" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Show the average age per gender</span>
<span id="cb243-741"><a href="#cb243-741" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Show the average size per gender and institution</span>
<span id="cb243-742"><a href="#cb243-742" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Show the number of people from each country, sorted by descending population (<span class="in">`arrange()`</span>{.R})</span>
<span id="cb243-743"><a href="#cb243-743" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using <span class="in">`select()`</span>{.R}, display:</span>
<span id="cb243-744"><a href="#cb243-744" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>only the name and age columns</span>
<span id="cb243-745"><a href="#cb243-745" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>all but the name column</span>
<span id="cb243-746"><a href="#cb243-746" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using <span class="in">`filter()`</span>{.R}, show data only for</span>
<span id="cb243-747"><a href="#cb243-747" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Chinese people</span>
<span id="cb243-748"><a href="#cb243-748" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>From institution ECL and UCBL</span>
<span id="cb243-749"><a href="#cb243-749" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>People older than 22 </span>
<span id="cb243-750"><a href="#cb243-750" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>People with a <span class="in">`e`</span> in their name</span>
<span id="cb243-751"><a href="#cb243-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-752"><a href="#cb243-752" aria-hidden="true" tabindex="-1"></a>&lt;details&gt;</span>
<span id="cb243-753"><a href="#cb243-753" aria-hidden="true" tabindex="-1"></a>    &lt;summary&gt;Solution&lt;/summary&gt;</span>
<span id="cb243-754"><a href="#cb243-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-755"><a href="#cb243-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warnings=FALSE, message=FALSE}</span></span>
<span id="cb243-756"><a href="#cb243-756" aria-hidden="true" tabindex="-1"></a><span class="in"># First, load the `tidyverse` package</span></span>
<span id="cb243-757"><a href="#cb243-757" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb243-758"><a href="#cb243-758" aria-hidden="true" tabindex="-1"></a><span class="in"># Load people1.csv and people2.csv</span></span>
<span id="cb243-759"><a href="#cb243-759" aria-hidden="true" tabindex="-1"></a><span class="in">pp1  &lt;- read_csv("Data/people1.csv")</span></span>
<span id="cb243-760"><a href="#cb243-760" aria-hidden="true" tabindex="-1"></a><span class="in">pp2  &lt;- read_csv("Data/people2.csv")</span></span>
<span id="cb243-761"><a href="#cb243-761" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a new tibble `pp` by using the pipe operator (`%&gt;%`)</span></span>
<span id="cb243-762"><a href="#cb243-762" aria-hidden="true" tabindex="-1"></a><span class="in"># and successively:</span></span>
<span id="cb243-763"><a href="#cb243-763" aria-hidden="true" tabindex="-1"></a><span class="in"># - joining the two tibbles into one using `inner_join()`</span></span>
<span id="cb243-764"><a href="#cb243-764" aria-hidden="true" tabindex="-1"></a><span class="in"># - adding a column `age` containing the age in years </span></span>
<span id="cb243-765"><a href="#cb243-765" aria-hidden="true" tabindex="-1"></a><span class="in">#   (use lubridate's `time_length(x, 'years')` with x a time</span></span>
<span id="cb243-766"><a href="#cb243-766" aria-hidden="true" tabindex="-1"></a><span class="in">#   difference in days) by using `mutate()`</span></span>
<span id="cb243-767"><a href="#cb243-767" aria-hidden="true" tabindex="-1"></a><span class="in">pp &lt;- pp1 |&gt; </span></span>
<span id="cb243-768"><a href="#cb243-768" aria-hidden="true" tabindex="-1"></a><span class="in">        inner_join(pp2) |&gt; </span></span>
<span id="cb243-769"><a href="#cb243-769" aria-hidden="true" tabindex="-1"></a><span class="in">        mutate(age=time_length(today()-dateofbirth,'years'))</span></span>
<span id="cb243-770"><a href="#cb243-770" aria-hidden="true" tabindex="-1"></a><span class="in"># Display a summary of the table using `str()`</span></span>
<span id="cb243-771"><a href="#cb243-771" aria-hidden="true" tabindex="-1"></a><span class="in">str(pp)</span></span>
<span id="cb243-772"><a href="#cb243-772" aria-hidden="true" tabindex="-1"></a><span class="in"># Using `groupe_by()` and `summarize()`:</span></span>
<span id="cb243-773"><a href="#cb243-773" aria-hidden="true" tabindex="-1"></a><span class="in"># - Show the number of males and females in the table </span></span>
<span id="cb243-774"><a href="#cb243-774" aria-hidden="true" tabindex="-1"></a><span class="in">#   (use the counter `n()`)</span></span>
<span id="cb243-775"><a href="#cb243-775" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; </span></span>
<span id="cb243-776"><a href="#cb243-776" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(gender) |&gt; </span></span>
<span id="cb243-777"><a href="#cb243-777" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(count=n())</span></span>
<span id="cb243-778"><a href="#cb243-778" aria-hidden="true" tabindex="-1"></a><span class="in"># - Show the average age per gender</span></span>
<span id="cb243-779"><a href="#cb243-779" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; </span></span>
<span id="cb243-780"><a href="#cb243-780" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(gender) |&gt; </span></span>
<span id="cb243-781"><a href="#cb243-781" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(age=mean(age))</span></span>
<span id="cb243-782"><a href="#cb243-782" aria-hidden="true" tabindex="-1"></a><span class="in"># - Show the average size per gender and institution</span></span>
<span id="cb243-783"><a href="#cb243-783" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; </span></span>
<span id="cb243-784"><a href="#cb243-784" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(gender, institution) |&gt; </span></span>
<span id="cb243-785"><a href="#cb243-785" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(size=mean(size))</span></span>
<span id="cb243-786"><a href="#cb243-786" aria-hidden="true" tabindex="-1"></a><span class="in"># - Show the number of people from each country, </span></span>
<span id="cb243-787"><a href="#cb243-787" aria-hidden="true" tabindex="-1"></a><span class="in">#   sorted by descending population</span></span>
<span id="cb243-788"><a href="#cb243-788" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; </span></span>
<span id="cb243-789"><a href="#cb243-789" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(origin) |&gt; </span></span>
<span id="cb243-790"><a href="#cb243-790" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(count=n()) |&gt; </span></span>
<span id="cb243-791"><a href="#cb243-791" aria-hidden="true" tabindex="-1"></a><span class="in">    arrange(desc(count))</span></span>
<span id="cb243-792"><a href="#cb243-792" aria-hidden="true" tabindex="-1"></a><span class="in"># Using `select()`, display:</span></span>
<span id="cb243-793"><a href="#cb243-793" aria-hidden="true" tabindex="-1"></a><span class="in"># - only the name and age columns</span></span>
<span id="cb243-794"><a href="#cb243-794" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; select(c(name, age))</span></span>
<span id="cb243-795"><a href="#cb243-795" aria-hidden="true" tabindex="-1"></a><span class="in"># - all but the name column</span></span>
<span id="cb243-796"><a href="#cb243-796" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; select(-name)</span></span>
<span id="cb243-797"><a href="#cb243-797" aria-hidden="true" tabindex="-1"></a><span class="in"># Using `filter()`, show data only for</span></span>
<span id="cb243-798"><a href="#cb243-798" aria-hidden="true" tabindex="-1"></a><span class="in"># - Chinese people</span></span>
<span id="cb243-799"><a href="#cb243-799" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; filter(origin=='China')</span></span>
<span id="cb243-800"><a href="#cb243-800" aria-hidden="true" tabindex="-1"></a><span class="in"># - From institution ECL and UCBL</span></span>
<span id="cb243-801"><a href="#cb243-801" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; filter(institution %in% c('ECL', 'UCBL'))</span></span>
<span id="cb243-802"><a href="#cb243-802" aria-hidden="true" tabindex="-1"></a><span class="in"># - People older than 22 </span></span>
<span id="cb243-803"><a href="#cb243-803" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; filter(age&gt;22)</span></span>
<span id="cb243-804"><a href="#cb243-804" aria-hidden="true" tabindex="-1"></a><span class="in"># - People with a `e` in their name</span></span>
<span id="cb243-805"><a href="#cb243-805" aria-hidden="true" tabindex="-1"></a><span class="in">pp |&gt; filter(grepl('e',name))</span></span>
<span id="cb243-806"><a href="#cb243-806" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb243-807"><a href="#cb243-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-808"><a href="#cb243-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-809"><a href="#cb243-809" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb243-810"><a href="#cb243-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-811"><a href="#cb243-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-812"><a href="#cb243-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-813"><a href="#cb243-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-814"><a href="#cb243-814" aria-hidden="true" tabindex="-1"></a>----</span>
<span id="cb243-815"><a href="#cb243-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-816"><a href="#cb243-816" aria-hidden="true" tabindex="-1"></a>For more interesting exercises in the tidyverse, look at:</span>
<span id="cb243-817"><a href="#cb243-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-818"><a href="#cb243-818" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">CO2 emissions: data wrangling and ggplot2</span><span class="co">](Exo/co2/exercise.html)</span></span>
<span id="cb243-819"><a href="#cb243-819" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Religion and babies: data handling, ggplot2 and plotly</span><span class="co">](Exo/religion_babies/exercise.html)</span></span>
<span id="cb243-820"><a href="#cb243-820" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">COVID-19: data wrangling, ggplot2</span><span class="co">](Exo/covid/exercise.html)</span></span>
<span id="cb243-821"><a href="#cb243-821" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Nanoparticles statistics from SEM images: data wrangling, ggplot2 and fitting</span><span class="co">](Exo/SEM_particles/exercise.html)</span></span>
<span id="cb243-822"><a href="#cb243-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-823"><a href="#cb243-823" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-824"><a href="#cb243-824" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-825"><a href="#cb243-825" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-826"><a href="#cb243-826" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-827"><a href="#cb243-827" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-828"><a href="#cb243-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-829"><a href="#cb243-829" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-830"><a href="#cb243-830" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-831"><a href="#cb243-831" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-832"><a href="#cb243-832" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-833"><a href="#cb243-833" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb243-834"><a href="#cb243-834" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/colinbousige/rclass/blob/main/07-dataframes.qmd" class="toc-action"><i class="bi bi-github"></i>View source</a></li><li><a href="https://github.com/colinbousige/rclass/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>