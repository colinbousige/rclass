<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Reproducible data treatment with R - 6&nbsp; Data frames</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-reading_files.html" rel="next">
<link href="./06-vectors.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=google_analytics.html"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'google_analytics.html', { 'anonymize_ip': true});
</script>
</head>
<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data frames</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Reproducible data treatment with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/colinbousige/rclass" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-about.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About the class</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-stats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A little reminder on Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-getting_ready.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Getting ready</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-variables.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Variables, booleans and strings</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-vectors.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-dataframes.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data frames</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-reading_files.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reading/writing all kinds of files</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-lists.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Lists</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Functions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-conditions_loops.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Conditional actions and loops</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Plotting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-3d_plots.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">3D color plots</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-fitting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Fitting</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-rmarkdown.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing documents with Rmarkdown</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-shiny.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Graphical interfaces with Shiny</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-units.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Working with units and experimental errors</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-exercises.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">List of exercises</span></a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#defining-a-data.frame" id="toc-defining-a-data.frame" class="nav-link active" data-scroll-target="#defining-a-data.frame"><span class="toc-section-number">6.1</span>  Defining a data.frame</a>
  <ul class="collapse">
<li><a href="#defining-a-data.frame-from-vectors" id="toc-defining-a-data.frame-from-vectors" class="nav-link" data-scroll-target="#defining-a-data.frame-from-vectors"><span class="toc-section-number">6.1.1</span>  Defining a data.frame from vectors</a></li>
  <li><a href="#defining-a-data.frame-from-a-file" id="toc-defining-a-data.frame-from-a-file" class="nav-link" data-scroll-target="#defining-a-data.frame-from-a-file"><span class="toc-section-number">6.1.2</span>  Defining a data.frame from a file</a></li>
  </ul>
</li>
  <li><a href="#accessing-values" id="toc-accessing-values" class="nav-link" data-scroll-target="#accessing-values"><span class="toc-section-number">6.2</span>  Accessing values</a></li>
  <li>
<a href="#adding-columns-or-rows" id="toc-adding-columns-or-rows" class="nav-link" data-scroll-target="#adding-columns-or-rows"><span class="toc-section-number">6.3</span>  Adding columns or rows</a>
  <ul class="collapse">
<li><a href="#adding-columns" id="toc-adding-columns" class="nav-link" data-scroll-target="#adding-columns"><span class="toc-section-number">6.3.1</span>  Adding columns</a></li>
  <li><a href="#adding-rows" id="toc-adding-rows" class="nav-link" data-scroll-target="#adding-rows"><span class="toc-section-number">6.3.2</span>  Adding rows</a></li>
  <li><a href="#deleting-rowscolumns" id="toc-deleting-rowscolumns" class="nav-link" data-scroll-target="#deleting-rowscolumns"><span class="toc-section-number">6.3.3</span>  Deleting rows/columns</a></li>
  </ul>
</li>
  <li>
<a href="#tidy-up" id="toc-tidy-up" class="nav-link" data-scroll-target="#tidy-up"><span class="toc-section-number">6.4</span>  Tidy up!</a>
  <ul class="collapse">
<li><a href="#what-is-tidy-data" id="toc-what-is-tidy-data" class="nav-link" data-scroll-target="#what-is-tidy-data"><span class="toc-section-number">6.4.1</span>  What is tidy data?</a></li>
  <li><a href="#tibbles" id="toc-tibbles" class="nav-link" data-scroll-target="#tibbles"><span class="toc-section-number">6.4.2</span>  Tibbles</a></li>
  </ul>
</li>
  <li>
<a href="#operations-in-the-tidyverse" id="toc-operations-in-the-tidyverse" class="nav-link" data-scroll-target="#operations-in-the-tidyverse"><span class="toc-section-number">6.5</span>  Operations in the tidyverse</a>
  <ul class="collapse">
<li><a href="#the-pipe-operator" id="toc-the-pipe-operator" class="nav-link" data-scroll-target="#the-pipe-operator"><span class="toc-section-number">6.5.1</span>  The pipe operator</a></li>
  <li><a href="#sampling-data" id="toc-sampling-data" class="nav-link" data-scroll-target="#sampling-data"><span class="toc-section-number">6.5.2</span>  Sampling data</a></li>
  <li><a href="#operations-on-groups-of-a-variable" id="toc-operations-on-groups-of-a-variable" class="nav-link" data-scroll-target="#operations-on-groups-of-a-variable"><span class="toc-section-number">6.5.3</span>  Operations on groups of a variable</a></li>
  <li><a href="#summary-by-groups-of-a-variable" id="toc-summary-by-groups-of-a-variable" class="nav-link" data-scroll-target="#summary-by-groups-of-a-variable"><span class="toc-section-number">6.5.4</span>  Summary by groups of a variable</a></li>
  <li><a href="#sorting" id="toc-sorting" class="nav-link" data-scroll-target="#sorting"><span class="toc-section-number">6.5.5</span>  Sorting</a></li>
  <li><a href="#merge-tables-column-wise" id="toc-merge-tables-column-wise" class="nav-link" data-scroll-target="#merge-tables-column-wise"><span class="toc-section-number">6.5.6</span>  Merge tables column-wise</a></li>
  <li><a href="#merge-tables-row-wise" id="toc-merge-tables-row-wise" class="nav-link" data-scroll-target="#merge-tables-row-wise"><span class="toc-section-number">6.5.7</span>  Merge tables row-wise</a></li>
  <li><a href="#addmodify-a-column" id="toc-addmodify-a-column" class="nav-link" data-scroll-target="#addmodify-a-column"><span class="toc-section-number">6.5.8</span>  Add/modify a column</a></li>
  <li><a href="#selecting-columns" id="toc-selecting-columns" class="nav-link" data-scroll-target="#selecting-columns"><span class="toc-section-number">6.5.9</span>  Selecting columns</a></li>
  <li><a href="#filtering-columns" id="toc-filtering-columns" class="nav-link" data-scroll-target="#filtering-columns"><span class="toc-section-number">6.5.10</span>  Filtering columns</a></li>
  <li><a href="#reorder-columns" id="toc-reorder-columns" class="nav-link" data-scroll-target="#reorder-columns"><span class="toc-section-number">6.5.11</span>  Reorder columns</a></li>
  <li><a href="#separate-columns" id="toc-separate-columns" class="nav-link" data-scroll-target="#separate-columns"><span class="toc-section-number">6.5.12</span>  Separate columns</a></li>
  <li><a href="#apply-a-function-recursively-on-each-element-of-a-column" id="toc-apply-a-function-recursively-on-each-element-of-a-column" class="nav-link" data-scroll-target="#apply-a-function-recursively-on-each-element-of-a-column"><span class="toc-section-number">6.5.13</span>  Apply a function recursively on each element of a column</a></li>
  <li><a href="#nesting-and-un-nesting-data" id="toc-nesting-and-un-nesting-data" class="nav-link" data-scroll-target="#nesting-and-un-nesting-data"><span class="toc-section-number">6.5.14</span>  Nesting and un-nesting data</a></li>
  <li><a href="#providing-data-to-ggplot" id="toc-providing-data-to-ggplot" class="nav-link" data-scroll-target="#providing-data-to-ggplot"><span class="toc-section-number">6.5.15</span>  Providing data to ggplot</a></li>
  </ul>
</li>
  <li><a href="#exo-df" id="toc-exo-df" class="nav-link" data-scroll-target="#exo-df"><span class="toc-section-number">6.6</span>  Exercises</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/colinbousige/rclass/blob/main/07-dataframes.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/colinbousige/rclass/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block">
<span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data frames</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="defining-a-data.frame" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="defining-a-data.frame">
<span class="header-section-number">6.1</span> Defining a data.frame</h2>
<section id="defining-a-data.frame-from-vectors" class="level3" data-number="6.1.1"><h3 data-number="6.1.1" class="anchored" data-anchor-id="defining-a-data.frame-from-vectors">
<span class="header-section-number">6.1.1</span> Defining a data.frame from vectors</h3>
<p>In R, the principal object is <em>the data</em>. Hence the <code class="sourceCode r">data.frame</code> object, which is basically a table of vectors. A <code class="sourceCode r">data.frame</code> is a list presented under the form of a table – <em>i.e.</em> a spreadsheet. On a day-to-day basis, you will either define <code class="sourceCode r">data.frame</code> from existing vectors or other <code class="sourceCode r">data.frame</code>, or define a <code class="sourceCode r">data.frame</code> from a file (text, Excel…). In this example, we use <a href="Data/test.dat" download="" target="_blank">test.dat</a> and <a href="Data/test.xlsx" download="" target="_blank">test.xlsx</a>.</p>
<p>To define a <code>data.frame</code> from known vectors, we just have to do:</p>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>, <span class="va">pi</span>, length <span class="op">=</span> <span class="fl">6</span><span class="op">)</span> </span>
<span><span class="va">y</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="co"># df is a data.frame (a table)</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x             y
1 -3.1415927 -1.224647e-16
2 -1.8849556 -9.510565e-01
3 -0.6283185 -5.877853e-01
4  0.6283185  5.877853e-01
5  1.8849556  9.510565e-01
6  3.1415927  1.224647e-16</code></pre>
</div>
</div>
<p>Then some information about our table are readily accessible, like:</p>
<ul>
<li>The dimension, the number of rows and columns:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6 2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<ul>
<li>Print the first and last 3 values</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x             y
1 -3.1415927 -1.224647e-16
2 -1.8849556 -9.510565e-01
3 -0.6283185 -5.877853e-01</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          x            y
4 0.6283185 5.877853e-01
5 1.8849556 9.510565e-01
6 3.1415927 1.224647e-16</code></pre>
</div>
</div>
<ul>
<li>Print some information on <code>df</code>
</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6 obs. of  2 variables:
 $ x: num  -3.142 -1.885 -0.628 0.628 1.885 ...
 $ y: num  -1.22e-16 -9.51e-01 -5.88e-01 5.88e-01 9.51e-01 ...</code></pre>
</div>
</div>
<ul>
<li>Print some statistics on <code>df</code>
</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       x                y          
 Min.   :-3.142   Min.   :-0.9511  
 1st Qu.:-1.571   1st Qu.:-0.4408  
 Median : 0.000   Median : 0.0000  
 Mean   : 0.000   Mean   : 0.0000  
 3rd Qu.: 1.571   3rd Qu.: 0.4408  
 Max.   : 3.142   Max.   : 0.9511  </code></pre>
</div>
</div>
<p>If not defined when creating the <code>data.frame</code>, the column names will be by default the vector names. To specify your own column names, do it when creating the <code>data.frame</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>xxx <span class="op">=</span> <span class="va">x</span>, yyy <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        xxx           yyy
1 -3.141593 -1.224647e-16
2 -1.884956 -9.510565e-01</code></pre>
</div>
</div>
<p>Or, once it’s created, do it using <code class="sourceCode r"><span class="fu">names</span>()</code></p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "xxx" "yyy"</code></pre>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          X             Y
1 -3.141593 -1.224647e-16
2 -1.884956 -9.510565e-01</code></pre>
</div>
</div>
</section><section id="defining-a-data.frame-from-a-file" class="level3" data-number="6.1.2"><h3 data-number="6.1.2" class="anchored" data-anchor-id="defining-a-data.frame-from-a-file">
<span class="header-section-number">6.1.2</span> Defining a data.frame from a file</h3>
<p>Let’s say we have <code>test.dat</code> that looks like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bash code:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> Data/test.dat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>x   y
1   2
2   3</code></pre>
</div>
</div>
<ul>
<li>Then, to read this file into a <code>data.frame</code>, we will use <code class="sourceCode r"><span class="fu">read.table</span>()</code>. If you don’t specify that the file contains a header, <code class="sourceCode r"><span class="fu">read.table</span>()</code> will default to attributing column names that will be V1, V2, V3, etc:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  V1 V2
1  x  y
2  1  2
3  2  3</code></pre>
</div>
</div>
<ul>
<li>If your file contains column names, you will use first line as column names like so:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  x y
1 1 2
2 2 3</code></pre>
</div>
</div>
<ul>
<li>If you want to skip some lines before starting the reading, use <code>skip</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, skip<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  V1 V2
1  1  2
2  2  3</code></pre>
</div>
</div>
<ul>
<li>You can specify your own column names using <code>col.names</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/test.dat"</span>, skip<span class="op">=</span><span class="fl">1</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  A B
1 1 2
2 2 3</code></pre>
</div>
</div>
<ul>
<li><p>You can type <code><a href="https://rdrr.io/r/utils/read.table.html">?read.table</a></code> for more options.</p></li>
<li><p>Now, to read an Excel file, use the <code>readxl</code> library:</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span> <span class="co"># load readxl from tidyverse to read Excel files</span></span>
<span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, sheet<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
       x      y
   &lt;dbl&gt;  &lt;dbl&gt;
 1     1  5.21 
 2     2  6.55 
 3     3  3.71 
 4     4  0.216
 5     5  0.205
 6     6  4.60 
 7     7 10.3  
 8     8 12.9  
 9     9 11.1  
10    10  7.28 </code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/test.xlsx"</span>, sheet<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  hello  world   
  &lt;chr&gt;  &lt;chr&gt;   
1 ac     th      
2 asc    thh     
3 ascsa  dthdh   
4 ascacs dthtdhdh</code></pre>
</div>
</div>
<hr></section></section><section id="accessing-values" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="accessing-values">
<span class="header-section-number">6.2</span> Accessing values</h2>
<ul>
<li>Like with vectors, accessing values is done using the <code>[]</code> notation, except that here there are two indexes: <code>df[row, column]</code>:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6283185</code></pre>
</div>
</div>
<ul>
<li>In general however, what you want is to access a given column, by its index:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
</div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="co"># this is a vector too</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
</div>
</div>
<ul>
<li>Or, <strong>preferably</strong>, by its name using the <code>$</code> notation:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">X</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -3.1415927 -1.8849556 -0.6283185  0.6283185  1.8849556  3.1415927</code></pre>
</div>
</div>
<ul>
<li>Finally, you may want to apply filters on your table:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">X</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           X             Y
1 -3.1415927 -1.224647e-16
2 -1.8849556 -9.510565e-01
3 -0.6283185 -5.877853e-01</code></pre>
</div>
</div>
<ul>
<li>Using the function <code class="sourceCode r"><span class="fu">subset</span>()</code>, the conditions are applied on column names (no need for <code>df$col_name</code> here, while you need it in the above expression):</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">X</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         X            Y
5 1.884956 9.510565e-01
6 3.141593 1.224647e-16</code></pre>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">X</span><span class="op">&gt;</span><span class="fl">1</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         X
5 1.884956
6 3.141593</code></pre>
</div>
</div>
<hr></section><section id="adding-columns-or-rows" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="adding-columns-or-rows">
<span class="header-section-number">6.3</span> Adding columns or rows</h2>
<section id="adding-columns" class="level3" data-number="6.3.1"><h3 data-number="6.3.1" class="anchored" data-anchor-id="adding-columns">
<span class="header-section-number">6.3.1</span> Adding columns</h3>
<ul>
<li>To add a column, just attribute a value to an column that do not exist yet, it will be created:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Adding columns</span></span>
<span><span class="va">df</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x             y         z
1 -3.1415927 -1.224647e-16 9.8696044
2 -1.8849556 -9.510565e-01 3.5530576
3 -0.6283185 -5.877853e-01 0.3947842
4  0.6283185  5.877853e-01 0.3947842
5  1.8849556  9.510565e-01 3.5530576
6  3.1415927  1.224647e-16 9.8696044</code></pre>
</div>
</div>
<ul>
<li>You can also create a <code>data.frame</code> of a <code>data.frame</code>:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">df</span>, z<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span>, u<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x             y         z       z.1         u
1 -3.1415927 -1.224647e-16 9.8696044 9.8696044 -1.000000
2 -1.8849556 -9.510565e-01 3.5530576 3.5530576 -0.309017
3 -0.6283185 -5.877853e-01 0.3947842 0.3947842  0.809017
4  0.6283185  5.877853e-01 0.3947842 0.3947842  0.809017
5  1.8849556  9.510565e-01 3.5530576 3.5530576 -0.309017
6  3.1415927  1.224647e-16 9.8696044 9.8696044 -1.000000</code></pre>
</div>
</div>
<ul>
<li>Finally, you can use the <code class="sourceCode r"><span class="fu">cbind</span>()</code> function to bind two <code>data.frame</code> column-wise:</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x             y         z a b
1 -3.1415927 -1.224647e-16 9.8696044 1 1
2 -1.8849556 -9.510565e-01 3.5530576 2 2
3 -0.6283185 -5.877853e-01 0.3947842 3 3
4  0.6283185  5.877853e-01 0.3947842 4 4
5  1.8849556  9.510565e-01 3.5530576 5 5
6  3.1415927  1.224647e-16 9.8696044 6 6</code></pre>
</div>
</div>
</section><section id="adding-rows" class="level3" data-number="6.3.2"><h3 data-number="6.3.2" class="anchored" data-anchor-id="adding-rows">
<span class="header-section-number">6.3.2</span> Adding rows</h3>
<p>For this, use the <code class="sourceCode r"><span class="fu">rbind</span>()</code> function.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Attention
</div>
</div>
<div class="callout-body-container callout-body">
<p>The two <code>data.frame</code> must have the same number of columns <em><strong>and</strong></em> the same column names.</p>
</div>
</div>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            x             y         z
1  -3.1415927 -1.224647e-16 9.8696044
2  -1.8849556 -9.510565e-01 3.5530576
3  -0.6283185 -5.877853e-01 0.3947842
4   0.6283185  5.877853e-01 0.3947842
5   1.8849556  9.510565e-01 3.5530576
6   3.1415927  1.224647e-16 9.8696044
7  -3.1415927 -1.224647e-16 9.8696044
8  -1.8849556 -9.510565e-01 3.5530576
9  -0.6283185 -5.877853e-01 0.3947842
10  0.6283185  5.877853e-01 0.3947842
11  1.8849556  9.510565e-01 3.5530576
12  3.1415927  1.224647e-16 9.8696044</code></pre>
</div>
</div>
</section><section id="deleting-rowscolumns" class="level3" data-number="6.3.3"><h3 data-number="6.3.3" class="anchored" data-anchor-id="deleting-rowscolumns">
<span class="header-section-number">6.3.3</span> Deleting rows/columns</h3>
<p>This works like with vectors:</p>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>,<span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           x             y         z
2 -1.8849556 -9.510565e-01 3.5530576
3 -0.6283185 -5.877853e-01 0.3947842
4  0.6283185  5.877853e-01 0.3947842
5  1.8849556  9.510565e-01 3.5530576
6  3.1415927  1.224647e-16 9.8696044</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              y         z
1 -1.224647e-16 9.8696044
2 -9.510565e-01 3.5530576
3 -5.877853e-01 0.3947842
4  5.877853e-01 0.3947842
5  9.510565e-01 3.5530576
6  1.224647e-16 9.8696044</code></pre>
</div>
</div>
<hr></section></section><section id="tidy-up" class="level2" data-number="6.4"><h2 data-number="6.4" class="anchored" data-anchor-id="tidy-up">
<span class="header-section-number">6.4</span> Tidy up!</h2>
<section id="what-is-tidy-data" class="level3" data-number="6.4.1"><h3 data-number="6.4.1" class="anchored" data-anchor-id="what-is-tidy-data">
<span class="header-section-number">6.4.1</span> What is tidy data?</h3>
<p><strong>A good practice in R is to <em>tidy</em> your data.</strong> R follows a set of conventions that makes one layout of tabular data much easier to work with than others. Your data will be easier to work with in R if it follows three rules:</p>
<ul>
<li>Each variable in the data set is placed in its own column</li>
<li>Each observation is placed in its own row</li>
<li>Each value is placed in its own cell</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./Plots/tidy.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption">Illustration of tidy data.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Data that satisfies these rules is known as tidy data: you see that thanks to this representation, a 2D table can handle an arbitrary number of variables – this avoids using multi-dimensional arrays or multi-tab Excel documents. Note that it does’t matter if a value is repeated in a column.</p>
<p>Here is an example:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="co"># is not tidy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details><summary>
Show output
</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
1 1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
2 1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
3 1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
4 1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
5 1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
6 1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
7 2007 151108   235178 142722 151543   156793  179751 144164 225789 472330
8 2012 149017   241287 139676 152071   158346  173142 143599 228652 496343
  Marseille Montpellier Nantes   Nice   Paris  Reims Rennes Saint.Etienne
1    778071      118864 240048 292958 2790091 134856 151948        210311
2    889029      161910 260244 322442 2590771 154534 180943        223223
3    908600      191354 256693 344481 2299830 178381 198305        220181
4    874436      197231 240539 337085 2176243 177234 194656        204955
5    800550      207996 244995 342439 2152423 180620 197536        199396
6    798430      225392 270251 342738 2125246 187206 206229        180210
7    852395      253712 283025 348721 2193030 183500 207922        175318
8    852516      268456 291604 343629 2240621 181893 209860        171483
  Strasbourg Toulon Toulouse
1     228971 161797   323724
2     249396 174746   370796
3     253384 181801   373796
4     248712 179423   347995
5     252338 167619   358688
6     264115 160639   390350
7     272123 166537   439453
8     274394 164899   453317</code></pre>
</div>
</div>
</details><p><br></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">df</span>, cols<span class="op">=</span><span class="op">-</span><span class="va">year</span>, names_to<span class="op">=</span><span class="st">"city"</span>, values_to<span class="op">=</span><span class="st">"pop"</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="co">#is tidy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details><summary>
Show output
</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160 × 3
    year city         pop
   &lt;int&gt; &lt;chr&gt;      &lt;int&gt;
 1  1962 Angers    115273
 2  1962 Bordeaux  278403
 3  1962 Brest     136104
 4  1962 Dijon     135694
 5  1962 Grenoble  156707
 6  1962 LeHavre   187845
 7  1962 LeMans    132181
 8  1962 Lille     239955
 9  1962 Lyon      535746
10  1962 Marseille 778071
# … with 150 more rows</code></pre>
</div>
</div>
</details><p><br></p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># is not tidy</span></span>
<span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span><span class="va">df</span>, names_from<span class="op">=</span><span class="st">"city"</span>, values_from<span class="op">=</span><span class="st">"pop"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<details><summary>
Show output
</summary><div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 21
   year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
  &lt;int&gt;  &lt;int&gt;    &lt;int&gt;  &lt;int&gt;  &lt;int&gt;    &lt;int&gt;   &lt;int&gt;  &lt;int&gt;  &lt;int&gt;  &lt;int&gt;
1  1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
2  1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
3  1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
4  1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
5  1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
6  1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
7  2007 151108   235178 142722 151543   156793  179751 144164 225789 472330
8  2012 149017   241287 139676 152071   158346  173142 143599 228652 496343
# … with 11 more variables: Marseille &lt;int&gt;, Montpellier &lt;int&gt;, Nantes &lt;int&gt;,
#   Nice &lt;int&gt;, Paris &lt;int&gt;, Reims &lt;int&gt;, Rennes &lt;int&gt;, Saint.Etienne &lt;int&gt;,
#   Strasbourg &lt;int&gt;, Toulon &lt;int&gt;, Toulouse &lt;int&gt;</code></pre>
</div>
</div>
</details><p><br></p>
<p>You can find more information on data import and <a href="https://garrettgman.github.io/tidying/">tidyness</a> on the <a href="https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf">data-import cheatsheet</a> and on the <a href="http://www.sthda.com/english/wiki/tidyr-crucial-step-reshaping-data-with-r-for-easier-analyses">tidyr</a> package.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="./Plots/tidyr-pivoting.gif" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Understanding long and wide data with an animation. Source: <a href="https://github.com/gadenbuie/tidyexplain">tidyexplain</a></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section><section id="tibbles" class="level3" data-number="6.4.2"><h3 data-number="6.4.2" class="anchored" data-anchor-id="tibbles">
<span class="header-section-number">6.4.2</span> Tibbles</h3>
<p>A <code class="sourceCode r">tibble</code> is an enhanced version of the <code class="sourceCode r">data.frame</code> provided by the <code>tibble</code> package (which is part of the <code>tidyverse</code>). The main advantage of <code class="sourceCode r">tibble</code> is that it has easier initialization and nicer printing than <code class="sourceCode r">data.frame</code>. Moreover, the performance are also enhanced for the reading from files with <code class="sourceCode r"><span class="fu">read_csv</span>()</code>, <code class="sourceCode r"><span class="fu">read_tsv</span>()</code>, <code class="sourceCode r"><span class="fu">read_table</span>()</code> and <code class="sourceCode r"><span class="fu">read_delim</span>()</code> that do the same things as their <code>read.xx()</code> counterparts and return a <code>tibble</code>. Otherwise, the handling is basically the same.</p>
<p>More on tibbles <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">here</a>.</p>
<ul>
<li>Note that when initializing <code>tibble</code>s, the construction is iterative. It means that when creating a second column, one can refer to the first one that was created. This does’t work with <code>data.frame</code>s.</li>
</ul>
<div class="cell" data-warnings="false">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1e3</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in data.frame(x = runif(1000), y = cumsum(x)): object 'x' not found</code></pre>
</div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1e3</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tib</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000 × 2
        x     y
    &lt;dbl&gt; &lt;dbl&gt;
 1 0.225  0.225
 2 0.712  0.938
 3 0.0880 1.03 
 4 0.244  1.27 
 5 0.473  1.74 
 6 0.207  1.95 
 7 0.991  2.94 
 8 0.214  3.15 
 9 0.564  3.72 
10 0.211  3.93 
# … with 990 more rows</code></pre>
</div>
</div>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Attention
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><code>Tibble</code>s are quite strict about subsetting. <code>[</code> always returns another <code>tibble</code>. Contrast this with a data frame: sometimes <code>[</code> returns a data frame and sometimes it just returns a vector:</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tib</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># is a vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.22532473 0.71248460 0.08798976 0.24442952 0.47252403 0.20650586</code></pre>
</div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">tib</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>  <span class="co"># is a tibble</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 1
       x
   &lt;dbl&gt;
1 0.225 
2 0.712 
3 0.0880
4 0.244 
5 0.473 
6 0.207 </code></pre>
</div>
</div>
<p>Unless you want to get a <code>tibble</code>, I recommend always using the <code>$</code> notation when you want to get a column as a vector to avoid problems.</p>
<ul>
<li>Another interesting feature of <code>tibble</code>s is that their columns can contain vectors, like usual, but also lists of any R objects like other tibbles, <code class="sourceCode r"><span class="fu">nls</span>()</code> objects, etc. This is called “nesting”, and you can nest and un-nest <code>tibble</code>s using these explicit functions:</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">tib2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">tib</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>number<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">tib1</span>, <span class="va">tib2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tib</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  number data            
   &lt;int&gt; &lt;list&gt;          
1      1 &lt;tibble [3 × 2]&gt;
2      2 &lt;tibble [5 × 2]&gt;</code></pre>
</div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib_unnested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">tib</span>, <span class="va">data</span><span class="op">)</span></span>
<span><span class="va">tib_unnested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  number     x     y
   &lt;int&gt; &lt;int&gt; &lt;int&gt;
1      1     1     1
2      1     2     2
3      1     3     3
4      2     1     1
5      2     2     2
6      2     3     3
7      2     4     4
8      2     5     5</code></pre>
</div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib_unnested_renested</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span><span class="va">tib_unnested</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">number</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tib_unnested_renested</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
      x data            
  &lt;int&gt; &lt;list&gt;          
1     1 &lt;tibble [2 × 2]&gt;
2     2 &lt;tibble [2 × 2]&gt;
3     3 &lt;tibble [2 × 2]&gt;
4     4 &lt;tibble [1 × 2]&gt;
5     5 &lt;tibble [1 × 2]&gt;</code></pre>
</div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tib_unnested_renested</span><span class="op">$</span><span class="va">data</span> <span class="co"># The `data` column is a list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
# A tibble: 2 × 2
  number     y
   &lt;int&gt; &lt;int&gt;
1      1     1
2      2     1

[[2]]
# A tibble: 2 × 2
  number     y
   &lt;int&gt; &lt;int&gt;
1      1     2
2      2     2

[[3]]
# A tibble: 2 × 2
  number     y
   &lt;int&gt; &lt;int&gt;
1      1     3
2      2     3

[[4]]
# A tibble: 1 × 2
  number     y
   &lt;int&gt; &lt;int&gt;
1      2     4

[[5]]
# A tibble: 1 × 2
  number     y
   &lt;int&gt; &lt;int&gt;
1      2     5</code></pre>
</div>
</div>
<hr></section></section><section id="operations-in-the-tidyverse" class="level2" data-number="6.5"><h2 data-number="6.5" class="anchored" data-anchor-id="operations-in-the-tidyverse">
<span class="header-section-number">6.5</span> Operations in the tidyverse</h2>
<p>In the end, base R and the <code>tidyverse</code> package provide many efficient functions to perform most of the tasks you would want to perform recursively, thus allowing avoiding explicit for loops.</p>
<p>Here are some examples, and you will find much more <a href="https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html">here</a>. Take a look at the cheatsheets on <a href="https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf">tidyr</a> and on <a href="https://github.com/rstudio/cheatsheets/blob/main/data-transformation.pdf">dplyr</a>, it’s really helpful.</p>
<p>Let’s work on this <code>tibble</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Let's create a random tibble</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>             y     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="fl">3</span>,<span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span>
<span>             signx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span><span class="op">)</span>,</span>
<span>             signy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">&gt;</span><span class="fl">0</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 4
         x        y signx    signy   
     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
 1  0.0204 -0.207   positive negative
 2 -0.525  -0.00496 negative negative
 3 -0.529  -0.650   negative negative
 4 -0.995   0.276   negative positive
 5  0.981   0.730   positive positive
 6  0.260   0.853   positive positive
 7  0.951   0.282   positive positive
 8  0.939   0.306   positive positive
 9 -0.759  -0.792   negative negative
10 -0.641  -0.720   negative negative
# … with 1,490 more rows</code></pre>
</div>
</div>
<section id="the-pipe-operator" class="level3" data-number="6.5.1"><h3 data-number="6.5.1" class="anchored" data-anchor-id="the-pipe-operator">
<span class="header-section-number">6.5.1</span> The pipe operator</h3>
<p>In the following, we will introduce the pipe operator from the <code>magrittr</code> package: <code class="sourceCode r"><span class="sc">%&gt;%</span></code>. This operator allows a clear syntax for successive operations, as “what is on the left of the operator is given as first argument of what is on the right”. It is thus a good habit to write each operation on a separate line to facilitate the reading. This is particularly helpful when performing multiple nested operations. For example, <code class="sourceCode r"><span class="fu">summary</span>(<span class="fu">head</span>(<span class="fu">tail</span>(dt),<span class="dv">2</span>))</code>, which is hard to read, would translate to:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that the 4.1 version of R introduced a native pipe operator: <code class="sourceCode r"><span class="sc">|&gt;</span></code>. However, for backward compatibility with all my previous code I still stick to the <code>magrittr</code> version <code>%&gt;%</code>, but that’s not the only reason. Indeed, in base R’s pipe, the piped object can only be given as first argument to the function on the right. This is also the default behavior of <code>%&gt;%</code>, but <code>%&gt;%</code> allows for retrieving the piped object with the operator <code>.</code>.</p>
<p>Silly example:</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"Hello"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"e"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "e"</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="st">"Hello"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">"o"</span>, <span class="st">"e"</span>, <span class="va">.</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Helle"</code></pre>
</div>
</div>
</section><section id="sampling-data" class="level3" data-number="6.5.2"><h3 data-number="6.5.2" class="anchored" data-anchor-id="sampling-data">
<span class="header-section-number">6.5.2</span> Sampling data</h3>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>  <span class="co"># by index</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
        x        y signx    signy   
    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
1  0.0204 -0.207   positive negative
2 -0.525  -0.00496 negative negative
3 -0.529  -0.650   negative negative</code></pre>
</div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="co"># randomly</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
      x      y signx    signy   
  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
1 0.715  0.893 positive positive
2 0.825 -0.624 positive negative
3 0.386 -0.612 positive negative</code></pre>
</div>
</div>
</section><section id="operations-on-groups-of-a-variable" class="level3" data-number="6.5.3"><h3 data-number="6.5.3" class="anchored" data-anchor-id="operations-on-groups-of-a-variable">
<span class="header-section-number">6.5.3</span> Operations on groups of a variable</h3>
<p><code class="sourceCode r"><span class="fu">group_by</span>(column)</code> groups by similar values of the wanted column(s) and performs the next operations on each element of the group successively.</p>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
# Groups:   signx [2]
       x      y signx    signy   
   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
1 -0.329 -0.177 negative negative
2 -0.294 -0.979 negative negative
3 -0.296 -0.530 negative negative
4  0.441  0.596 positive positive
5  0.378 -0.627 positive negative
6  0.182  0.321 positive positive</code></pre>
</div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span>, <span class="va">signy</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
# Groups:   signx, signy [4]
         x       y signx    signy   
     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
 1 -0.0840 -0.486  negative negative
 2 -0.763  -0.303  negative negative
 3 -0.187  -0.548  negative negative
 4 -0.717   0.0319 negative positive
 5 -0.0603  0.0919 negative positive
 6 -0.441   0.888  negative positive
 7  0.218  -0.0715 positive negative
 8  0.100  -0.247  positive negative
 9  0.441  -0.0811 positive negative
10  0.320   0.511  positive positive
11  0.483   0.620  positive positive
12  1.00    0.204  positive positive</code></pre>
</div>
</div>
</section><section id="summary-by-groups-of-a-variable" class="level3" data-number="6.5.4"><h3 data-number="6.5.4" class="anchored" data-anchor-id="summary-by-groups-of-a-variable">
<span class="header-section-number">6.5.4</span> Summary by groups of a variable</h3>
<p><code class="sourceCode r"><span class="fu">summarise</span>()</code> returns a <strong>single value</strong> for each element of the groups.</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>              sd_x   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  signx    count mean_x  sd_x
  &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 negative   729 -0.504 0.288
2 positive   771  0.504 0.298</code></pre>
</div>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">signx</span>, <span class="va">signy</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>count  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              mean_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, </span>
<span>              mean_y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
# Groups:   signx [2]
  signx    signy    count mean_x mean_y
  &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 negative negative   358 -0.516 -0.508
2 negative positive   371 -0.492  0.497
3 positive negative   379  0.519 -0.511
4 positive positive   392  0.490  0.537</code></pre>
</div>
</div>
</section><section id="sorting" class="level3" data-number="6.5.5"><h3 data-number="6.5.5" class="anchored" data-anchor-id="sorting">
<span class="header-section-number">6.5.5</span> Sorting</h3>
<div class="cell">
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 4
        x        y signx    signy   
    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
 1 -0.995  0.276   negative positive
 2 -0.995  0.828   negative positive
 3 -0.995 -0.00492 negative negative
 4 -0.994 -0.361   negative negative
 5 -0.994  0.624   negative positive
 6 -0.994 -0.232   negative negative
 7 -0.988 -0.0910  negative negative
 8 -0.988 -0.398   negative negative
 9 -0.988 -0.216   negative negative
10 -0.980  0.147   negative positive
# … with 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 4
        x        y signx    signy   
    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
 1 -0.995  0.828   negative positive
 2 -0.995  0.276   negative positive
 3 -0.995 -0.00492 negative negative
 4 -0.994  0.624   negative positive
 5 -0.994 -0.232   negative negative
 6 -0.994 -0.361   negative negative
 7 -0.988 -0.0910  negative negative
 8 -0.988 -0.216   negative negative
 9 -0.988 -0.398   negative negative
10 -0.980  0.219   negative positive
# … with 1,490 more rows</code></pre>
</div>
</div>
</section><section id="merge-tables-column-wise" class="level3" data-number="6.5.6"><h3 data-number="6.5.6" class="anchored" data-anchor-id="merge-tables-column-wise">
<span class="header-section-number">6.5.6</span> Merge tables column-wise</h3>
<p>At least one column with the <strong>exact</strong> same name must be present in each table to use the <code class="sourceCode r"><span class="fu">xx_join</span>()</code> functions. There are more possibilities than <code class="sourceCode r"><span class="fu">inner_join</span>()</code> that I show here, see the help for more information.</p>
<div class="cell">
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>signx<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"positive"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"negative"</span><span class="op">)</span>, </span>
<span>              signy<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"positive"</span>,<span class="st">"negative"</span>,<span class="st">"positive"</span>,<span class="st">"negative"</span><span class="op">)</span>, </span>
<span>              value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  signx    signy    value
  &lt;chr&gt;    &lt;chr&gt;    &lt;lgl&gt;
1 positive positive TRUE 
2 positive negative FALSE
3 negative positive FALSE
4 negative negative TRUE </code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">dt</span>, <span class="va">dt2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 5
         x        y signx    signy    value
     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;lgl&gt;
 1  0.0204 -0.207   positive negative FALSE
 2 -0.525  -0.00496 negative negative TRUE 
 3 -0.529  -0.650   negative negative TRUE 
 4 -0.995   0.276   negative positive FALSE
 5  0.981   0.730   positive positive TRUE 
 6  0.260   0.853   positive positive TRUE 
 7  0.951   0.282   positive positive TRUE 
 8  0.939   0.306   positive positive TRUE 
 9 -0.759  -0.792   negative negative TRUE 
10 -0.641  -0.720   negative negative TRUE 
# … with 1,490 more rows</code></pre>
</div>
</div>
</section><section id="merge-tables-row-wise" class="level3" data-number="6.5.7"><h3 data-number="6.5.7" class="anchored" data-anchor-id="merge-tables-row-wise">
<span class="header-section-number">6.5.7</span> Merge tables row-wise</h3>
<p>This works even if there are missing rows.</p>
<div class="cell">
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, b<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span>, c<span class="op">=</span><span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">dt4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span>, c<span class="op">=</span><span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">dt3</span>, <span class="va">dt4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
      a     b     c
  &lt;int&gt; &lt;int&gt; &lt;int&gt;
1     1     3     6
2     2     4     7
3     3     5     8
4     3    NA     3
5     2    NA     4
6     1    NA     5</code></pre>
</div>
</div>
</section><section id="addmodify-a-column" class="level3" data-number="6.5.8"><h3 data-number="6.5.8" class="anchored" data-anchor-id="addmodify-a-column">
<span class="header-section-number">6.5.8</span> Add/modify a column</h3>
<p><code class="sourceCode r"><span class="fu">mutate</span>()</code>, like <code class="sourceCode r"><span class="sc">$</span></code>, adds a column if it doesn’t exist, and modifies it if it does.</p>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 6
         x        y signx    signy        w       z
     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    &lt;int&gt;   &lt;dbl&gt;
 1  0.0204 -0.207   positive negative     1  0.0204
 2 -0.525  -0.00496 negative negative     2 -0.501 
 3 -0.529  -0.650   negative negative     3 -0.504 
 4 -0.995   0.276   negative positive     4 -0.839 
 5  0.981   0.730   positive positive     5  0.831 
 6  0.260   0.853   positive positive     6  0.257 
 7  0.951   0.282   positive positive     7  0.814 
 8  0.939   0.306   positive positive     8  0.807 
 9 -0.759  -0.792   negative negative     9 -0.688 
10 -0.641  -0.720   negative negative    10 -0.598 
# … with 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 4
       x        y signx    signy   
   &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
 1     1 -0.207   positive negative
 2     2 -0.00496 negative negative
 3     3 -0.650   negative negative
 4     4  0.276   negative positive
 5     5  0.730   positive positive
 6     6  0.853   positive positive
 7     7  0.282   positive positive
 8     8  0.306   positive positive
 9     9 -0.792   negative negative
10    10 -0.720   negative negative
# … with 1,490 more rows</code></pre>
</div>
</div>
</section><section id="selecting-columns" class="level3" data-number="6.5.9"><h3 data-number="6.5.9" class="anchored" data-anchor-id="selecting-columns">
<span class="header-section-number">6.5.9</span> Selecting columns</h3>
<div class="cell">
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>  <span class="co"># only x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 1
         x
     &lt;dbl&gt;
 1  0.0204
 2 -0.525 
 3 -0.529 
 4 -0.995 
 5  0.981 
 6  0.260 
 7  0.951 
 8  0.939 
 9 -0.759 
10 -0.641 
# … with 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span> <span class="co"># all but x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 3
          y signx    signy   
      &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
 1 -0.207   positive negative
 2 -0.00496 negative negative
 3 -0.650   negative negative
 4  0.276   negative positive
 5  0.730   positive positive
 6  0.853   positive positive
 7  0.282   positive positive
 8  0.306   positive positive
 9 -0.792   negative negative
10 -0.720   negative negative
# … with 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"sign"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 2
   signx    signy   
   &lt;chr&gt;    &lt;chr&gt;   
 1 positive negative
 2 negative negative
 3 negative negative
 4 negative positive
 5 positive positive
 6 positive positive
 7 positive positive
 8 positive positive
 9 negative negative
10 negative negative
# … with 1,490 more rows</code></pre>
</div>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 2
         x signx   
     &lt;dbl&gt; &lt;chr&gt;   
 1  0.0204 positive
 2 -0.525  negative
 3 -0.529  negative
 4 -0.995  negative
 5  0.981  positive
 6  0.260  positive
 7  0.951  positive
 8  0.939  positive
 9 -0.759  negative
10 -0.641  negative
# … with 1,490 more rows</code></pre>
</div>
</div>
</section><section id="filtering-columns" class="level3" data-number="6.5.10"><h3 data-number="6.5.10" class="anchored" data-anchor-id="filtering-columns">
<span class="header-section-number">6.5.10</span> Filtering columns</h3>
<div class="cell">
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">signx</span><span class="op">==</span><span class="st">"positive"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 771 × 4
        x       y signx    signy   
    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
 1 0.0204 -0.207  positive negative
 2 0.981   0.730  positive positive
 3 0.260   0.853  positive positive
 4 0.951   0.282  positive positive
 5 0.939   0.306  positive positive
 6 0.944  -0.0821 positive negative
 7 0.0499  0.822  positive positive
 8 0.560  -0.880  positive negative
 9 0.315  -0.159  positive negative
10 0.677   0.643  positive positive
# … with 761 more rows</code></pre>
</div>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">0</span>, <span class="va">y</span><span class="op">&gt;</span><span class="fl">.1</span><span class="op">)</span> <span class="co"># multiple filters can be applied at once</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 330 × 4
        x     y signx    signy   
    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;   
 1 -0.995 0.276 negative positive
 2 -0.424 0.579 negative positive
 3 -0.476 0.690 negative positive
 4 -0.434 0.847 negative positive
 5 -0.199 0.929 negative positive
 6 -0.326 0.573 negative positive
 7 -0.562 0.611 negative positive
 8 -0.971 0.594 negative positive
 9 -0.630 0.649 negative positive
10 -0.233 0.496 negative positive
# … with 320 more rows</code></pre>
</div>
</div>
</section><section id="reorder-columns" class="level3" data-number="6.5.11"><h3 data-number="6.5.11" class="anchored" data-anchor-id="reorder-columns">
<span class="header-section-number">6.5.11</span> Reorder columns</h3>
<div class="cell">
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="va">signy</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,500 × 4
         x signx    signy           y
     &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;       &lt;dbl&gt;
 1  0.0204 positive negative -0.207  
 2 -0.525  negative negative -0.00496
 3 -0.529  negative negative -0.650  
 4 -0.995  negative positive  0.276  
 5  0.981  positive positive  0.730  
 6  0.260  positive positive  0.853  
 7  0.951  positive positive  0.282  
 8  0.939  positive positive  0.306  
 9 -0.759  negative negative -0.792  
10 -0.641  negative negative -0.720  
# … with 1,490 more rows</code></pre>
</div>
</div>
</section><section id="separate-columns" class="level3" data-number="6.5.12"><h3 data-number="6.5.12" class="anchored" data-anchor-id="separate-columns">
<span class="header-section-number">6.5.12</span> Separate columns</h3>
<p>The separation is based on standard separators such as “-”, “_”, “.”, ” “, etc. A single separator can be specified with the argument <code>sep</code>, otherwise all separators are used. One must provide the resulting vector of new column names: if one value is <code class="sourceCode r"><span class="cn">NA</span></code>, this column will be discarded. Examples:</p>
<div class="cell">
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/FTIR/Data/"</span>, pattern<span class="op">=</span><span class="st">".xls"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
   file             
   &lt;chr&gt;            
 1 sample_0_25C.xls 
 2 sample_0_300C.xls
 3 sample_1_25C.xls 
 4 sample_1_300C.xls
 5 sample_2_25C.xls 
 6 sample_2_300C.xls
 7 sample_3_25C.xls 
 8 sample_3_300C.xls
 9 sample_4_25C.xls 
10 sample_4_300C.xls</code></pre>
</div>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">file</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"sample"</span>, <span class="st">"temperature"</span>, <span class="cn">NA</span><span class="op">)</span>, convert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   sample temperature
    &lt;int&gt; &lt;chr&gt;      
 1      0 25C        
 2      0 300C       
 3      1 25C        
 4      1 300C       
 5      2 25C        
 6      2 300C       
 7      3 25C        
 8      3 300C       
 9      4 25C        
10      4 300C       </code></pre>
</div>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">file</span>, </span>
<span>                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"name"</span>, <span class="st">"extension"</span><span class="op">)</span>, </span>
<span>                 sep <span class="op">=</span> <span class="st">"\\."</span></span>
<span>                 <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   name          extension
   &lt;chr&gt;         &lt;chr&gt;    
 1 sample_0_25C  xls      
 2 sample_0_300C xls      
 3 sample_1_25C  xls      
 4 sample_1_300C xls      
 5 sample_2_25C  xls      
 6 sample_2_300C xls      
 7 sample_3_25C  xls      
 8 sample_3_300C xls      
 9 sample_4_25C  xls      
10 sample_4_300C xls      </code></pre>
</div>
</div>
</section><section id="apply-a-function-recursively-on-each-element-of-a-column" class="level3" data-number="6.5.13"><h3 data-number="6.5.13" class="anchored" data-anchor-id="apply-a-function-recursively-on-each-element-of-a-column">
<span class="header-section-number">6.5.13</span> Apply a function recursively on each element of a column</h3>
<p>Take a look at the <a href="https://github.com/rstudio/cheatsheets/blob/main/purrr.pdf">cheatsheet on the <code>purrr</code> package</a> for more options and a visual help on the <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code> family. I show here a use of <code class="sourceCode r">purrr<span class="sc">::</span><span class="fu">map</span>(vector, <span class="cf">function</span>)</code> that returns a list. <code class="sourceCode r"><span class="fu">map</span>(x, f)</code> applies the function <code>f()</code> to each element of the vector <code>x</code>, putting the result in a separate element of a list: <code class="sourceCode r"><span class="fu">map</span>(x, f) <span class="ot">-&gt;</span> <span class="fu">list</span>(<span class="fu">f</span>(x1), <span class="fu">f</span>(x2), ... <span class="fu">f</span>(xn))</code>. In case <code>f(xi)</code> returns a single value, you might want to use <code><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl()</a></code> or <code><a href="https://purrr.tidyverse.org/reference/map.html">map_chr()</a></code>, for example, that will return a vector of doubles or of characters, respectively.</p>
<div class="cell">
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pi</span>, <span class="va">pi</span><span class="op">/</span><span class="fl">3</span>, <span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">sin</span><span class="op">)</span>     <span class="co"># returns a list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 1.224647e-16

[[2]]
[1] 0.8660254

[[3]]
[1] 1</code></pre>
</div>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">sin</span><span class="op">)</span> <span class="co"># returns a vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.224647e-16 8.660254e-01 1.000000e+00</code></pre>
</div>
</div>
<p>Of course, in the above case, it’s a stupid use of the power of <code class="sourceCode r"><span class="fu">map</span>()</code>. A typical use case is when you want to read multiple files, for example:</p>
<div class="cell">
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/spectro/Data"</span>, </span>
<span>                              pattern <span class="op">=</span> <span class="st">".txt"</span>, </span>
<span>                              full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file</span>, <span class="va">read_table</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dt6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  file                          data                  
  &lt;chr&gt;                         &lt;list&gt;                
1 Exo/spectro/Data/rubis_01.txt &lt;spc_tbl_ [1,014 × 2]&gt;
2 Exo/spectro/Data/rubis_02.txt &lt;spc_tbl_ [1,014 × 2]&gt;
3 Exo/spectro/Data/rubis_03.txt &lt;spc_tbl_ [1,014 × 2]&gt;
4 Exo/spectro/Data/rubis_04.txt &lt;spc_tbl_ [1,014 × 2]&gt;
5 Exo/spectro/Data/rubis_05.txt &lt;spc_tbl_ [1,014 × 2]&gt;</code></pre>
</div>
</div>
<p>This is (almost) equivalent to:</p>
<div class="cell">
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>file<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="st">"Exo/spectro/Data"</span>, </span>
<span>                              pattern <span class="op">=</span> <span class="st">".txt"</span>, </span>
<span>                              full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">file</span>, <span class="op">~</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="va">.</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"Int"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You see that you can create the function directly within the call to map using the shortcut <code class="sourceCode r"><span class="fu">map</span>(vector, <span class="sc">~</span> <span class="cf">function</span>(.))</code>. This is useful to provide more arguments to the function – another solution is to write your own function before the call to <code class="sourceCode r"><span class="fu">map</span>()</code> and then call this function in <code class="sourceCode r"><span class="fu">map</span>()</code>.</p>
<p>Note that in case you need more parameters, you can use <code class="sourceCode r">purrr<span class="sc">::</span><span class="fu">map2</span>(vector1, vector2, <span class="sc">~</span><span class="cf">function</span>(.x, .y))</code>, where <code>.x</code> and <code>.y</code> refer to <code>vector1</code> and <code>vector2</code>, respectively (it’s always <code>.x</code> and <code>.y</code> whatever the name of <code>vector1</code> and <code>vector2</code>).</p>
<div class="cell">
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sum <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
      x     y   sum
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
1     1     5     6
2     2     6     8
3     3     7    10</code></pre>
</div>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">4</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">10</span><span class="op">:</span><span class="fl">13</span>, y<span class="op">=</span><span class="fl">15</span><span class="op">:</span><span class="fl">18</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,  y<span class="op">=</span><span class="op">-</span><span class="fl">14</span><span class="op">:</span><span class="op">-</span><span class="fl">17</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>sumx <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">x</span>, <span class="va">.y</span><span class="op">$</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           sumy <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_dbl</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">y</span>, <span class="va">.y</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  a                b                 sumx  sumy
  &lt;list&gt;           &lt;list&gt;           &lt;dbl&gt; &lt;dbl&gt;
1 &lt;tibble [3 × 2]&gt; &lt;tibble [4 × 2]&gt;    52    84
2 &lt;tibble [4 × 2]&gt; &lt;tibble [4 × 2]&gt;     8   -40</code></pre>
</div>
</div>
</section><section id="nesting-and-un-nesting-data" class="level3" data-number="6.5.14"><h3 data-number="6.5.14" class="anchored" data-anchor-id="nesting-and-un-nesting-data">
<span class="header-section-number">6.5.14</span> Nesting and un-nesting data</h3>
<div class="cell">
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dt7</span> <span class="op">&lt;-</span> <span class="va">dt6</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">file</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">dt7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,075 × 3
   file             w   Int
   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
 1 rubis_01.txt 3064.  43.9
 2 rubis_01.txt 3064.  47.9
 3 rubis_01.txt 3064.  44.5
 4 rubis_01.txt 3065.  50.5
 5 rubis_01.txt 3065.  50.5
 6 rubis_01.txt 3065.  44.5
 7 rubis_01.txt 3065.  44.9
 8 rubis_01.txt 3066.  39.9
 9 rubis_01.txt 3066.  49.5
10 rubis_01.txt 3066.  48.9
# … with 5,065 more rows</code></pre>
</div>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Nesting data per repeated values in a column (~equivalent to grouping)</span></span>
<span><span class="va">dt7</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data<span class="op">=</span><span class="op">-</span><span class="va">file</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  file         data                
  &lt;chr&gt;        &lt;list&gt;              
1 rubis_01.txt &lt;tibble [1,015 × 2]&gt;
2 rubis_02.txt &lt;tibble [1,015 × 2]&gt;
3 rubis_03.txt &lt;tibble [1,015 × 2]&gt;
4 rubis_04.txt &lt;tibble [1,015 × 2]&gt;
5 rubis_05.txt &lt;tibble [1,015 × 2]&gt;</code></pre>
</div>
</div>
</section><section id="providing-data-to-ggplot" class="level3" data-number="6.5.15"><h3 data-number="6.5.15" class="anchored" data-anchor-id="providing-data-to-ggplot">
<span class="header-section-number">6.5.15</span> Providing data to ggplot</h3>
<div class="cell">
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">dt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, color<span class="op">=</span><span class="va">signy</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-dataframes_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="exo-df" class="level2" data-number="6.6"><h2 data-number="6.6" class="anchored" data-anchor-id="exo-df">
<span class="header-section-number">6.6</span> Exercises</h2>
<p>Interactive exercises can be found in the <a href="https://colinbousige.github.io/tutor/"><code>tutor</code></a> package. For this, simply run:</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tutor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tutor/man/tuto.html">tuto</a></span><span class="op">(</span><span class="st">"dataframes"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Alternatively, you can just <a href="Data/exo-in-class.zip" download="" target="_blank">download the archive with all the exercises files</a>, unzip it in your <code>R class</code> RStudio project, and edit the R files.</p>
<hr>
<details><summary><strong>Exercise 1</strong>
</summary><ul>
<li>Create a 3 column <code class="sourceCode r">data.frame</code> containing 10 random values, their sinus, and the sum of the two first columns.</li>
<li>Print the 4 first lines of the table</li>
<li>Print the second column</li>
<li>Print the average of the third column</li>
<li>Using <code class="sourceCode r"><span class="fu">plot</span>(x,y)</code> where <code>x</code> and <code>y</code> are vectors, plot the 2nd column as a function of the first</li>
<li>Look into the function <code class="sourceCode r"><span class="fu">write.table</span>()</code> to write a text file containing this <code class="sourceCode r">data.frame</code>
</li>
<li>Do the all the same things with a <code class="sourceCode r">tibble</code>
</li>
</ul>
<details><summary>
Solution
</summary><div class="cell" data-warnings="false">
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a 3 column `data.frame`{.R} containing 10 random values, their sinus, </span></span>
<span><span class="co"># and the sum of the two first columns.</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, z<span class="op">=</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co"># Print the 4 first lines of the table</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x         y         z
1 0.9383907 0.8066079 1.7449986
2 0.1118596 0.1116265 0.2234861
3 0.5365588 0.5111814 1.0477402
4 0.7835313 0.7057855 1.4893169</code></pre>
</div>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print the second column</span></span>
<span><span class="va">df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.80660789 0.11162648 0.51118139 0.70578551 0.35359337 0.58406606
 [7] 0.56347190 0.41957589 0.08274393 0.79331061</code></pre>
</div>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Print the average of the third column</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">z</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.031807</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in mean.default(df[3]): argument is not numeric or logical: returning NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.031807</code></pre>
</div>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using `plot(x,y)`{.R} where `x` and `y` are vectors, </span></span>
<span><span class="co"># plot the 2nd column as a function of the first</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">df</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-dataframes_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">x</span>, <span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-dataframes_files/figure-html/unnamed-chunk-50-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Look into the function `write.table()`{.R} to write a text file </span></span>
<span><span class="co"># containing this `data.frame`{.R}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"Data/some_data.dat"</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># # # # # # # # # # # # # # # # # </span></span>
<span><span class="co"># Tibble version</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">df_tib</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>, c <span class="op">=</span> <span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df_tib</span>, <span class="fl">4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
      a     b     c
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 0.373 0.365 0.738
2 0.577 0.546 1.12 
3 0.222 0.220 0.442
4 0.148 0.148 0.296</code></pre>
</div>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df_tib</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>; <span class="va">df_tib</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 1
        b
    &lt;dbl&gt;
 1 0.365 
 2 0.546 
 3 0.220 
 4 0.148 
 5 0.292 
 6 0.684 
 7 0.145 
 8 0.0269
 9 0.823 
10 0.695 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.36450546 0.54576419 0.21990195 0.14768380 0.29157330 0.68371943
 [7] 0.14540304 0.02685534 0.82277924 0.69474705</code></pre>
</div>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">$</span><span class="va">c</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8219125</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in mean.default(df_tib[3]): argument is not numeric or logical:
returning NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in mean.default(df_tib[, 3]): argument is not numeric or logical:
returning NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8219125</code></pre>
</div>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span><span class="op">(</span><span class="va">df_tib</span>, <span class="st">"Data/some_data.dat"</span>, quote <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">df_tib</span><span class="op">$</span><span class="va">a</span>, <span class="va">df_tib</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-dataframes_files/figure-html/unnamed-chunk-50-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</details></details><details><summary><strong>Exercise 2</strong>
</summary><ul>
<li>Download the files:
<ul>
<li><a href="Data/rubis_01.txt" download="" target="_blank">rubis_01.txt</a></li>
<li><a href="Data/population.csv" download="" target="_blank">population.csv</a></li>
<li><a href="Data/FTIR_rocks.xlsx" download="" target="_blank">FTIR_rocks.xlsx</a></li>
</ul>
</li>
<li>Load them into separate <code class="sourceCode r">data.frames</code>. Look into the options of <code class="sourceCode r"><span class="fu">read.table</span>()</code>, <code class="sourceCode r"><span class="fu">read.csv</span>()</code>, <code class="sourceCode r">readxl<span class="sc">::</span><span class="fu">read_excel</span>()</code>, to get the proper data fields.</li>
<li>Add column names to the data.frame containing <code>rubis_01.txt</code>.</li>
<li>Print their dimensions.</li>
<li>Do the same things with tibbles.</li>
</ul>
<details><summary>
Solution
</summary><div class="cell" data-warnings="false">
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rubis_01</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/rubis_01.txt"</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"intensity"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></span>
<span><span class="va">FTIR_rocks</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"Data/FTIR_rocks.xlsx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">rubis_01</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">rubis_01</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1015    2</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "w"         "intensity"</code></pre>
</div>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">population</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8 21</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "year"          "Angers"        "Bordeaux"      "Brest"        
 [5] "Dijon"         "Grenoble"      "LeHavre"       "LeMans"       
 [9] "Lille"         "Lyon"          "Marseille"     "Montpellier"  
[13] "Nantes"        "Nice"          "Paris"         "Reims"        
[17] "Rennes"        "Saint.Etienne" "Strasbourg"    "Toulon"       
[21] "Toulouse"     </code></pre>
</div>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">FTIR_rocks</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">FTIR_rocks</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4718    4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "wavenumber, cm-1" "rock 1"           "rock 2"           "rock 3"          </code></pre>
</div>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">rubis_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"Data/rubis_01.txt"</span>, col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"w"</span>, <span class="st">"intensity"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">population</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details></details><details><summary><strong>Exercise 3</strong>
</summary><ul>
<li>Download the TGA data file <a href="Data/ATG.txt" download="" target="_blank">ATG.txt</a>
</li>
<li>Load it into a <code class="sourceCode r">data.frame</code>. Look into the options of <code class="sourceCode r"><span class="fu">read.table</span>()</code> to get the proper data fields.</li>
<li>Do the same with a tibble</li>
</ul>
<details><summary>
Solution
</summary><div class="cell">
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, </span>
<span>                skip<span class="op">=</span><span class="fl">12</span>,</span>
<span>                header<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>                nrows<span class="op">=</span><span class="fl">4088</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Index"</span>, <span class="st">"t"</span>, <span class="st">"Ts"</span>, <span class="st">"Tr"</span>, <span class="st">"Value"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Index  t      Ts Tr   Value
1     0  0 32.3769 25 32.9680
2     3  3 32.4051 25 32.9655
3     6  6 32.4332 25 32.9619
4     9  9 32.4726 25 32.9582
5    12 12 32.5066 25 32.9544
6    15 15 32.5221 25 32.9504</code></pre>
</div>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, </span>
<span>                skip<span class="op">=</span><span class="fl">10</span>,</span>
<span>                comment.char<span class="op">=</span><span class="st">"["</span>,</span>
<span>                header<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                nrows<span class="op">=</span><span class="fl">4088</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Index  t      Ts Tr   Value
1     0  0 32.3769 25 32.9680
2     3  3 32.4051 25 32.9655
3     6  6 32.4332 25 32.9619
4     9  9 32.4726 25 32.9582
5    12 12 32.5066 25 32.9544
6    15 15 32.5221 25 32.9504</code></pre>
</div>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_table.html">read_table</a></span><span class="op">(</span><span class="st">"Data/ATG.txt"</span>, </span>
<span>                skip    <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                comment <span class="op">=</span> <span class="st">"["</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
── Column specification ────────────────────────────────────────────────────────
cols(
  Index = col_double(),
  t = col_double(),
  Ts = col_double(),
  Tr = col_double(),
  Value = col_double()
)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: 122 parsing failures.
 row   col  expected    actual           file
  NA NA    5 columns 0 columns 'Data/ATG.txt'
4090 Index a double  Results:  'Data/ATG.txt'
4090 NA    5 columns 1 columns 'Data/ATG.txt'
4091 Index a double  Content   'Data/ATG.txt'
4091 Ts    a double  %         'Data/ATG.txt'
.... ..... ......... ......... ..............
See problems(...) for more details.</code></pre>
</div>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,088 × 5
   Index     t    Ts    Tr Value
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     0     0  32.4    25  33.0
 2     3     3  32.4    25  33.0
 3     6     6  32.4    25  33.0
 4     9     9  32.5    25  33.0
 5    12    12  32.5    25  33.0
 6    15    15  32.5    25  33.0
 7    18    18  32.6    25  32.9
 8    21    21  32.6    25  32.9
 9    24    24  32.6    25  32.9
10    27    27  32.7    25  32.9
# … with 4,078 more rows</code></pre>
</div>
</div>
</details></details><details><summary><strong>Exercise 4</strong>
</summary><p>Download <a href="Data/population.csv" download="" target="_blank">population.csv</a> and load it into a <code class="sourceCode r">tibble</code>.</p>
<ul>
<li>What are the names of the columns?</li>
<li>Are the data tidy? make the table tidy if needed</li>
<li>Create a subset containing the data for Montpellier
<ul>
<li>What is the max and min of population in this city?</li>
<li>The average population over time?</li>
</ul>
</li>
<li>What is the total population in 2012?</li>
<li>What is the total population per year?</li>
<li>What is the average population per city over the years?</li>
</ul>
<details><summary>
Solution
</summary><div class="cell">
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Download population.txt and load it into a `data.frame`{.R}.</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">popul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/population.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 8 Columns: 21
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (21): year, Angers, Bordeaux, Brest, Dijon, Grenoble, LeHavre, LeMans, L...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># What are the names of the columns and the dimension of the table?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "year"          "Angers"        "Bordeaux"      "Brest"        
 [5] "Dijon"         "Grenoble"      "LeHavre"       "LeMans"       
 [9] "Lille"         "Lyon"          "Marseille"     "Montpellier"  
[13] "Nantes"        "Nice"          "Paris"         "Reims"        
[17] "Rennes"        "Saint-Etienne" "Strasbourg"    "Toulon"       
[21] "Toulouse"     </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8 21</code></pre>
</div>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Are the data tidy?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">popul</span><span class="op">)</span> <span class="co"># no</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
   year Angers Bordeaux  Brest  Dijon Grenoble LeHavre LeMans  Lille   Lyon
  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1  1962 115273   278403 136104 135694   156707  187845 132181 239955 535746
2  1968 128557   266662 154023 145357   161616  207150 143246 238554 527800
3  1975 137591   223131 166826 151705   166037  217882 152285 219204 456716
4  1982 136038   208159 156060 140942   156637  199388 147697 196705 413095
5  1990 141404   210336 147956 146703   150758  195854 145502 198691 415487
6  1999 151279   215363 149634 149867   153317  190905 146105 212597 445452
# … with 11 more variables: Marseille &lt;dbl&gt;, Montpellier &lt;dbl&gt;, Nantes &lt;dbl&gt;,
#   Nice &lt;dbl&gt;, Paris &lt;dbl&gt;, Reims &lt;dbl&gt;, Rennes &lt;dbl&gt;, `Saint-Etienne` &lt;dbl&gt;,
#   Strasbourg &lt;dbl&gt;, Toulon &lt;dbl&gt;, Toulouse &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">popul.tidy</span> <span class="op">&lt;-</span> <span class="va">popul</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="op">-</span><span class="va">year</span>,</span>
<span>                 names_to <span class="op">=</span> <span class="st">"city"</span>,</span>
<span>                 values_to <span class="op">=</span> <span class="st">"pop"</span></span>
<span>                <span class="op">)</span></span>
<span><span class="va">popul.tidy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 160 × 3
    year city         pop
   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
 1  1962 Angers    115273
 2  1962 Bordeaux  278403
 3  1962 Brest     136104
 4  1962 Dijon     135694
 5  1962 Grenoble  156707
 6  1962 LeHavre   187845
 7  1962 LeMans    132181
 8  1962 Lille     239955
 9  1962 Lyon      535746
10  1962 Marseille 778071
# … with 150 more rows</code></pre>
</div>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Create a subset containing the data for Montpellier</span></span>
<span><span class="va">mtp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">popul.tidy</span>, <span class="va">city</span> <span class="op">==</span> <span class="st">"Montpellier"</span><span class="op">)</span></span>
<span><span class="co"># I prefer the tidyverse version</span></span>
<span><span class="va">mtp</span> <span class="op">&lt;-</span> <span class="va">popul.tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">city</span> <span class="op">==</span> <span class="st">"Montpellier"</span><span class="op">)</span></span>
<span><span class="co"># What is the max and min of population in this city?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 268456</code></pre>
</div>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 118864</code></pre>
</div>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 118864 268456</code></pre>
</div>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># The average population over time?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">mtp</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 203114.4</code></pre>
</div>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># What is the total population in 2012?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">popul.tidy</span><span class="op">[</span><span class="va">popul.tidy</span><span class="op">$</span><span class="va">year</span> <span class="op">==</span> <span class="fl">2012</span>, <span class="st">"pop"</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7334805</code></pre>
</div>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">popul.tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span><span class="op">==</span><span class="fl">2012</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7334805</code></pre>
</div>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># What is the total population per year?</span></span>
<span><span class="va">popul.tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>pop_tot<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
   year pop_tot
  &lt;dbl&gt;   &lt;dbl&gt;
1  1962 7349547
2  1968 7550999
3  1975 7298183
4  1982 6933230
5  1990 6857291
6  1999 6965325
7  2007 7235114
8  2012 7334805</code></pre>
</div>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># What is the average population per city over the years?</span></span>
<span><span class="va">popul.tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">city</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>pop_ave<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   city           pop_ave
   &lt;chr&gt;            &lt;dbl&gt;
 1 Angers         138783.
 2 Bordeaux       234815.
 3 Brest          149125.
 4 Dijon          146735.
 5 Grenoble       157526.
 6 LeHavre        193990.
 7 LeMans         144347.
 8 Lille          220018.
 9 Lyon           470371.
10 Marseille      844253.
11 Montpellier    203114.
12 Nantes         260925.
13 Nice           334312.
14 Paris         2321032.
15 Reims          172278 
16 Rennes         193425.
17 Saint-Etienne  198135.
18 Strasbourg     255429.
19 Toulon         169683.
20 Toulouse       382265.</code></pre>
</div>
</div>
</details></details><details><summary><strong>Exercise 5</strong>
</summary><ul>
<li>First, load the <code>tidyverse</code> and <code>lubridate</code> package</li>
<li>Load <a href="Data/people1.csv" download="" target="_blank">people1.csv</a> and <a href="Data/people2.csv" download="" target="_blank">people2.csv</a> into <code>pp1</code> and <code>pp2</code>
</li>
<li>Create a new tibble <code>pp</code> by using the pipe operator (<code class="sourceCode r"><span class="sc">%&gt;%</span></code>) and successively:
<ul>
<li>joining the two tibbles into one using <code class="sourceCode r"><span class="fu">inner_join</span>()</code>
</li>
<li>adding a column <code>age</code> containing the age in years (use <code class="sourceCode r">lubridate<span class="sc">::</span><span class="fu">time_length</span>(x, <span class="st">'years'</span>)</code> with x a time difference in days) by using <code class="sourceCode r"><span class="fu">mutate</span>()</code>
</li>
</ul>
</li>
<li>Display a summary of the table using <code class="sourceCode r"><span class="fu">str</span>()</code>
</li>
<li>Using <code class="sourceCode r"><span class="fu">groupe_by</span>()</code> and <code class="sourceCode r"><span class="fu">summarize</span>()</code>:
<ul>
<li>Show the number of males and females in the table (use the counter <code class="sourceCode r"><span class="fu">n</span>()</code>)</li>
<li>Show the average age per gender</li>
<li>Show the average size per gender and institution</li>
<li>Show the number of people from each country, sorted by descending population (<code class="sourceCode r"><span class="fu">arrange</span>()</code>)</li>
</ul>
</li>
<li>Using <code class="sourceCode r"><span class="fu">select</span>()</code>, display:
<ul>
<li>only the name and age columns</li>
<li>all but the name column</li>
</ul>
</li>
<li>Using <code class="sourceCode r"><span class="fu">filter</span>()</code>, show data only for
<ul>
<li>Chinese people</li>
<li>From institution ECL and UCBL</li>
<li>People older than 22</li>
<li>People with a <code>e</code> in their name</li>
</ul>
</li>
</ul>
<details><summary>
Solution
</summary><div class="cell" data-warnings="false">
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># First, load the `tidyverse` and `lubridate` package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="co"># Load people1.csv and people2.csv</span></span>
<span><span class="va">pp1</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/people1.csv"</span><span class="op">)</span></span>
<span><span class="va">pp2</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"Data/people2.csv"</span><span class="op">)</span></span>
<span><span class="co"># Create a new tibble `pp` by using the pipe operator (`%&gt;%`)</span></span>
<span><span class="co"># and successively:</span></span>
<span><span class="co"># - joining the two tibbles into one using `inner_join()`</span></span>
<span><span class="co"># - adding a column `age` containing the age in years </span></span>
<span><span class="co">#   (use lubridate's `time_length(x, 'years')` with x a time</span></span>
<span><span class="co">#   difference in days) by using `mutate()`</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="va">pp1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">pp2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/time_length.html">time_length</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="va">dateofbirth</span>,<span class="st">'years'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Display a summary of the table using `str()`</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [20 × 7] (S3: tbl_df/tbl/data.frame)
 $ name       : chr [1:20] "Salem" "Dilruwan-Shanaka-Perera" "Hanna" "Sabin" ...
 $ gender     : chr [1:20] "Male" "Male" "Female" "Male" ...
 $ origin     : chr [1:20] "Yemen" "Sri Lanka" "Ukraine" "India" ...
 $ institution: chr [1:20] "UCBL" "INSA" "ECL" "INSA" ...
 $ dateofbirth: Date[1:20], format: "1997-12-26" "1997-03-28" ...
 $ size       : num [1:20] 161 172 165 186 176 ...
 $ age        : num [1:20] 25 25.8 25 27.4 27.7 ...</code></pre>
</div>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using `groupe_by()` and `summarize()`:</span></span>
<span><span class="co"># - Show the number of males and females in the table </span></span>
<span><span class="co">#   (use the counter `n()`)</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  gender count
  &lt;chr&gt;  &lt;int&gt;
1 Female     4
2 Male      16</code></pre>
</div>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Show the average age per gender</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  gender   age
  &lt;chr&gt;  &lt;dbl&gt;
1 Female  27.1
2 Male    26.7</code></pre>
</div>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Show the average size per gender and institution</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">institution</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
# Groups:   gender [2]
  gender institution  size
  &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;
1 Female ECL          178.
2 Male   ECL          168.
3 Male   INSA         174.
4 Male   UCBL         174.</code></pre>
</div>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - Show the number of people from each country, </span></span>
<span><span class="co">#   sorted by descending population</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>count<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
   origin      count
   &lt;chr&gt;       &lt;int&gt;
 1 China           4
 2 Ukraine         4
 3 USA             2
 4 Afghanistan     1
 5 Austria         1
 6 Brazil          1
 7 Colombia        1
 8 Cyprus          1
 9 India           1
10 Iran            1
11 Sri Lanka       1
12 Tunisia         1
13 Yemen           1</code></pre>
</div>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using `select()`, display:</span></span>
<span><span class="co"># - only the name and age columns</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">age</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   name                      age
   &lt;chr&gt;                   &lt;dbl&gt;
 1 Salem                    25.0
 2 Dilruwan-Shanaka-Perera  25.8
 3 Hanna                    25.0
 4 Sabin                    27.4
 5 Benedikt                 27.7
 6 Jordyn                   25.9
 7 Jennifer                 27.6
 8 Yiran                    27.9
 9 Leran                    30.0
10 Aymen                    32.8
11 Pavlo                    25.7
12 Saulo                    28.3
13 Nicolas-Estevan          29.1
14 Farzad                   26.0
15 Roein                    23.5
16 Paraskevas               23.5
17 Ihor                     23.3
18 Iryna                    29.9
19 Peng                     26.1
20 Mingyuan                 25.4</code></pre>
</div>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - all but the name column</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 6
   gender origin      institution dateofbirth  size   age
   &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 Male   Yemen       UCBL        1997-12-26   161.  25.0
 2 Male   Sri Lanka   INSA        1997-03-28   172.  25.8
 3 Female Ukraine     ECL         1997-12-30   165.  25.0
 4 Male   India       INSA        1995-08-04   186.  27.4
 5 Male   Austria     UCBL        1995-04-25   176.  27.7
 6 Female USA         ECL         1997-02-19   176.  25.9
 7 Female USA         ECL         1995-05-28   179   27.6
 8 Male   China       UCBL        1995-02-04   188.  27.9
 9 Male   China       UCBL        1992-12-30   186   30.0
10 Male   Tunisia     INSA        1990-03-03   160.  32.8
11 Male   Ukraine     ECL         1997-04-12   151.  25.7
12 Male   Brazil      ECL         1994-09-24   184.  28.3
13 Male   Colombia    INSA        1993-11-25   184.  29.1
14 Male   Iran        INSA        1996-12-27   183   26.0
15 Male   Afghanistan INSA        1999-07-11   155.  23.5
16 Male   Cyprus      INSA        1999-06-25   176.  23.5
17 Male   Ukraine     ECL         1999-10-03   170.  23.3
18 Female Ukraine     ECL         1993-02-27   192   29.9
19 Male   China       UCBL        1996-12-14   171   26.1
20 Male   China       UCBL        1997-08-21   164.  25.4</code></pre>
</div>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using `filter()`, show data only for</span></span>
<span><span class="co"># - Chinese people</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">origin</span><span class="op">==</span><span class="st">'China'</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  name     gender origin institution dateofbirth  size   age
  &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
1 Yiran    Male   China  UCBL        1995-02-04   188.  27.9
2 Leran    Male   China  UCBL        1992-12-30   186   30.0
3 Peng     Male   China  UCBL        1996-12-14   171   26.1
4 Mingyuan Male   China  UCBL        1997-08-21   164.  25.4</code></pre>
</div>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - From institution ECL and UCBL</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">institution</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ECL'</span>, <span class="st">'UCBL'</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 7
   name     gender origin  institution dateofbirth  size   age
   &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;       &lt;date&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1 Salem    Male   Yemen   UCBL        1997-12-26   161.  25.0
 2 Hanna    Female Ukraine ECL         1997-12-30   165.  25.0
 3 Benedikt Male   Austria UCBL        1995-04-25   176.  27.7
 4 Jordyn   Female USA     ECL         1997-02-19   176.  25.9
 5 Jennifer Female USA     ECL         1995-05-28   179   27.6
 6 Yiran    Male   China   UCBL        1995-02-04   188.  27.9
 7 Leran    Male   China   UCBL        1992-12-30   186   30.0
 8 Pavlo    Male   Ukraine ECL         1997-04-12   151.  25.7
 9 Saulo    Male   Brazil  ECL         1994-09-24   184.  28.3
10 Ihor     Male   Ukraine ECL         1999-10-03   170.  23.3
11 Iryna    Female Ukraine ECL         1993-02-27   192   29.9
12 Peng     Male   China   UCBL        1996-12-14   171   26.1
13 Mingyuan Male   China   UCBL        1997-08-21   164.  25.4</code></pre>
</div>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - People older than 22 </span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">age</span><span class="op">&gt;</span><span class="fl">22</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 7
   name                    gender origin      institution dateofbi…¹  size   age
   &lt;chr&gt;                   &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;       &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 Salem                   Male   Yemen       UCBL        1997-12-26  161.  25.0
 2 Dilruwan-Shanaka-Perera Male   Sri Lanka   INSA        1997-03-28  172.  25.8
 3 Hanna                   Female Ukraine     ECL         1997-12-30  165.  25.0
 4 Sabin                   Male   India       INSA        1995-08-04  186.  27.4
 5 Benedikt                Male   Austria     UCBL        1995-04-25  176.  27.7
 6 Jordyn                  Female USA         ECL         1997-02-19  176.  25.9
 7 Jennifer                Female USA         ECL         1995-05-28  179   27.6
 8 Yiran                   Male   China       UCBL        1995-02-04  188.  27.9
 9 Leran                   Male   China       UCBL        1992-12-30  186   30.0
10 Aymen                   Male   Tunisia     INSA        1990-03-03  160.  32.8
11 Pavlo                   Male   Ukraine     ECL         1997-04-12  151.  25.7
12 Saulo                   Male   Brazil      ECL         1994-09-24  184.  28.3
13 Nicolas-Estevan         Male   Colombia    INSA        1993-11-25  184.  29.1
14 Farzad                  Male   Iran        INSA        1996-12-27  183   26.0
15 Roein                   Male   Afghanistan INSA        1999-07-11  155.  23.5
16 Paraskevas              Male   Cyprus      INSA        1999-06-25  176.  23.5
17 Ihor                    Male   Ukraine     ECL         1999-10-03  170.  23.3
18 Iryna                   Female Ukraine     ECL         1993-02-27  192   29.9
19 Peng                    Male   China       UCBL        1996-12-14  171   26.1
20 Mingyuan                Male   China       UCBL        1997-08-21  164.  25.4
# … with abbreviated variable name ¹​dateofbirth</code></pre>
</div>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># - People with a `e` in their name</span></span>
<span><span class="va">pp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">'e'</span>,<span class="va">name</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
   name                    gender origin      institution dateofbi…¹  size   age
   &lt;chr&gt;                   &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt;       &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;
 1 Salem                   Male   Yemen       UCBL        1997-12-26  161.  25.0
 2 Dilruwan-Shanaka-Perera Male   Sri Lanka   INSA        1997-03-28  172.  25.8
 3 Benedikt                Male   Austria     UCBL        1995-04-25  176.  27.7
 4 Jennifer                Female USA         ECL         1995-05-28  179   27.6
 5 Leran                   Male   China       UCBL        1992-12-30  186   30.0
 6 Aymen                   Male   Tunisia     INSA        1990-03-03  160.  32.8
 7 Nicolas-Estevan         Male   Colombia    INSA        1993-11-25  184.  29.1
 8 Roein                   Male   Afghanistan INSA        1999-07-11  155.  23.5
 9 Paraskevas              Male   Cyprus      INSA        1999-06-25  176.  23.5
10 Peng                    Male   China       UCBL        1996-12-14  171   26.1
# … with abbreviated variable name ¹​dateofbirth</code></pre>
</div>
</div>
</details><hr>
<p>For more interesting exercises in the tidyverse, look at:</p>
<ul>
<li><a href="Exo/co2/exercise.html">CO2 emissions: data wrangling and ggplot2</a></li>
<li><a href="Exo/religion_babies/exercise.html">Religion and babies: data handling, ggplot2 and plotly</a></li>
<li><a href="Exo/covid/exercise.html">COVID-19: data wrangling, ggplot2</a></li>
<li><a href="Exo/SEM_particles/exercise.html">Nanoparticles statistics from SEM images: data wrangling, ggplot2 and fitting</a></li>
</ul>
<p><br><br><br><br><br></p>
<p><br><br><br><br><br></p>


<!-- -->

</details></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation column-body"><div class="nav-page nav-page-previous">
      <a href="./06-vectors.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Vectors</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-reading_files.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Reading/writing all kinds of files</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<pre class="markdown" data-shortcodes="false"><code># Data frames

## Defining a data.frame

### Defining a data.frame from vectors

In R, the principal object is *the data*. Hence the `data.frame`{.R} object, which is basically a table of vectors. A `data.frame`{.R} is a list presented under the form of a table – *i.e.* a spreadsheet. On a day-to-day basis, you will either define `data.frame`{.R} from existing vectors or other `data.frame`{.R}, or define a `data.frame`{.R} from a file (text, Excel...). In this example, we use &lt;a href="Data/test.dat" download target="_blank"&gt;test.dat&lt;/a&gt; and &lt;a href="Data/test.xlsx" download target="_blank"&gt;test.xlsx&lt;/a&gt;.

To define a `data.frame` from known vectors, we just have to do:
```{r, warnings=FALSE, message=FALSE}
x  &lt;- seq(-pi, pi, length = 6) 
y  &lt;- sin(x)
df &lt;- data.frame(x, y) # df is a data.frame (a table)
df
```

Then some information about our table are readily accessible, like:

- The dimension, the number of rows and columns:
```{r, warnings=FALSE, message=FALSE}
dim(df); nrow(df); ncol(df)
```
- Print the first and last 3 values
```{r, warnings=FALSE, message=FALSE}
head(df, 3); tail(df, 3)
```
- Print some information on `df`
```{r, warnings=FALSE, message=FALSE}
str(df)
```
- Print some statistics on `df`
```{r, warnings=FALSE, message=FALSE}
summary(df)
```



If not defined when creating the `data.frame`, the column names will be by default the vector names. To specify your own column names, do it when creating the `data.frame`:
quarto-executable-code-5450563D

```r
df &lt;- data.frame(xxx = x, yyy = y)
head(df, 2)
```
Or, once it's created, do it using `names()`{.R}
quarto-executable-code-5450563D

```r
names(df)
names(df) &lt;- c("X", "Y")
head(df, 2)
```


### Defining a data.frame from a file

Let's say we have `test.dat` that looks like this:
quarto-executable-code-5450563D

```bash
# Bash code:
head Data/test.dat
```

- Then, to read this file into a `data.frame`, we will use `read.table()`{.R}. If you don't specify that the file contains a header, `read.table()`{.R} will default to attributing column names that will be V1, V2, V3, etc:
quarto-executable-code-5450563D

```r
read.table("Data/test.dat")
```
- If your file contains column names, you will use first line as column names like so:
quarto-executable-code-5450563D

```r
read.table("Data/test.dat", header=TRUE)
```
- If you want to skip some lines before starting the reading, use `skip`:
quarto-executable-code-5450563D

```r
read.table("Data/test.dat", skip=1)
```
- You can specify your own column names using `col.names`:
quarto-executable-code-5450563D

```r
read.table("Data/test.dat", skip=1, col.names = c("A","B"))
```
- You can type `?read.table` for more options.

- Now, to read an Excel file, use the `readxl` library:
quarto-executable-code-5450563D

```r
library(readxl) # load readxl from tidyverse to read Excel files
read_excel("Data/test.xlsx", sheet=1)
read_excel("Data/test.xlsx", sheet=2)
```

--- 

## Accessing values 

- Like with vectors, accessing values is done using the `[]` notation, except that here there are two indexes: `df[row, column]`:
```{r, warnings=FALSE}
df[3,1]
```
- In general however, what you want is to access a given column, by its index:
```{r, warnings=FALSE}
df[,1]
df[[1]]# this is a vector too
```
- Or, **preferably**, by its name using the `$` notation:
```{r, warnings=FALSE}
df$X
```
- Finally, you may want to apply filters on your table:
```{r, warnings=FALSE}
df[df$X &lt; 0, ]
```
- Using the function `subset()`{.R}, the conditions are applied on column names (no need for `df$col_name` here, while you need it in the above expression):
```{r, warnings=FALSE}
subset(df, X&gt;1)
subset(df, X&gt;1, select = c(X))
```

---

## Adding columns or rows

### Adding columns
- To add a column, just attribute a value to an column that do not exist yet, it will be created:
```{r, warnings=FALSE}
# Adding columns
df   &lt;- data.frame(x,y)
df$z &lt;- df$x^2
df
```
- You can also create a `data.frame` of a `data.frame`:
```{r, warnings=FALSE}
data.frame(df, z=df$x^2, u=cos(df$x))
```
- Finally, you can use the `cbind()`{.R} function to bind two `data.frame` column-wise:
```{r, warnings=FALSE}
df2 &lt;- data.frame(a = 1:length(x), b = 1:length(x))
cbind(df, df2)
```

### Adding rows

For this, use the `rbind()`{.R} function.

:::{.callout-warning}
## Attention
The two `data.frame` must have the same number of columns _**and**_ the same column names.
:::

```{r, warnings=FALSE}
rbind(df, df)
```

### Deleting rows/columns

This works like with vectors:
```{r, warnings=FALSE}
df[-1,]
df[,-1]
```

---

## Tidy up!


### What is tidy data?

**A good practice in R is to *tidy* your data.** R follows a set of conventions that makes one layout of tabular data much easier to work with than others. Your data will be easier to work with in R if it follows three rules:

- Each variable in the data set is placed in its own column
- Each observation is placed in its own row
- Each value is placed in its own cell

```{r tidy, echo=FALSE, fig.cap="Illustration of tidy data.", fig.align="center", out.width="100%"}
knitr::include_graphics("./Plots/tidy.png")
```
Data that satisfies these rules is known as tidy data: you see that thanks to this representation, a 2D table can handle an arbitrary number of variables – this avoids using multi-dimensional arrays or multi-tab Excel documents. Note that it does't matter if a value is repeated in a column. 

Here is an example:

```r
df &lt;- read.csv("Data/population.csv")
df # is not tidy
```
&lt;details&gt;
    &lt;summary&gt;Show output&lt;/summary&gt;

```{r echo=FALSE}
df &lt;- read.csv("Data/population.csv")
df # is not tidy
```

&lt;/details&gt;

&lt;br&gt;

```r
library(tidyr)
df &lt;- pivot_longer(df, cols=-year, names_to="city", values_to="pop")
df #is tidy
```

&lt;details&gt;
    &lt;summary&gt;Show output&lt;/summary&gt;

```{r echo=FALSE, message=FALSE}
library(tidyr)
df &lt;- pivot_longer(df, cols=-year, names_to="city", values_to="pop")
df #is tidy
```

&lt;/details&gt;
&lt;br&gt;

```r
# is not tidy
pivot_wider(df, names_from="city", values_from="pop")
```

&lt;details&gt;
    &lt;summary&gt;Show output&lt;/summary&gt;

```{r echo=FALSE}
# is not tidy
pivot_wider(df, names_from="city", values_from="pop")
```

&lt;/details&gt;
&lt;br&gt;

You can find more information on data import and [tidyness](https://garrettgman.github.io/tidying/) on the [data-import cheatsheet](https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf) and on the [tidyr](http://www.sthda.com/english/wiki/tidyr-crucial-step-reshaping-data-with-r-for-easier-analyses) package.


```{r pivotgif, echo = FALSE, fig.cap = "Understanding long and wide data with an animation. Source: [tidyexplain](https://github.com/gadenbuie/tidyexplain)", fig.align="center", out.width="70%"}
knitr::include_graphics('./Plots/tidyr-pivoting.gif')
```



### Tibbles

A `tibble`{.R} is an enhanced version of the `data.frame`{.R} provided by the `tibble` package (which is part of the `tidyverse`). The main advantage of `tibble`{.R} is that it has easier initialization and nicer printing than `data.frame`{.R}. Moreover, the performance are also enhanced for the reading from files with `read_csv()`{.R}, `read_tsv()`{.R}, `read_table()`{.R} and `read_delim()`{.R} that do the same things as their `read.xx()` counterparts and return a `tibble`. Otherwise, the handling is basically the same.

More on tibbles [here](https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html).

```{r, include=FALSE}
rm(x)
```

- Note that when initializing `tibble`s, the construction is iterative. It means that when creating a second column, one can refer to the first one that was created. This does't work with `data.frame`s.

```{r, error=TRUE, warnings=FALSE, message=FALSE}
library(tidyverse)
data.frame(x=runif(1e3), y=cumsum(x))
tib &lt;- tibble(x=runif(1e3), y=cumsum(x))
tib
```

:::{.callout-warning}
## Attention
:::

`Tibble`s are quite strict about subsetting. `[` always returns another `tibble`. Contrast this with a data frame: sometimes `[` returns a data frame and sometimes it just returns a vector:
quarto-executable-code-5450563D

```r
head(tib[[1]]) # is a vector
head(tib[,1])  # is a tibble
```
Unless you want to get a `tibble`, I recommend always using the `$` notation when you want to get a column as a vector to avoid problems.

- Another interesting feature of `tibble`s is that their columns can contain vectors, like usual, but also lists of any R objects like other tibbles, `nls()`{.R} objects, etc. This is called "nesting", and you can nest and un-nest `tibble`s using these explicit functions:

```{r warning=FALSE, message=FALSE}
tib1 &lt;- tibble(x=1:3, y=1:3)
tib2 &lt;- tibble(x=1:5, y=1:5)
tib  &lt;- tibble(number=1:2, data=list(tib1, tib2))
tib
tib_unnested &lt;- unnest(tib, data)
tib_unnested
tib_unnested_renested &lt;- nest(tib_unnested, data = c(number, y))
tib_unnested_renested
tib_unnested_renested$data # The `data` column is a list
```

---

## Operations in the tidyverse

In the end, base R and the `tidyverse` package provide many efficient functions to perform most of the tasks you would want to perform recursively, thus allowing avoiding explicit for loops.

Here are some examples, and you will find much more [here](https://cran.r-project.org/web/packages/dplyr/vignettes/dplyr.html). Take a look at the cheatsheets on [tidyr](https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf) and on [dplyr](https://github.com/rstudio/cheatsheets/blob/main/data-transformation.pdf), it's really helpful. 

Let's work on this `tibble`:
```{r, message=FALSE}
# Let's create a random tibble
library(tidyverse)
N &lt;- 500
dt &lt;- tibble(x     = rep(runif(N,-1,1),3), 
             y     = runif(N*3,-1,1), 
             signx = ifelse(x&gt;0,"positive","negative"),
             signy = ifelse(y&gt;0,"positive","negative")
)
dt
```


### The pipe operator

In the following, we will introduce the pipe operator from the `magrittr` package: `%&gt;%`{.R}.
This operator allows a clear syntax for successive operations, as "what is on the left of the operator is given as first argument of what is on the right". It is thus a good habit to write each operation on a separate line to facilitate the reading. This is particularly helpful when performing multiple nested operations. For example, `summary(head(tail(dt),2))`{.R}, which is hard to read, would translate to:

```r
dt %&gt;% 
    tail() %&gt;% 
    head(2) %&gt;% 
    summary()
```

Note that the 4.1 version of R introduced a native pipe operator: `|&gt;`{.R}. However, for backward compatibility with all my previous code I still stick to the `magrittr` version `%&gt;%`, but that's not the only reason. Indeed, in base R's pipe, the piped object can only be given as first argument to the function on the right. This is also the default behavior of `%&gt;%`, but `%&gt;%` allows for retrieving the piped object with the operator `.`. 

Silly example:

```{r, error=TRUE}
"Hello" %&gt;% gsub("o", "e")
"Hello" %&gt;% gsub("o", "e", .)
```


### Sampling data
```{r, message=FALSE}
dt %&gt;% slice(1:3)  # by index
dt %&gt;% sample_n(3) # randomly
```

### Operations on groups of a variable
`group_by(column)`{.R} groups by similar values of the wanted column(s) and performs the next operations on each element of the group successively.

```{r, message=FALSE}
dt %&gt;% 
    group_by(signx) %&gt;% 
    sample_n(3)
dt %&gt;% 
    group_by(signx, signy) %&gt;% 
    sample_n(3)
```

### Summary by groups of a variable
`summarise()`{.R} returns a **single value** for each element of the groups.

```{r, message=FALSE}
dt %&gt;% 
    group_by(signx) %&gt;% 
    summarise(count  = n(),
              mean_x = mean(x), 
              sd_x   = sd(x))
dt %&gt;% 
    group_by(signx, signy) %&gt;% 
    summarise(count  = n(),
              mean_x = mean(x), 
              mean_y = mean(y))
```

### Sorting

```{r, message=FALSE}
dt %&gt;% arrange(x)
dt %&gt;% arrange(x, desc(y))
```

### Merge tables column-wise

At least one column with the **exact** same name must be present in each table to use the `xx_join()`{.R} functions. There are more possibilities than `inner_join()`{.R} that I show here, see the help for more information.
```{r, message=FALSE}
dt2 &lt;- tibble(signx=c("positive","positive","negative","negative"), 
              signy=c("positive","negative","positive","negative"), 
              value=c(TRUE, FALSE, FALSE, TRUE))
dt2
inner_join(dt, dt2)
```

### Merge tables row-wise

This works even if there are missing rows.
```{r, message=FALSE}
dt3 &lt;- tibble(a=1:3, b=3:5, c=6:8)
dt4 &lt;- tibble(a=3:1, c=3:5)
bind_rows(dt3, dt4)
```

### Add/modify a column

`mutate()`{.R}, like `$`{.R}, adds a column if it doesn't exist, and modifies it if it does.
```{r, message=FALSE}
dt %&gt;% mutate(w=seq_along(x), z=sin(x))
dt %&gt;% mutate(x=seq_along(x))
```

### Selecting columns

```{r, message=FALSE}
dt %&gt;% select(x)  # only x
dt %&gt;% select(-x) # all but x
dt %&gt;% select(starts_with("sign"))
dt %&gt;% select(contains("x"))
```

### Filtering columns

```{r, message=FALSE}
dt %&gt;% filter(signx=="positive")
dt %&gt;% filter(x&lt;0, y&gt;.1) # multiple filters can be applied at once
```

### Reorder columns

```{r, message=FALSE}
dt %&gt;% relocate(y, .after = signy)
```

### Separate columns

The separation is based on standard separators such as "-", "\_", ".", " ", etc. A single separator can be specified with the argument `sep`, otherwise all separators are used. One must provide the resulting vector of new column names: if one value is `NA`{.R}, this column will be discarded. Examples:

```{r, message=FALSE}
dt5 &lt;- tibble(file=list.files(path="Exo/FTIR/Data/", pattern=".xls"))
dt5
dt5 %&gt;% separate(file, c(NA, "sample", "temperature", NA), convert = TRUE)
dt5 %&gt;% separate(file, 
                 c("name", "extension"), 
                 sep = "\\."
                 )
```

### Apply a function recursively on each element of a column

Take a look at the [cheatsheet on the `purrr` package](https://github.com/rstudio/cheatsheets/blob/main/purrr.pdf) for more options and a visual help on the `map()` family. I show here a use of `purrr::map(vector, function)`{.R} that returns a list. `map(x, f)`{.R} applies the function `f()` to each element of the vector `x`, putting the result in a separate element of a list: `map(x, f) -&gt; list(f(x1), f(x2), ... f(xn))`{.R}. In case `f(xi)` returns a single value, you might want to use `map_dbl()` or `map_chr()`, for example, that will return a vector of doubles or of characters, respectively.

```{r, message=FALSE}
x &lt;- c(pi, pi/3, pi/2)
map(x, sin)     # returns a list
x %&gt;% map_dbl(sin) # returns a vector
```

Of course, in the above case, it's a stupid use of the power of `map()`{.R}. A typical use case is when you want to read multiple files, for example:
```{r, message=FALSE, warning=FALSE}
dt6 &lt;- tibble(file=list.files(path="Exo/spectro/Data", 
                              pattern = ".txt", 
                              full.names = TRUE)) %&gt;% 
    slice(1:5) %&gt;% 
    mutate(data = map(file, read_table))
dt6
```
This is (almost) equivalent to:
```{r, message=FALSE, warning=FALSE}
dt6 &lt;- tibble(file=list.files(path="Exo/spectro/Data", 
                              pattern = ".txt", 
                              full.names = TRUE)) %&gt;% 
    slice(1:5) %&gt;%
    mutate(data = map(file, ~ read_table(., col_names = c("w", "Int"))))
```

You see that you can create the function directly within the call to map using the shortcut `map(vector, ~ function(.))`{.R}. This is useful to provide more arguments to the function -- another solution is to write your own function before the call to `map()`{.R} and then call this function in `map()`{.R}.

Note that in case you need more parameters, you can use `purrr::map2(vector1, vector2, ~function(.x, .y))`{.R}, where `.x` and `.y` refer to `vector1` and `vector2`, respectively (it's always `.x` and `.y` whatever the name of `vector1` and `vector2`).
quarto-executable-code-5450563D

```r
tibble(x=1:3, y=5:7) %&gt;% 
    mutate(sum = map2_dbl(x, y, sum))
tibble(a=list(tibble(x=1:3, y=5:7), 
              tibble(x=0:3, y=4:7)), 
       b=list(tibble(x=10:13, y=15:18), 
              tibble(x=-1:2,  y=-14:-17))) %&gt;% 
    mutate(sumx = map2_dbl(a, b, ~sum(.x$x, .y$x)),
           sumy = map2_dbl(a, b, ~sum(.x$y, .y$y)))
```

### Nesting and un-nesting data

```{r, message=FALSE}
dt7 &lt;- dt6 %&gt;% 
    mutate(file = basename(file)) %&gt;% 
    unnest(data)
dt7
# Nesting data per repeated values in a column (~equivalent to grouping)
dt7 %&gt;% nest(data=-file)
```

### Providing data to ggplot

```{r, message=FALSE}
library(ggplot2)
dt %&gt;% filter(abs(y) &gt; 0.1) %&gt;% 
    ggplot(aes(x=x, y=y, color=signy))+
        geom_point()
```

## Exercises {#exo-df}

Interactive exercises can be found in the [`tutor`](https://colinbousige.github.io/tutor/) package. For this, simply run:

```r
library(tutor)
tuto("dataframes")
```

Alternatively, you can just &lt;a href="Data/exo-in-class.zip" download target="_blank"&gt;download the archive with all the exercises files&lt;/a&gt;, unzip it in your `R class` RStudio project, and edit the R files.

---

&lt;details&gt;
    &lt;summary&gt;**Exercise 1**&lt;/summary&gt;

- Create a 3 column `data.frame`{.R} containing 10 random values, their sinus, and the sum of the two first columns.
- Print the 4 first lines of the table
- Print the second column
- Print the average of the third column
- Using `plot(x,y)`{.R} where `x` and `y` are vectors, plot the 2nd column as a function of the first
- Look into the function `write.table()`{.R} to write a text file containing this `data.frame`{.R}
- Do the all the same things with a `tibble`{.R}

&lt;details&gt;
    &lt;summary&gt;Solution&lt;/summary&gt;

```{r, warnings=FALSE}
# Create a 3 column `data.frame`{.R} containing 10 random values, their sinus, 
# and the sum of the two first columns.
x &lt;- runif(10)
y &lt;- sin(x)
z &lt;- x + y
df &lt;- data.frame(x=x, y=y, z=z)
# Print the 4 first lines of the table
head(df, 4)
# Print the second column
df[,2]
# Print the average of the third column
mean(df$z); mean(df[3]); mean(df[,3])
# Using `plot(x,y)`{.R} where `x` and `y` are vectors, 
# plot the 2nd column as a function of the first
plot(df[,1], df[,2])
plot(df$x, df$y)
# Look into the function `write.table()`{.R} to write a text file 
# containing this `data.frame`{.R}
write.table(df, "Data/some_data.dat", quote = FALSE, row.names = FALSE)
# # # # # # # # # # # # # # # # # 
# Tibble version
library(tidyverse)
df_tib &lt;- tibble(a = runif(10), b = sin(a), c = a + b)
head(df_tib, 4)
df_tib[,2]; df_tib[[2]];
mean(df_tib$c); mean(df_tib[3]); mean(df_tib[,3]); mean(df_tib[[3]])
write.table(df_tib, "Data/some_data.dat", quote = FALSE, row.names = FALSE)
plot(df_tib$a, df_tib$b)
```

&lt;/details&gt;
&lt;/details&gt;

&lt;details&gt;
    &lt;summary&gt;**Exercise 2**&lt;/summary&gt;

- Download the files:
    - &lt;a href="Data/rubis_01.txt" download target="_blank"&gt;rubis_01.txt&lt;/a&gt;
    - &lt;a href="Data/population.csv" download target="_blank"&gt;population.csv&lt;/a&gt;
    - &lt;a href="Data/FTIR_rocks.xlsx" download target="_blank"&gt;FTIR_rocks.xlsx&lt;/a&gt;
- Load them into separate `data.frames`{.R}. Look into the options of `read.table()`{.R}, `read.csv()`{.R}, `readxl::read_excel()`{.R},  to get the proper data fields.
- Add column names to the data.frame containing `rubis_01.txt`. 
- Print their dimensions.
- Do the same things with tibbles.

&lt;details&gt;
    &lt;summary&gt;Solution&lt;/summary&gt;

```{r, warnings=FALSE, message=FALSE}
rubis_01   &lt;- read.table("Data/rubis_01.txt", col.names = c("w", "intensity"))
population &lt;- read.csv("Data/population.csv")
FTIR_rocks &lt;- readxl::read_excel("Data/FTIR_rocks.xlsx")
dim(rubis_01); names(rubis_01)
dim(population); names(population)
dim(FTIR_rocks); names(FTIR_rocks)
library(tidyverse)
rubis_01 &lt;- read_table("Data/rubis_01.txt", col_names = c("w", "intensity"))
population &lt;- read_csv("Data/population.csv")
```

&lt;/details&gt;
&lt;/details&gt;

&lt;details&gt;
    &lt;summary&gt;**Exercise 3**&lt;/summary&gt;

- Download the TGA data file &lt;a href="Data/ATG.txt" download target="_blank"&gt;ATG.txt&lt;/a&gt;
- Load it into a `data.frame`{.R}. Look into the options of `read.table()`{.R} to get the proper data fields.
- Do the same with a tibble

&lt;details&gt;
    &lt;summary&gt;Solution&lt;/summary&gt;

quarto-executable-code-5450563D

```r
d &lt;- read.table("Data/ATG.txt", 
                skip=12,
                header=FALSE, 
                nrows=4088)
names(d) &lt;- c("Index", "t", "Ts", "Tr", "Value")
head(d)
d &lt;- read.table("Data/ATG.txt", 
                skip=10,
                comment.char="[",
                header=TRUE, 
                nrows=4088)
head(d)
library(tidyverse)
d &lt;- read_table("Data/ATG.txt", 
                skip    = 10,
                comment = "[") %&gt;% 
        drop_na()
d
```

&lt;/details&gt;
&lt;/details&gt;

&lt;details&gt;
    &lt;summary&gt;**Exercise 4**&lt;/summary&gt;

Download &lt;a href="Data/population.csv" download target="_blank"&gt;population.csv&lt;/a&gt; and load it into a `tibble`{.R}.

- What are the names of the columns?
- Are the data tidy? make the table tidy if needed
- Create a subset containing the data for Montpellier
    + What is the max and min of population in this city?
    + The average population over time?
- What is the total population in 2012?
- What is the total population per year?
- What is the average population per city over the years?

&lt;details&gt;
&lt;summary&gt;Solution&lt;/summary&gt;

quarto-executable-code-5450563D

```r
# Download population.txt and load it into a `data.frame`{.R}.
library(tidyverse)
popul &lt;- read_csv("Data/population.csv")
# What are the names of the columns and the dimension of the table?
names(popul); dim(popul)
# Are the data tidy?
head(popul) # no
popul.tidy &lt;- popul %&gt;% 
    pivot_longer(cols=-year,
                 names_to = "city",
                 values_to = "pop"
                )
popul.tidy
# Create a subset containing the data for Montpellier
mtp &lt;- subset(popul.tidy, city == "Montpellier")
# I prefer the tidyverse version
mtp &lt;- popul.tidy %&gt;% filter(city == "Montpellier")
# What is the max and min of population in this city?
max(mtp$pop)
min(mtp$pop)
range(mtp$pop)
# The average population over time?
mean(mtp$pop)
# What is the total population in 2012?
sum(popul.tidy[popul.tidy$year == 2012, "pop"])
popul.tidy %&gt;% 
    filter(year==2012) %&gt;% 
    select(pop) %&gt;% 
    sum()
# What is the total population per year?
popul.tidy %&gt;% 
    group_by(year) %&gt;% 
    summarise(pop_tot=sum(pop))
# What is the average population per city over the years?
popul.tidy %&gt;% 
    group_by(city) %&gt;% 
    summarise(pop_ave=mean(pop))
```

&lt;/details&gt;
&lt;/details&gt;

&lt;details&gt;
    &lt;summary&gt;**Exercise 5**&lt;/summary&gt;

- First, load the `tidyverse` and `lubridate` package
- Load &lt;a href="Data/people1.csv" download target="_blank"&gt;people1.csv&lt;/a&gt; and &lt;a href="Data/people2.csv" download target="_blank"&gt;people2.csv&lt;/a&gt; into `pp1` and `pp2`
- Create a new tibble `pp` by using the pipe operator (`%&gt;%`{.R}) and successively:
    - joining the two tibbles into one using `inner_join()`{.R}
    - adding a column `age` containing the age in years (use `lubridate::time_length(x, 'years')`{.R} with x a time difference in days) by using `mutate()`{.R}
- Display a summary of the table using `str()`{.R}
- Using `groupe_by()`{.R} and `summarize()`{.R}:
    - Show the number of males and females in the table (use the counter `n()`{.R})
    - Show the average age per gender
    - Show the average size per gender and institution
    - Show the number of people from each country, sorted by descending population (`arrange()`{.R})
- Using `select()`{.R}, display:
    - only the name and age columns
    - all but the name column
- Using `filter()`{.R}, show data only for
    - Chinese people
    - From institution ECL and UCBL
    - People older than 22 
    - People with a `e` in their name

&lt;details&gt;
    &lt;summary&gt;Solution&lt;/summary&gt;

```{r, warnings=FALSE, message=FALSE}
# First, load the `tidyverse` and `lubridate` package
library(tidyverse)
library(lubridate)
# Load people1.csv and people2.csv
pp1  &lt;- read_csv("Data/people1.csv")
pp2  &lt;- read_csv("Data/people2.csv")
# Create a new tibble `pp` by using the pipe operator (`%&gt;%`)
# and successively:
# - joining the two tibbles into one using `inner_join()`
# - adding a column `age` containing the age in years 
#   (use lubridate's `time_length(x, 'years')` with x a time
#   difference in days) by using `mutate()`
pp &lt;- pp1 %&gt;% 
        inner_join(pp2) %&gt;% 
        mutate(age=time_length(today()-dateofbirth,'years'))
# Display a summary of the table using `str()`
str(pp)
# Using `groupe_by()` and `summarize()`:
# - Show the number of males and females in the table 
#   (use the counter `n()`)
pp %&gt;% group_by(gender) %&gt;% summarize(count=n())
# - Show the average age per gender
pp %&gt;% group_by(gender) %&gt;% summarize(age=mean(age))
# - Show the average size per gender and institution
pp %&gt;% group_by(gender, institution) %&gt;% summarize(size=mean(size))
# - Show the number of people from each country, 
#   sorted by descending population
pp %&gt;% group_by(origin) %&gt;% 
        summarize(count=n()) %&gt;% 
        arrange(desc(count))
# Using `select()`, display:
# - only the name and age columns
pp %&gt;% select(c(name, age))
# - all but the name column
pp %&gt;% select(-name)
# Using `filter()`, show data only for
# - Chinese people
pp %&gt;% filter(origin=='China')
# - From institution ECL and UCBL
pp %&gt;% filter(institution %in% c('ECL', 'UCBL'))
# - People older than 22 
pp %&gt;% filter(age&gt;22)
# - People with a `e` in their name
pp %&gt;% filter(grepl('e',name))
```


&lt;/details&gt;




----

For more interesting exercises in the tidyverse, look at:

- [CO2 emissions: data wrangling and ggplot2](Exo/co2/exercise.html)
- [Religion and babies: data handling, ggplot2 and plotly](Exo/religion_babies/exercise.html)
- [COVID-19: data wrangling, ggplot2](Exo/covid/exercise.html)
- [Nanoparticles statistics from SEM images: data wrangling, ggplot2 and fitting](Exo/SEM_particles/exercise.html)

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;br&gt;

</code></pre>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>