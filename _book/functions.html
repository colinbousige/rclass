<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Functions | Reproducible data treatment with R</title>
<meta name="author" content="Colin Bousige">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="9 Functions | Reproducible data treatment with R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://lmi.cnrs.fr/r/functions.html">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Functions | Reproducible data treatment with R">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><script src="libs/plotly-binding-4.10.0/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-152051691-1"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-152051691-1');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
<meta name="description" content="9.1 Definition To get the manual on a base function, type ?function_name. A function returns the last thing that is called in it. Thus a function defined like that will return nothing: geom_mean...">
<meta property="og:description" content="9.1 Definition To get the manual on a base function, type ?function_name. A function returns the last thing that is called in it. Thus a function defined like that will return nothing: geom_mean...">
<meta name="twitter:description" content="9.1 Definition To get the manual on a base function, type ?function_name. A function returns the last thing that is called in it. Thus a function defined like that will return nothing: geom_mean...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="An introduction">Reproducible data treatment with R</a>:
        <small class="text-muted">An introduction</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="about-the-class.html"><span class="header-section-number">1</span> About the class</a></li>
<li><a class="" href="a-little-reminder-on-statistics.html"><span class="header-section-number">2</span> A little reminder on Statistics</a></li>
<li><a class="" href="getting-ready.html"><span class="header-section-number">3</span> Getting ready</a></li>
<li><a class="" href="variables-booleans-and-strings.html"><span class="header-section-number">4</span> Variables, booleans and strings</a></li>
<li><a class="" href="vectors.html"><span class="header-section-number">5</span> Vectors</a></li>
<li><a class="" href="data-frames.html"><span class="header-section-number">6</span> Data frames</a></li>
<li><a class="" href="readingwriting-all-kinds-of-files.html"><span class="header-section-number">7</span> Reading/writing all kinds of files</a></li>
<li><a class="" href="lists.html"><span class="header-section-number">8</span> Lists</a></li>
<li><a class="active" href="functions.html"><span class="header-section-number">9</span> Functions</a></li>
<li><a class="" href="conditional-actions-and-loops.html"><span class="header-section-number">10</span> Conditional actions and loops</a></li>
<li><a class="" href="plotting.html"><span class="header-section-number">11</span> Plotting</a></li>
<li><a class="" href="colorplots.html"><span class="header-section-number">12</span> 3D color plots</a></li>
<li><a class="" href="fitting.html"><span class="header-section-number">13</span> Fitting</a></li>
<li><a class="" href="writing-documents-with-rmarkdown.html"><span class="header-section-number">14</span> Writing documents with Rmarkdown</a></li>
<li><a class="" href="graphical-interfaces-with-shiny.html"><span class="header-section-number">15</span> Graphical interfaces with Shiny</a></li>
<li><a class="" href="working-with-units-and-experimental-errors.html"><span class="header-section-number">16</span> Working with units and experimental errors</a></li>
<li><a class="" href="list-of-exercises.html"><span class="header-section-number">17</span> List of exercises</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/colinbousige/Rclass">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="functions" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Functions<a class="anchor" aria-label="anchor" href="#functions"><i class="fas fa-link"></i></a>
</h1>
<div id="definition-3" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Definition<a class="anchor" aria-label="anchor" href="#definition-3"><i class="fas fa-link"></i></a>
</h2>
<p>To get the manual on a base function, type <code class="sourceCode r">?function_name</code>.</p>
<p>A function returns the last thing that is called in it. Thus a function defined like that will return nothing:</p>
<div class="sourceCode" id="cb547"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">geom_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">geom_mean</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></code></pre></div>
<p>While this will return what you want:</p>
<div class="sourceCode" id="cb548"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">geom_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span>
    <span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">*</span><span class="va">y</span><span class="op">)</span>
    <span class="va">a</span>
<span class="op">}</span>
<span class="fu">geom_mean</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span> <span class="co">#returns a</span></code></pre></div>
<pre><code>## [1] 1.414214</code></pre>
<p>The result of a function can be a list, a data.frame, a vector… or nothing. And you can attribute the result of a function to a variable:</p>
<div class="sourceCode" id="cb550"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">person</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">name</span>, <span class="va">age</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name<span class="op">=</span><span class="va">name</span>, age<span class="op">=</span><span class="va">age</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">joe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/person.html">person</a></span><span class="op">(</span>name<span class="op">=</span><span class="st">"Joe"</span>, age<span class="op">=</span><span class="fl">33</span><span class="op">)</span>
<span class="va">joe</span></code></pre></div>
<pre><code>## $name
## [1] "Joe"
## 
## $age
## [1] 33</code></pre>
<p>One can add default values to variables:</p>
<div class="sourceCode" id="cb552"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testfunc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>
    <span class="va">x</span><span class="op">*</span><span class="va">y</span>
<span class="op">}</span>
<span class="fu">testfunc</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb554"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">testfunc</span><span class="op">(</span><span class="fl">1</span>, y<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb556"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">testfunc</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, y<span class="op">=</span><span class="fl">.1</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.1 0.2 0.3</code></pre>
<p>And pass arguments to other functions:</p>
<div class="sourceCode" id="cb558"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testfunc2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">testfunc2</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6</code></pre>
<div class="sourceCode" id="cb560"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">testfunc2</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,<span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1 2</code></pre>
<p>Or even pass a function as argument:</p>
<div class="sourceCode" id="cb562"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">testfunc3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">FUN</span>, <span class="va">...</span><span class="op">)</span><span class="op">{</span>
    <span class="fu">FUN</span><span class="op">(</span><span class="va">...</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">testfunc3</span><span class="op">(</span><span class="va">sum</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<div class="sourceCode" id="cb564"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">testfunc3</span><span class="op">(</span><span class="va">plot</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-148-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="interpolation-of-data" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Interpolation of data<a class="anchor" aria-label="anchor" href="#interpolation-of-data"><i class="fas fa-link"></i></a>
</h2>
<p>It is possible to interpolate data through the <code class="sourceCode r"><span class="fu">approxfun</span>()</code> and <code class="sourceCode r"><span class="fu">splinefun</span>()</code> functions: while the former uses linear interpolation, the latter uses cubic splines (polynomials).</p>
<div class="sourceCode" id="cb565"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xmin</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span>; <span class="va">xmax</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span>
<span class="va">x</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">30</span>, min<span class="op">=</span><span class="va">xmin</span>, max<span class="op">=</span><span class="va">xmax</span><span class="op">)</span>
<span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">xmin</span>, <span class="va">xmax</span>, <span class="fl">.1</span><span class="op">)</span>
<span class="va">y</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co"># Linear interpolation</span>
<span class="va">lin_interp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approxfun</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>        <span class="co">#is a function</span>
<span class="fu">lin_interp</span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>; <span class="fu">lin_interp</span><span class="op">(</span><span class="va">pi</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.000585687</code></pre>
<pre><code>## [1] -0.0004503362</code></pre>
<div class="sourceCode" id="cb568"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yy_lin</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approx</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xout<span class="op">=</span><span class="va">xx</span><span class="op">)</span> <span class="co">#is a list containing x and y</span>

<span class="co"># Cubic spline interpolation</span>
<span class="va">spl_interp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/splinefun.html">splinefun</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>        <span class="co">#is a function</span>
<span class="va">yy_spl</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/splinefun.html">spline</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, xout<span class="op">=</span><span class="va">xx</span><span class="op">)</span> <span class="co">#is a list containing x and y</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Helvetica"</span>, cex.lab<span class="op">=</span><span class="fl">1.5</span>, cex.axis<span class="op">=</span><span class="fl">1.4</span>, 
    mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.4</span>, <span class="fl">.5</span>, <span class="fl">0</span><span class="op">)</span>, tck<span class="op">=</span><span class="fl">0.02</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">.5</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">2</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, pch<span class="op">=</span><span class="fl">16</span>, cex<span class="op">=</span><span class="fl">2</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1.6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">xx</span>, <span class="fu">lin_interp</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"royalblue"</span><span class="op">)</span> <span class="co"># equivalent to: lines(yy_lin, col="royalblue")</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">xx</span>, <span class="fu">spl_interp</span><span class="op">(</span><span class="va">xx</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="co"># equivalent to: lines(yy_spl, col="red")</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,
    cex<span class="op">=</span><span class="fl">1.2</span>,
    lty<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,
    lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,
    pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,
    col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"royalblue"</span>, <span class="st">"red"</span><span class="op">)</span>,
    bty <span class="op">=</span> <span class="st">"n"</span>,
    legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"'Experimental' points"</span>, <span class="st">"Linear interpolation"</span>, <span class="st">"Spline interpolation"</span><span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-149-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="exo-functions" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Exercises<a class="anchor" aria-label="anchor" href="#exo-functions"><i class="fas fa-link"></i></a>
</h2>
<details><summary><strong>Exercise 1</strong>
</summary><p>Create the sinus cardinal function, <span class="math inline">\(f(x)=\sin(x)/x\)</span> for <span class="math inline">\(x\neq0\)</span> and <span class="math inline">\(f(0)=1\)</span>.</p>
<details><summary>
Solution
</summary><div class="sourceCode" id="cb569"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sinc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">tol</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span> <span class="op">)</span><span class="op">{</span>
    <span class="co"># sinus cardinal</span>
    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
    <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">&gt;</span><span class="va">tol</span><span class="op">)</span>
    <span class="va">y</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">b</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="va">x</span><span class="op">[</span><span class="va">b</span><span class="op">]</span>
    <span class="va">y</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/pkg/tutor/man/sinc.html">sinc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">pi</span>,<span class="va">pi</span>,<span class="va">pi</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 3.898172e-17 3.001054e-01 6.366198e-01 9.003163e-01 1.000000e+00
## [6] 9.003163e-01 6.366198e-01 3.001054e-01 3.898172e-17</code></pre>
<div class="sourceCode" id="cb571"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8</span><span class="op">*</span><span class="va">pi</span>,<span class="fl">8</span><span class="op">*</span><span class="va">pi</span>,<span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/pkg/tutor/man/sinc.html">sinc</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>,v<span class="op">=</span><span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-150-1.png" width="100%" style="display: block; margin: auto;"></div>
</details></details><details><summary><strong>Exercise 2</strong>
</summary><ul>
<li>Write a function returning a normalized Gaussian function
<ul>
<li>Test that it is indeed normalized by numerically computing its integral</li>
</ul>
</li>
<li>Write a new function returning the sum of an arbitrary number of Gaussian functions</li>
</ul>
<details><summary>
Solution
</summary><div class="sourceCode" id="cb572"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Write a function returning a normalized Gaussian function</span>
<span class="co"># look also at the dnorm() base function</span>
<span class="va">Gaussian</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">x0</span>,<span class="va">FWHM</span>,<span class="va">A</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>
    <span class="fl">2.</span><span class="op">*</span><span class="va">A</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span><span class="op">/</span><span class="va">FWHM</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">x0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="fl">4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">FWHM</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span>
<span class="co"># Test that it is indeed normalized by numerically computing its integral</span>
<span class="va">dx</span> <span class="op">&lt;-</span> <span class="fl">.01</span>
<span class="va">x</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="va">dx</span><span class="op">)</span>
<span class="va">y</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tutor/man/Gaussian.html">Gaussian</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">*</span><span class="va">dx</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>,mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">dx</span><span class="op">)</span>
<span class="co"># Write a new function returning the sum of an arbitrary number of Gaussian functions</span>
<span class="va">sumGaussian1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">x0</span>,<span class="va">FWHM</span>,<span class="va">A</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>
    <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y0</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
      <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tutor/man/Gaussian.html">Gaussian</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">x0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">FWHM</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,A<span class="op">=</span><span class="va">A</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    <span class="op">}</span>
    <span class="va">y</span>
<span class="op">}</span>
<span class="co"># handling bad entries and being more efficient</span>
<span class="va">sumGaussian2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">x0</span>,<span class="va">FWHM</span>,<span class="va">A</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span><span class="op">!=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">FWHM</span><span class="op">)</span><span class="op">)</span> <span class="va">FWHM</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">FWHM</span>, length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span><span class="op">)</span>
    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span><span class="op">!=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">)</span>    <span class="va">A</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">A</span>,    length.out<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x0</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
          <span class="fu"><a href="https://rdrr.io/pkg/tutor/man/Gaussian.html">Gaussian</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">x0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">FWHM</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,A<span class="op">=</span><span class="va">A</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
        <span class="op">}</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</details></details><details><summary><strong>Exercise 3</strong>
</summary><p>Write a function returning a <code class="sourceCode r">tibble</code> (created if not supplied, incremented if supplied) containing the name, age, gender and country of origin of the people in the class. Print it. Play around with the obtained tibble to make some statistics about the class population.</p>
<details><summary>
Solution
</summary><div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">people</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ppl</span><span class="op">=</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">name</span><span class="op">=</span><span class="cn">NA</span>, <span class="va">age</span><span class="op">=</span><span class="cn">NA</span>, <span class="va">gender</span><span class="op">=</span><span class="cn">NA</span>, <span class="va">origin</span><span class="op">=</span><span class="cn">NA</span><span class="op">)</span><span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">ppl</span>, <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>name<span class="op">=</span><span class="va">name</span>, age<span class="op">=</span><span class="va">age</span>, gender<span class="op">=</span><span class="va">gender</span>, origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">ppl</span> <span class="op">&lt;-</span> <span class="fu">people</span><span class="op">(</span>name<span class="op">=</span><span class="st">"Colin"</span>, age<span class="op">=</span><span class="fl">33</span>, gender<span class="op">=</span><span class="st">"Male"</span>, origin<span class="op">=</span><span class="st">"France"</span><span class="op">)</span>
<span class="va">ppl</span> <span class="op">&lt;-</span> <span class="fu">people</span><span class="op">(</span>ppl<span class="op">=</span><span class="va">ppl</span>, name<span class="op">=</span><span class="st">"Vincent"</span>, age<span class="op">=</span><span class="fl">39</span>, gender<span class="op">=</span><span class="st">"Male"</span>, origin<span class="op">=</span><span class="st">"France"</span><span class="op">)</span>
<span class="va">ppl</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   name      age gender origin
##   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt; 
## 1 Colin      33 Male   France
## 2 Vincent    39 Male   France</code></pre>
</details></details><p><br><br><br><br><br></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="lists.html"><span class="header-section-number">8</span> Lists</a></div>
<div class="next"><a href="conditional-actions-and-loops.html"><span class="header-section-number">10</span> Conditional actions and loops</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#functions"><span class="header-section-number">9</span> Functions</a></li>
<li><a class="nav-link" href="#definition-3"><span class="header-section-number">9.1</span> Definition</a></li>
<li><a class="nav-link" href="#interpolation-of-data"><span class="header-section-number">9.2</span> Interpolation of data</a></li>
<li><a class="nav-link" href="#exo-functions"><span class="header-section-number">9.3</span> Exercises</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/colinbousige/Rclass/blob/master/10-functions.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/colinbousige/Rclass/edit/master/10-functions.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Reproducible data treatment with R</strong>: An introduction" was written by Colin Bousige. It was last built on 07/04/2022.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
